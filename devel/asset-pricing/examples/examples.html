<!DOCTYPE html> <html lang=en > <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.18.1: http://docutils.sourceforge.net/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../../_static/javascripts/modernizr.js"></script> <title>Examples &#8212; linearmodels 4.28.dev20+g7f3fbf523 documentation</title> <link rel=apple-touch-icon  sizes=180x180  href="../../_static/icons/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="../../_static/icons/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="../../_static/icons/favicon-16x16.png"> <link rel=manifest  href="../../_static/icons/site.webmanifest"> <link rel=mask-icon  href="../../_static/icons/safari-pinned-tab.svg" color="#2196f3"> <link rel="shortcut icon" href="../../_static/icons/favicon.ico"> <meta name=msapplication-TileColor  content="#f8f8f8"> <meta name=msapplication-config  content="../../_static/icons/browserconfig.xml"> <style> .highlight { background-color: hsla(0,0%,92.5%,.5) !important; } </style> <link rel=stylesheet  type="text/css" href="../../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../../_static/material.css" /> <script data-url_root="../../" id=documentation_options  src="../../_static/documentation_options.js"></script> <script src="../../_static/jquery.js"></script> <script src="../../_static/underscore.js"></script> <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script> <script src="../../_static/doctools.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <script defer=defer  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel="shortcut icon" href="../../_static/favicon.ico"/> <link rel=index  title=Index  href="../../genindex.html" /> <link rel=search  title=Search  href="../../search.html" /> <link rel=next  title="Using Formulas" href=formulas.html  /> <link rel=prev  title=Introduction  href="../introduction.html" /> <body dir=ltr data-md-color-primary=blue data-md-color-accent=orange> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#asset-pricing/examples/examples" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../../index.html" title="linearmodels 4.28.dev20+g7f3fbf523 documentation" class="md-header-nav__button md-logo"> <img src="../../_static/bw-logo.svg" height=26  alt="linearmodels 4.28.dev20+g7f3fbf523 documentation logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >linearmodels v4.28 (+20)</span> <span class=md-header-nav__topic > Examples </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> </div> <div class="md-flex__cell md-flex__cell--shrink dropdown"> <button class=dropdownbutton >Versions</button> <div class="dropdown-content md-hero"> <a title=Release  href="https://bashtage.github.io/linearmodels/">Release</a> <a title=Development  href="https://bashtage.github.io/linearmodels/devel/">Development</a> </div> </div> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href="../index.html" class=md-tabs__link >Linear Factor Models for Asset Pricing</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../../index.html" title="linearmodels 4.28.dev20+g7f3fbf523 documentation" class="md-nav__button md-logo"> <img src="../../_static/bw-logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../../index.html" title="linearmodels 4.28.dev20+g7f3fbf523 documentation">linearmodels v4.28 (+20)</a> </label> <div class=md-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <a href="../../iv/index.html" class=md-nav__link >Instrumental Variable Estimation</a> <li class=md-nav__item > <a href="../../panel/index.html" class=md-nav__link >Panel Data Model Estimation</a> <li class=md-nav__item > <a href="../index.html" class=md-nav__link >Linear Factor Models for Asset Pricing</a> <ul class=md-nav__list > <li class=md-nav__item > <a href="../introduction.html" class=md-nav__link >Introduction</a> <li class=md-nav__item > <input class="md-toggle md-nav__toggle" data-md-toggle=toc  type=checkbox  id=__toc > <label class="md-nav__link md-nav__link--active" for=__toc > Examples </label> <a href="#" class="md-nav__link md-nav__link--active">Examples</a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#asset-pricing-examples-examples--page-root" class=md-nav__link >Examples</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#General-Setup" class=md-nav__link >General Setup</a> <li class=md-nav__item ><a href="#Import-data" class=md-nav__link >Import data</a> <li class=md-nav__item ><a href="#Transform-the-portfolios-to-be-excesses" class=md-nav__link >Transform the portfolios to be excesses</a> <li class=md-nav__item ><a href="#1-Step-Estimation-using-Seemingly-Unrelated-Regression-(SUR)" class=md-nav__link >1-Step Estimation using Seemingly Unrelated Regression (SUR)</a> <li class=md-nav__item ><a href="#2-Step-Estimation" class=md-nav__link >2-Step Estimation</a> <li class=md-nav__item ><a href="#GMM-Estimation" class=md-nav__link >GMM Estimation</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Iterating-until-convergence" class=md-nav__link >Iterating until convergence</a> <li class=md-nav__item ><a href="#Continuously-Updating-Estimator" class=md-nav__link >Continuously Updating Estimator</a> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../../_sources/asset-pricing/examples/examples.ipynb.txt">Show Source</a> </ul> </nav> <li class=md-nav__item > <a href=formulas.html  class=md-nav__link >Using Formulas</a> <li class=md-nav__item > <a href="../reference.html" class=md-nav__link >Module Reference</a> <li class=md-nav__item > <a href="../mathematical-formula.html" class=md-nav__link >Formulas and Mathematical Detail</a> </ul> <li class=md-nav__item > <a href="../../system/index.html" class=md-nav__link >System Regression Models</a> <li class=md-nav__item > <a href="../../utility.html" class=md-nav__link >Utilities</a> <li class=md-nav__item > <a href="../../compatibility.html" class=md-nav__link >Compatibility</a> <li class=md-nav__item > <a href="../../plan.html" class=md-nav__link >Module Plans</a> <li class=md-nav__item > <a href="../../contributing.html" class=md-nav__link >Contributing</a> <li class=md-nav__item > <a href="../../changes.html" class=md-nav__link >Change Log</a> <li class=md-nav__item > <a href="../../references.html" class=md-nav__link >References</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#asset-pricing-examples-examples--page-root" class=md-nav__link >Examples</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#General-Setup" class=md-nav__link >General Setup</a> <li class=md-nav__item ><a href="#Import-data" class=md-nav__link >Import data</a> <li class=md-nav__item ><a href="#Transform-the-portfolios-to-be-excesses" class=md-nav__link >Transform the portfolios to be excesses</a> <li class=md-nav__item ><a href="#1-Step-Estimation-using-Seemingly-Unrelated-Regression-(SUR)" class=md-nav__link >1-Step Estimation using Seemingly Unrelated Regression (SUR)</a> <li class=md-nav__item ><a href="#2-Step-Estimation" class=md-nav__link >2-Step Estimation</a> <li class=md-nav__item ><a href="#GMM-Estimation" class=md-nav__link >GMM Estimation</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Iterating-until-convergence" class=md-nav__link >Iterating until convergence</a> <li class=md-nav__item ><a href="#Continuously-Updating-Estimator" class=md-nav__link >Continuously Updating Estimator</a> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../../_sources/asset-pricing/examples/examples.ipynb.txt">Show Source</a> <li id=searchbox  class=md-nav__item > </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <style> /* CSS for nbsphinx extension */ /* remove conflicting styling from Sphinx themes */ div.nbinput.container div.prompt *, div.nboutput.container div.prompt *, div.nbinput.container div.input_area pre, div.nboutput.container div.output_area pre, div.nbinput.container div.input_area .highlight, div.nboutput.container div.output_area .highlight { border: none; padding: 0; margin: 0; box-shadow: none; } div.nbinput.container > div[class*=highlight], div.nboutput.container > div[class*=highlight] { margin: 0; } div.nbinput.container div.prompt *, div.nboutput.container div.prompt * { background: none; } div.nboutput.container div.output_area .highlight, div.nboutput.container div.output_area pre { background: unset; } div.nboutput.container div.output_area div.highlight { color: unset; /* override Pygments text color */ } /* avoid gaps between output lines */ div.nboutput.container div[class*=highlight] pre { line-height: normal; } /* input/output containers */ div.nbinput.container, div.nboutput.container { display: -webkit-flex; display: flex; align-items: flex-start; margin: 0; width: 100%; } @media (max-width: 540px) { div.nbinput.container, div.nboutput.container { flex-direction: column; } } /* input container */ div.nbinput.container { padding-top: 5px; } /* last container */ div.nblast.container { padding-bottom: 5px; } /* input prompt */ div.nbinput.container div.prompt pre { color: #307FC1; } /* output prompt */ div.nboutput.container div.prompt pre { color: #BF5B3D; } /* all prompts */ div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: 4.5ex; padding-top: 5px; position: relative; user-select: none; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: absolute; right: 0; margin-right: 0.3ex; } @media (max-width: 540px) { div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: unset; text-align: left; padding: 0.4em; } div.nboutput.container div.prompt.empty { padding: 0; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: unset; } } /* disable scrollbars on prompts */ div.nbinput.container div.prompt pre, div.nboutput.container div.prompt pre { overflow: hidden; } /* input/output area */ div.nbinput.container div.input_area, div.nboutput.container div.output_area { -webkit-flex: 1; flex: 1; overflow: auto; } @media (max-width: 540px) { div.nbinput.container div.input_area, div.nboutput.container div.output_area { width: 100%; } } /* input area */ div.nbinput.container div.input_area { border: 1px solid #e0e0e0; border-radius: 2px; /*background: #f5f5f5;*/ } /* override MathJax center alignment in output cells */ div.nboutput.container div[class*=MathJax] { text-align: left !important; } /* override sphinx.ext.imgmath center alignment in output cells */ div.nboutput.container div.math p { text-align: left; } /* standard error */ div.nboutput.container div.output_area.stderr { background: #fdd; } /* ANSI colors */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } div.nbinput.container div.input_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight].math, div.nboutput.container div.output_area.rendered_html, div.nboutput.container div.output_area > div.output_javascript, div.nboutput.container div.output_area:not(.rendered_html) > img{ padding: 5px; margin: 0; } /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */ div.nbinput.container div.input_area > div[class^='highlight'], div.nboutput.container div.output_area > div[class^='highlight']{ overflow-y: hidden; } /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */ .prompt .copybtn { display: none; } /* Some additional styling taken form the Jupyter notebook CSS */ .jp-RenderedHTMLCommon table, div.rendered_html table { border: none; border-collapse: collapse; border-spacing: 0; color: black; font-size: 12px; table-layout: fixed; } .jp-RenderedHTMLCommon thead, div.rendered_html thead { border-bottom: 1px solid black; vertical-align: bottom; } .jp-RenderedHTMLCommon tr, .jp-RenderedHTMLCommon th, .jp-RenderedHTMLCommon td, div.rendered_html tr, div.rendered_html th, div.rendered_html td { text-align: right; vertical-align: middle; padding: 0.5em 0.5em; line-height: normal; white-space: normal; max-width: none; border: none; } .jp-RenderedHTMLCommon th, div.rendered_html th { font-weight: bold; } .jp-RenderedHTMLCommon tbody tr:nth-child(odd), div.rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .jp-RenderedHTMLCommon tbody tr:hover, div.rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } </style> <section id=Examples > <h1 id=asset-pricing-examples-examples--page-root >Examples<a class=headerlink  href="#asset-pricing-examples-examples--page-root" title="Permalink to this heading">¶</a></h1> <section id=General-Setup > <h2 id=General-Setup >General Setup<a class=headerlink  href="#General-Setup" title="Permalink to this heading">¶</a></h2> <p>Models include factors and returns. Factors can be traded or non-traded. Common examples of traded assets include the excess return on the market and the size and value factors. Examples of non-traded assets include macroeconomic shocks and measures of uncertainty.</p> <p>Models are tested using a set of test portfolios. Test portfolios are often excess returns although they do not need to be.</p> </section> <section id=Import-data > <h2 id=Import-data >Import data<a class=headerlink  href="#Import-data" title="Permalink to this heading">¶</a></h2> <p>The data used comes from Ken French”s <a class="reference external" href="http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html">website</a> and includes 4 factor returns, the excess market, the size factor, the value factor and the momentum factor. The available test portfolios include the 12 industry portfolios, a subset of the size-value two way sort, and a subset of the size-momentum two way sort.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[1]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >linearmodels.datasets</span> <span class=kn >import</span> <span class=n >french</span>

<span class=n >data</span> <span class=o >=</span> <span class=n >french</span><span class=o >.</span><span class=n >load</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >french</span><span class=o >.</span><span class=n >DESCR</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>

Data from Ken French's data library
http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html

dates    Year and Month of Return
MktRF    Market Factor
SMB      Size Factor
HML      Value Factor
Mom      Momentum Factor
RF       Risk-free rate
NoDur    Industry: Non-durables
Durbl    Industry: Durables
Manuf    Industry: Manufacturing
Enrgy    Industry: Energy
Chems    Industry: Chemicals
BusEq    Industry: Business Equipment
Telcm    Industry: Telecoms
Utils    Industry: Utilities
Shops    Industry: Retail
Hlth     Industry: Health care
Money    Industry: Finance
Other    Industry: Other
S1V1     Small firms, low value
S1V3     Small firms, medium value
S1V5     Small firms, high value
S3V1     Size 3, value 1
S3V3     Size 3, value 3
S3V5     Size 3, value 5
S5V1     Large firms, Low value
S5V3     Large firms, medium value
S5V5     Large Firms, High value
S1M1     Small firms, losers
S1M3     Small firms, neutral
S1M5     Small firms, winners
S3M1     Size 3, momentum 1
S3M3     Size 3, momentum 3
S3M5     Size 3, momentum 5
S5M1     Large firms, losers
S5M3     Large firms, neutral
S5M5     Large firms, winners

</pre></div></div> </div> </section> <section id=Transform-the-portfolios-to-be-excesses > <h2 id=Transform-the-portfolios-to-be-excesses >Transform the portfolios to be excesses<a class=headerlink  href="#Transform-the-portfolios-to-be-excesses" title="Permalink to this heading">¶</a></h2> <p>Subtract the risk-free rate from the test portfolios since these are not zero-investment.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >data</span><span class=o >.</span><span class=n >iloc</span><span class=p >[:,</span> <span class=mi >6</span><span class=p >:]</span> <span class=o >=</span> <span class=n >data</span><span class=o >.</span><span class=n >iloc</span><span class=p >[:,</span> <span class=mi >6</span><span class=p >:]</span><span class=o >.</span><span class=n >values</span> <span class=o >-</span> <span class=n >data</span><span class=p >[[</span><span class=s2 >"RF"</span><span class=p >]]</span><span class=o >.</span><span class=n >values</span>
</pre></div> </div> </div> </section> <section id="1-Step-Estimation-using-Seemingly-Unrelated-Regression-(SUR)"> <h2 id="1-Step-Estimation-using-Seemingly-Unrelated-Regression-(SUR)">1-Step Estimation using Seemingly Unrelated Regression (SUR)<a class=headerlink  href="#1-Step-Estimation-using-Seemingly-Unrelated-Regression-(SUR)" title="Permalink to this heading">¶</a></h2> <p>When the factors are traded assets, they must price themselves, and so the observed factor returns can be used to consistently estimate the expected factor returns. This also allows a set of seemingly unrelated regressions where each test portfolio is regressed on the factors and a constant to estimate factor loadings and <span class="math notranslate nohighlight">\(\alpha\)</span>s.</p> <p>Note that when using this type of model, it is essential that the test portfolios are excess returns. This is not a requirement of the other factor model estimators.</p> <p>This specification is a CAP-M since only the market is included. The J-statistic tests whether all model <span class="math notranslate nohighlight">\(\alpha\)</span>s are 0. The CAP-M is unsurprisingly unable to price the test portfolios.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >linearmodels.asset_pricing</span> <span class=kn >import</span> <span class=n >TradedFactorModel</span>

<span class=n >portfolios</span> <span class=o >=</span> <span class=n >data</span><span class=p >[</span>
    <span class=p >[</span><span class=s2 >"S1V1"</span><span class=p >,</span> <span class=s2 >"S1V3"</span><span class=p >,</span> <span class=s2 >"S1V5"</span><span class=p >,</span> <span class=s2 >"S3V1"</span><span class=p >,</span> <span class=s2 >"S3V3"</span><span class=p >,</span> <span class=s2 >"S3V5"</span><span class=p >,</span> <span class=s2 >"S5V1"</span><span class=p >,</span> <span class=s2 >"S5V3"</span><span class=p >,</span> <span class=s2 >"S5V5"</span><span class=p >]</span>
<span class=p >]</span>
<span class=n >factors</span> <span class=o >=</span> <span class=n >data</span><span class=p >[[</span><span class=s2 >"MktRF"</span><span class=p >]]</span>
<span class=n >mod</span> <span class=o >=</span> <span class=n >TradedFactorModel</span><span class=p >(</span><span class=n >portfolios</span><span class=p >,</span> <span class=n >factors</span><span class=p >)</span>
<span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                      TradedFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.6910
No. Factors:                          1   J-statistic:                    70.034
No. Observations:                   819   P-value                         0.0000
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(9)
Time:                          11:44:20
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0065     0.0015     4.3553     0.0000      0.0035      0.0094
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div> </div> <p>The factor set is expanded to include both the size and the value factors.</p> <p>While the extra factors lower the J statistic and increases the <span class="math notranslate nohighlight">\(R^2\)</span>, the model is still easily rejected.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >factors</span> <span class=o >=</span> <span class=n >data</span><span class=p >[[</span><span class=s2 >"MktRF"</span><span class=p >,</span> <span class=s2 >"SMB"</span><span class=p >,</span> <span class=s2 >"HML"</span><span class=p >]]</span>
<span class=n >mod</span> <span class=o >=</span> <span class=n >TradedFactorModel</span><span class=p >(</span><span class=n >portfolios</span><span class=p >,</span> <span class=n >factors</span><span class=p >)</span>
<span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                      TradedFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.8971
No. Factors:                          3   J-statistic:                    53.271
No. Observations:                   819   P-value                         0.0000
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(9)
Time:                          11:44:20
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0065     0.0015     4.3553     0.0000      0.0035      0.0094
SMB            0.0016     0.0010     1.6021     0.1091     -0.0004      0.0035
HML            0.0035     0.0009     3.6993     0.0002      0.0016      0.0053
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div> </div> <p>Changing the test portfolios to include only the industry portfolios does not allow factors to price the assets.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >indu</span> <span class=o >=</span> <span class=p >[</span>
    <span class=s2 >"NoDur"</span><span class=p >,</span>
    <span class=s2 >"Durbl"</span><span class=p >,</span>
    <span class=s2 >"Manuf"</span><span class=p >,</span>
    <span class=s2 >"Enrgy"</span><span class=p >,</span>
    <span class=s2 >"Chems"</span><span class=p >,</span>
    <span class=s2 >"BusEq"</span><span class=p >,</span>
    <span class=s2 >"Telcm"</span><span class=p >,</span>
    <span class=s2 >"Utils"</span><span class=p >,</span>
    <span class=s2 >"Shops"</span><span class=p >,</span>
    <span class=s2 >"Hlth"</span><span class=p >,</span>
    <span class=s2 >"Money"</span><span class=p >,</span>
    <span class=s2 >"Other"</span><span class=p >,</span>
<span class=p >]</span>
<span class=n >portfolios</span> <span class=o >=</span> <span class=n >data</span><span class=p >[</span><span class=n >indu</span><span class=p >]</span>
<span class=n >mod</span> <span class=o >=</span> <span class=n >TradedFactorModel</span><span class=p >(</span><span class=n >portfolios</span><span class=p >,</span> <span class=n >factors</span><span class=p >)</span>
<span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                      TradedFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                 12   R-squared:                      0.7118
No. Factors:                          3   J-statistic:                    61.617
No. Observations:                   819   P-value                         0.0000
Date:                  Thu, Jul 07 2022   Distribution:                 chi2(12)
Time:                          11:44:20
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0065     0.0015     4.3553     0.0000      0.0035      0.0094
SMB            0.0016     0.0010     1.6021     0.1091     -0.0004      0.0035
HML            0.0035     0.0009     3.6993     0.0002      0.0016      0.0053
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div> </div> <p>The estimated factor loadings (<span class="math notranslate nohighlight">\(\beta\)</span>s) can be displayed using the <code class="docutils literal notranslate"><span class=pre >betas</span></code> property. There is reasonable dispersion in the factor loadings for all of the factors, except possibly the market which are all close to unity.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >betas</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
          MktRF       SMB       HML
NoDur  0.803334 -0.029383  0.080556
Durbl  1.176659  0.104124  0.466510
Manuf  1.129601  0.094600  0.197135
Enrgy  0.913425 -0.234012  0.264609
Chems  0.970844 -0.179466  0.092021
BusEq  1.152119  0.182299 -0.543462
Telcm  0.782811 -0.158395  0.044042
Utils  0.605203 -0.175549  0.260051
Shops  0.942997  0.135802 -0.010064
Hlth   0.864135 -0.213336 -0.315180
Money  1.112368 -0.053364  0.378365
Other  1.109851  0.304442  0.237830
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >seaborn</span> <span class=k >as</span> <span class=nn >sns</span>

<span class=o >%</span><span class=k >matplotlib</span> inline
<span class=n >sns</span><span class=o >.</span><span class=n >heatmap</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >betas</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/asset-pricing_examples_examples_14_1.png" src="../../_images/asset-pricing_examples_examples_14_1.png"/> </div> </div> <p>Similarly the <span class="math notranslate nohighlight">\(\alpha\)</span>s can be displayed. These are monthly returns, and so scaling by 12 shows annualized returns. Healthcare has the largest pricing error.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=mi >12</span> <span class=o >*</span> <span class=n >res</span><span class=o >.</span><span class=n >alphas</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
NoDur    0.023360
Durbl   -0.030919
Manuf   -0.010643
Enrgy    0.012009
Chems    0.002783
BusEq    0.024215
Telcm    0.009726
Utils    0.017078
Shops    0.009952
Hlth     0.050760
Money   -0.015197
Other   -0.033345
Name: alpha, dtype: float64
</pre></div></div> </div> </section> <section id=2-Step-Estimation > <h2 id=2-Step-Estimation >2-Step Estimation<a class=headerlink  href="#2-Step-Estimation" title="Permalink to this heading">¶</a></h2> <p>When one of more factors are not returns on traded assets, it is necessary to use a two-step procedure (or GMM). In the 2-step estimator, the first estimates factor loadings and the second uses the factor loadings to estimate the risk premia.</p> <p>Here all four factors are used to attempt to price the size-momentum portfolios.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >linearmodels.asset_pricing</span> <span class=kn >import</span> <span class=n >LinearFactorModel</span>

<span class=n >factors</span> <span class=o >=</span> <span class=n >data</span><span class=p >[[</span><span class=s2 >"MktRF"</span><span class=p >,</span> <span class=s2 >"SMB"</span><span class=p >,</span> <span class=s2 >"HML"</span><span class=p >,</span> <span class=s2 >"Mom"</span><span class=p >]]</span>
<span class=n >portfolios</span> <span class=o >=</span> <span class=n >data</span><span class=p >[</span>
    <span class=p >[</span><span class=s2 >"S1M1"</span><span class=p >,</span> <span class=s2 >"S1M3"</span><span class=p >,</span> <span class=s2 >"S1M5"</span><span class=p >,</span> <span class=s2 >"S3M1"</span><span class=p >,</span> <span class=s2 >"S3M3"</span><span class=p >,</span> <span class=s2 >"S3M5"</span><span class=p >,</span> <span class=s2 >"S5M1"</span><span class=p >,</span> <span class=s2 >"S5M3"</span><span class=p >,</span> <span class=s2 >"S5M5"</span><span class=p >]</span>
<span class=p >]</span>
<span class=n >mod</span> <span class=o >=</span> <span class=n >LinearFactorModel</span><span class=p >(</span><span class=n >portfolios</span><span class=p >,</span> <span class=n >factors</span><span class=p >)</span>
<span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                      LinearFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.9051
No. Factors:                          4   J-statistic:                    36.929
No. Observations:                   819   P-value                         0.0000
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(5)
Time:                          11:44:22
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0070     0.0015     4.5385     0.0000      0.0040      0.0100
SMB            0.0005     0.0014     0.3381     0.7353     -0.0023      0.0033
HML            0.0084     0.0025     3.3085     0.0009      0.0034      0.0133
Mom            0.0084     0.0014     5.8072     0.0000      0.0056      0.0112
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >betas</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
         MktRF       SMB       HML       Mom
S1M1  1.092658  1.224223  0.244844 -0.691191
S1M3  0.874285  0.881880  0.459326 -0.082546
S1M5  1.047256  1.147949  0.239957  0.297941
S3M1  1.156849  0.623684  0.059730 -0.760059
S3M3  0.948556  0.467783  0.333619 -0.135465
S3M5  1.128861  0.713403  0.051098  0.413705
S5M1  1.138597 -0.112936 -0.062397 -0.755032
S5M3  0.946214 -0.200052  0.095270 -0.100067
S5M5  1.078098 -0.046531 -0.069780  0.467172
</pre></div></div> </div> <p>The identification requirements for this model are the the <span class="math notranslate nohighlight">\(\beta\)</span>s have unique variation – this requires some cross-sectional differences in exposures and that the loadings are not excessively correlated. Since these test portfolios do not attempt to sort on value, it is relatively non-dispersed and also correlated with both the market and size. This might make the inference unreliable.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[11]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >betas</span><span class=o >.</span><span class=n >corr</span><span class=p >())</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
          MktRF       SMB       HML       Mom
MktRF  1.000000 -0.001914 -0.733916 -0.253675
SMB   -0.001914  1.000000  0.638056 -0.015628
HML   -0.733916  0.638056  1.000000  0.002744
Mom   -0.253675 -0.015628  0.002744  1.000000
</pre></div></div> </div> <p>The size factor was insignificant and so is dropped. This does not have much of an effect on the estimates.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[12]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >linearmodels.asset_pricing</span> <span class=kn >import</span> <span class=n >LinearFactorModel</span>

<span class=n >factors</span> <span class=o >=</span> <span class=n >data</span><span class=p >[[</span><span class=s2 >"MktRF"</span><span class=p >,</span> <span class=s2 >"HML"</span><span class=p >,</span> <span class=s2 >"Mom"</span><span class=p >]]</span>
<span class=n >portfolios</span> <span class=o >=</span> <span class=n >data</span><span class=p >[</span>
    <span class=p >[</span><span class=s2 >"S1M1"</span><span class=p >,</span> <span class=s2 >"S1M3"</span><span class=p >,</span> <span class=s2 >"S1M5"</span><span class=p >,</span> <span class=s2 >"S3M1"</span><span class=p >,</span> <span class=s2 >"S3M3"</span><span class=p >,</span> <span class=s2 >"S3M5"</span><span class=p >,</span> <span class=s2 >"S5M1"</span><span class=p >,</span> <span class=s2 >"S5M3"</span><span class=p >,</span> <span class=s2 >"S5M5"</span><span class=p >]</span>
<span class=p >]</span>
<span class=n >mod</span> <span class=o >=</span> <span class=n >LinearFactorModel</span><span class=p >(</span><span class=n >portfolios</span><span class=p >,</span> <span class=n >factors</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >())</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                      LinearFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7915
No. Factors:                          3   J-statistic:                    36.406
No. Observations:                   819   P-value                         0.0000
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(6)
Time:                          11:44:22
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0073     0.0017     4.3856     0.0000      0.0040      0.0105
HML            0.0091     0.0027     3.4361     0.0006      0.0039      0.0143
Mom            0.0084     0.0015     5.7507     0.0000      0.0055      0.0113
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div> </div> <p>The risk-free rate can be optionally estimated. This is useful in case excess returns are not available of if the risk-free rate used to construct the excess returns might be misspecified.</p> <p>Here the estimated risk-free rate is small and insignificant and has little impact on the model J-statistic.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >linearmodels.asset_pricing</span> <span class=kn >import</span> <span class=n >LinearFactorModel</span>

<span class=n >factors</span> <span class=o >=</span> <span class=n >data</span><span class=p >[[</span><span class=s2 >"MktRF"</span><span class=p >,</span> <span class=s2 >"HML"</span><span class=p >,</span> <span class=s2 >"Mom"</span><span class=p >]]</span>
<span class=n >portfolios</span> <span class=o >=</span> <span class=n >data</span><span class=p >[</span>
    <span class=p >[</span><span class=s2 >"S1M1"</span><span class=p >,</span> <span class=s2 >"S1M3"</span><span class=p >,</span> <span class=s2 >"S1M5"</span><span class=p >,</span> <span class=s2 >"S3M1"</span><span class=p >,</span> <span class=s2 >"S3M3"</span><span class=p >,</span> <span class=s2 >"S3M5"</span><span class=p >,</span> <span class=s2 >"S5M1"</span><span class=p >,</span> <span class=s2 >"S5M3"</span><span class=p >,</span> <span class=s2 >"S5M5"</span><span class=p >]</span>
<span class=p >]</span>
<span class=n >mod</span> <span class=o >=</span> <span class=n >LinearFactorModel</span><span class=p >(</span><span class=n >portfolios</span><span class=p >,</span> <span class=n >factors</span><span class=p >,</span> <span class=n >risk_free</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >())</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                      LinearFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7915
No. Factors:                          3   J-statistic:                    36.025
No. Observations:                   819   P-value                         0.0000
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(5)
Time:                          11:44:22
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
risk_free     -0.0045     0.0079    -0.5607     0.5750     -0.0200      0.0111
MktRF          0.0111     0.0076     1.4636     0.1433     -0.0038      0.0259
HML            0.0110     0.0053     2.0946     0.0362      0.0007      0.0214
Mom            0.0086     0.0014     5.9315     0.0000      0.0058      0.0114
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div> </div> <p>The default covariance estimator allows for heteroskedasticity but assumes there is no autocorrelation in the model errors or factor returns. Kernel-based HAC estimators (e.g. Newey-West) can be used by setting <code class="docutils literal notranslate"><span class=pre >cov_type="kernel"</span></code>.</p> <p>This reduces the J-statistic indicating there might be some serial correlation although the model is still firmly rejected.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[14]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >mod</span> <span class=o >=</span> <span class=n >LinearFactorModel</span><span class=p >(</span><span class=n >portfolios</span><span class=p >,</span> <span class=n >factors</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"kernel"</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                      LinearFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7915
No. Factors:                          3   J-statistic:                    25.841
No. Observations:                   819   P-value                         0.0002
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(6)
Time:                          11:44:22
Cov. Estimator:                  kernel

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0073     0.0017     4.3094     0.0000      0.0040      0.0106
HML            0.0091     0.0031     2.9499     0.0032      0.0031      0.0152
Mom            0.0084     0.0014     5.8371     0.0000      0.0056      0.0112
==============================================================================

Covariance estimator:
KernelCovariance, Kernel: bartlett, Bandwidth: 12
See full_summary for complete results
</pre></div></div> </div> </section> <section id=GMM-Estimation > <h2 id=GMM-Estimation >GMM Estimation<a class=headerlink  href="#GMM-Estimation" title="Permalink to this heading">¶</a></h2> <p>The final estimator is the GMM estimator which is similar to estimating the 2-step model in a single step. In practice the GMM estimator is estimated at least twice, once to get an consistent estimate of the covariance of the moment conditions and the second time to efficiently estimate parameters.</p> <p>The GMM estimator does not have a closed form and so a non-linear optimizer is required. The default output prints the progress every 10 iterations. Here the model is fit twice, which is the standard method to implement efficient GMM.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[15]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >linearmodels.asset_pricing</span> <span class=kn >import</span> <span class=n >LinearFactorModelGMM</span>

<span class=n >mod</span> <span class=o >=</span> <span class=n >LinearFactorModelGMM</span><span class=p >(</span><span class=n >portfolios</span><span class=p >,</span> <span class=n >factors</span><span class=p >)</span>
<span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
Iteration: 0, Objective: 47.757915828197284
Iteration: 10, Objective: 28.102587098436093
Iteration: 20, Objective: 26.361385729898785
Iteration: 30, Objective: 26.01966763415787
Iteration: 40, Objective: 22.325343252976523
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.325343
         Iterations: 41
         Function evaluations: 2527
         Gradient evaluations: 74
Iteration: 0, Objective: 22.519350258628858
Iteration: 10, Objective: 22.30373016988247
Iteration: 20, Objective: 22.226426792004762
Iteration: 30, Objective: 22.19308134829845
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.066871
         Iterations: 39
         Function evaluations: 2800
         Gradient evaluations: 82
                    LinearFactorModelGMM Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7904
No. Factors:                          3   J-statistic:                    22.067
No. Observations:                   819   P-value                         0.0012
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(6)
Time:                          11:44:24
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0067     0.0015     4.4335     0.0000      0.0037      0.0097
HML            0.0135     0.0023     5.8706     0.0000      0.0090      0.0180
Mom            0.0094     0.0014     6.5139     0.0000      0.0066      0.0123
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div> </div> <p>Kernel HAC estimators can be used with this estimator as well. Using a kernel HAC covariance also implies a Kernel HAC weighting matrix estimator.</p> <p>Here the GMM estimator along with the HAC estimator indicates that these factors might be able to price this set of 9 test portfolios. <code class="docutils literal notranslate"><span class=pre >disp=0</span></code> is used to suppress iterative output.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[16]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"kernel"</span><span class=p >,</span> <span class=n >kernel</span><span class=o >=</span><span class=s2 >"bartlett"</span><span class=p >,</span> <span class=n >disp</span><span class=o >=</span><span class=mi >0</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                    LinearFactorModelGMM Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7901
No. Factors:                          3   J-statistic:                    13.833
No. Observations:                   819   P-value                         0.0316
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(6)
Time:                          11:44:26
Cov. Estimator:                  kernel

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0074     0.0014     5.1450     0.0000      0.0046      0.0102
HML            0.0137     0.0030     4.5918     0.0000      0.0078      0.0195
Mom            0.0078     0.0013     6.0849     0.0000      0.0053      0.0103
==============================================================================

Covariance estimator:
KernelCovariance, Kernel: bartlett, Bandwidth: 20
See full_summary for complete results
</pre></div></div> </div> <section id=Iterating-until-convergence > <h3 id=Iterating-until-convergence >Iterating until convergence<a class=headerlink  href="#Iterating-until-convergence" title="Permalink to this heading">¶</a></h3> <p>The standard approach is efficient and uses 2-steps. The first consistently estimates parameters using a sub-optimal weighting matrix, and the second uses the optimal weighting matrix conditional using the first stage estimates.</p> <p>This method can be repeated until convergence, or for a fixed number of steps using the <code class="docutils literal notranslate"><span class=pre >steps</span></code> keyword argument.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[17]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >steps</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >disp</span><span class=o >=</span><span class=mi >25</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
Iteration: 0, Objective: 47.757915828197284
Iteration: 25, Objective: 26.28032089972988
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.325343
         Iterations: 41
         Function evaluations: 2527
         Gradient evaluations: 74
Iteration: 0, Objective: 22.519350258628858
Iteration: 25, Objective: 22.22221749185295
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.066871
         Iterations: 39
         Function evaluations: 2800
         Gradient evaluations: 82
Iteration: 0, Objective: 22.09415705364044
Iteration: 25, Objective: 22.091266626537124
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.089908
         Iterations: 37
         Function evaluations: 2698
         Gradient evaluations: 79
Iteration: 0, Objective: 22.088798288828393
Iteration: 25, Objective: 22.08877142658468
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.088753
         Iterations: 39
         Function evaluations: 3106
         Gradient evaluations: 91
Iteration: 0, Objective: 22.088622391467595
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.088622
         Iterations: 4
         Function evaluations: 1303
         Gradient evaluations: 38
Iteration: 0, Objective: 22.088622314773033
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.088622
         Iterations: 3
         Function evaluations: 964
         Gradient evaluations: 28
                    LinearFactorModelGMM Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7904
No. Factors:                          3   J-statistic:                    22.089
No. Observations:                   819   P-value                         0.0012
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(6)
Time:                          11:44:31
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0067     0.0015     4.4231     0.0000      0.0037      0.0096
HML            0.0135     0.0023     5.8726     0.0000      0.0090      0.0180
Mom            0.0094     0.0014     6.5017     0.0000      0.0066      0.0123
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div> </div> </section> <section id=Continuously-Updating-Estimator > <h3 id=Continuously-Updating-Estimator >Continuously Updating Estimator<a class=headerlink  href="#Continuously-Updating-Estimator" title="Permalink to this heading">¶</a></h3> <p>The Continuously Updating Estimator (CUE) is optionally available using the flag <code class="docutils literal notranslate"><span class=pre >use_cue</span></code>. CUE jointly minimizes the J-statistic as a function of the moment conditions and the weighting matrix, rather than iterating between minimizing the J-statistic for a fixed weighting matrix and updating the weighting matrix.</p> <p>Here the results are essentially the same as in the iterative approach.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[18]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >use_cue</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
Iteration: 0, Objective: 47.757915828197284
Iteration: 10, Objective: 28.102587098436093
Iteration: 20, Objective: 26.361385729898785
Iteration: 30, Objective: 26.01966763415787
Iteration: 40, Objective: 22.325343252976523
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.325343
         Iterations: 41
         Function evaluations: 2527
         Gradient evaluations: 74
Iteration: 0, Objective: 22.52447926851486
Iteration: 10, Objective: 22.386058204052368
Iteration: 20, Objective: 22.339808266160333
Iteration: 30, Objective: 22.308312456908368
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.077574
         Iterations: 38
         Function evaluations: 2969
         Gradient evaluations: 87
                    LinearFactorModelGMM Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7903
No. Factors:                          3   J-statistic:                    22.719
No. Observations:                   819   P-value                         0.0009
Date:                  Thu, Jul 07 2022   Distribution:                  chi2(6)
Time:                          11:44:36
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0067     0.0015     4.4157     0.0000      0.0037      0.0096
HML            0.0136     0.0023     5.8881     0.0000      0.0090      0.0181
Mom            0.0094     0.0014     6.4984     0.0000      0.0066      0.0123
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div> </div> </section> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> <a href="../introduction.html" title=Introduction  class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev > <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Previous </span> Introduction </span> </div> </a> <a href=formulas.html  title="Using Formulas" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next > <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Next </span> Using Formulas </span> </div> <div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2017, Kevin Sheppard. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.0.2. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>