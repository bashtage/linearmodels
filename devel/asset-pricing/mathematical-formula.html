<!DOCTYPE html> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0"> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../_static/javascripts/modernizr.js"></script> <title>Formulas and Mathematical Detail &#8212; linearmodels 4.17+24.g796e262 documentation</title> <link rel=apple-touch-icon  sizes=180x180  href="../_static/icons/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="../_static/icons/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="../_static/icons/favicon-16x16.png"> <link rel=manifest  href="../_static/icons/site.webmanifest"> <link rel=mask-icon  href="../_static/icons/safari-pinned-tab.svg" color="#2196f3"> <link rel="shortcut icon" href="../_static/icons/favicon.ico"> <meta name=msapplication-TileColor  content="#f8f8f8"> <meta name=msapplication-config  content="../_static/icons/browserconfig.xml"> <style> .highlight { background-color: hsla(0,0%,92.5%,.5) !important; } </style> <link rel=stylesheet  href="../_static/material.css" type="text/css" /> <link rel=stylesheet  href="../_static/pygments.css" type="text/css" /> <script id=documentation_options  data-url_root="../" src="../_static/documentation_options.js"></script> <script src="../_static/jquery.js"></script> <script src="../_static/underscore.js"></script> <script src="../_static/doctools.js"></script> <script src="../_static/language_data.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script async=async  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script> <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script> <link rel="shortcut icon" href="../_static/favicon.ico"/> <link rel=index  title=Index  href="../genindex.html" /> <link rel=search  title=Search  href="../search.html" /> <link rel=next  title="System Regression Models" href="../system/index.html" /> <link rel=prev  title=linearmodels.asset_pricing.covariance.KernelCovariance.square  href="asset-pricing/linearmodels.asset_pricing.covariance.KernelCovariance.square.html" /> <body dir=ltr data-md-color-primary=blue data-md-color-accent=orange> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#asset-pricing/mathematical-formula" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../index.html" title="linearmodels 4.17+24.g796e262 documentation" class="md-header-nav__button md-logo"> <img src="../_static/bw-logo.svg" height=26  alt="linearmodels 4.17+24.g796e262 documentation logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >linearmodels 4.17 (+24)</span> <span class=md-header-nav__topic > Formulas and Mathematical Detail </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../search.html" method=GET  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> </div> <div class="md-flex__cell md-flex__cell--shrink dropdown"> <button class=dropdownbutton >Versions</button> <div class="dropdown-content md-hero"> <a title=Release  href="https://bashtage.github.io/linearmodels/">Release</a> <a title=Development  href="https://bashtage.github.io/linearmodels/devel/">Development</a> </div> </div> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href=index.html  class=md-tabs__link >Linear Factor Models for Asset Pricing</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../index.html" title="linearmodels 4.17+24.g796e262 documentation" class="md-nav__button md-logo"> <img src="../_static/bw-logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../index.html" title="linearmodels 4.17+24.g796e262 documentation">linearmodels 4.17 (+24)</a> </label> <div class=md-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <a href="../iv/index.html" class=md-nav__link >Instrumental Variable Estimation</a> <li class=md-nav__item > <a href="../panel/index.html" class=md-nav__link >Panel Data Model Estimation</a> <li class=md-nav__item > <a href=index.html  class=md-nav__link >Linear Factor Models for Asset Pricing</a> <ul class=md-nav__list > <li class=md-nav__item > <a href=introduction.html  class=md-nav__link >Introduction</a> <li class=md-nav__item > <a href="examples/examples.html" class=md-nav__link >Examples</a> <li class=md-nav__item > <a href="examples/formulas.html" class=md-nav__link >Using Formulas</a> <li class=md-nav__item > <a href=reference.html  class=md-nav__link >Module Reference</a> <li class=md-nav__item > <input class="md-toggle md-nav__toggle" data-md-toggle=toc  type=checkbox  id=__toc > <label class="md-nav__link md-nav__link--active" for=__toc > Formulas and Mathematical Detail </label> <a href="#" class="md-nav__link md-nav__link--active">Formulas and Mathematical Detail</a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#asset-pricing-mathematical-formula--page-root" class=md-nav__link >Formulas and Mathematical Detail</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#linear-factor-model-for-traded-factors" class=md-nav__link >Linear Factor Model for Traded Factors</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#the-j-statistic" class=md-nav__link >The J statistic</a> </ul> </nav> <li class=md-nav__item ><a href="#linear-factor-model-for-non-traded-factors" class=md-nav__link >Linear Factor Model for Non-traded Factors</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#improved-specification-using-gls" class=md-nav__link >Improved Specification using GLS</a> <li class=md-nav__item ><a href="#id1" class=md-nav__link >The J statistic</a> </ul> </nav> <li class=md-nav__item ><a href="#gmm-estimation-of-linear-factor-models" class=md-nav__link >GMM Estimation of Linear Factor Models</a> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../_sources/asset-pricing/mathematical-formula.rst.txt">Show Source</a> </ul> </nav> </ul> <li class=md-nav__item > <a href="../system/index.html" class=md-nav__link >System Regression Models</a> <li class=md-nav__item > <a href="../utility.html" class=md-nav__link >Utilities</a> <li class=md-nav__item > <a href="../plan.html" class=md-nav__link >Module Plans</a> <li class=md-nav__item > <a href="../contributing.html" class=md-nav__link >Contributing</a> <li class=md-nav__item > <a href="../changes.html" class=md-nav__link >Change Log</a> <li class=md-nav__item > <a href="../references.html" class=md-nav__link >References</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#asset-pricing-mathematical-formula--page-root" class=md-nav__link >Formulas and Mathematical Detail</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#linear-factor-model-for-traded-factors" class=md-nav__link >Linear Factor Model for Traded Factors</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#the-j-statistic" class=md-nav__link >The J statistic</a> </ul> </nav> <li class=md-nav__item ><a href="#linear-factor-model-for-non-traded-factors" class=md-nav__link >Linear Factor Model for Non-traded Factors</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#improved-specification-using-gls" class=md-nav__link >Improved Specification using GLS</a> <li class=md-nav__item ><a href="#id1" class=md-nav__link >The J statistic</a> </ul> </nav> <li class=md-nav__item ><a href="#gmm-estimation-of-linear-factor-models" class=md-nav__link >GMM Estimation of Linear Factor Models</a> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../_sources/asset-pricing/mathematical-formula.rst.txt">Show Source</a> <li id=searchbox  class=md-nav__item > </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <span id=asset-pricing-mathematical-notation ></span><h1 id=asset-pricing-mathematical-formula--page-root >Formulas and Mathematical Detail<a class=headerlink  href="#asset-pricing-mathematical-formula--page-root" title="Permalink to this headline">¶</a></h1> <p>There are <span class="math notranslate nohighlight">\(N\)</span> test portfolios, <span class="math notranslate nohighlight">\(r_{t}\)</span> (<span class="math notranslate nohighlight">\(p\)</span> by 1) which are usually assumed to be excess returns (zero-investment portfolios) and <span class="math notranslate nohighlight">\(K\)</span> factors, <span class="math notranslate nohighlight">\(f_{t}\)</span> (<span class="math notranslate nohighlight">\(k\)</span> by 1). For return series there are <span class="math notranslate nohighlight">\(T\)</span> observations.</p> <h2 id=linear-factor-model-for-traded-factors >Linear Factor Model for Traded Factors<a class=headerlink  href="#linear-factor-model-for-traded-factors" title="Permalink to this headline">¶</a></h2> <p>This model is a Seemingly Unrelated Regression (SUR). All models share the same regressors so that the model for test portfolio <span class="math notranslate nohighlight">\(i\)</span> is</p> <div class="math notranslate nohighlight"> \[r_{it}=\alpha_{i}+\beta_{i}f_{t}+\epsilon_{it}.\]</div> <p>Inference is based on the sandwich covariance estimator</p> <div class="math notranslate nohighlight"> \[\hat{\Sigma}=\left(T-df\right)^{-1}G^{-1}SG^{-1}.\]</div> <p>Define <span class="math notranslate nohighlight">\(f_{c,t}=\left[1\:f_{t}^{\prime}\right]^{\prime}\)</span>, then</p> <div class="math notranslate nohighlight"> \[\hat{G}=I_{N}\otimes\Sigma_{f_{c}}\]</div> <p>and</p> <div class="math notranslate nohighlight"> \[\Sigma_{f_{c}}=T^{-1}\sum_{t=1}^{T}f_{c,t}f_{c,t}^{\prime}\]</div> <p>Define the stacked vector of scores (or moment conditions)</p> <div class="math notranslate nohighlight"> \[g_{t}=\left[f_{c}\otimes\hat{\epsilon}_{t}\right].\]</div> <p>If the heteroskedasticity robust estimator is used,</p> <div class="math notranslate nohighlight"> \[\hat{S}=T^{-1}\sum_{t=1}^{T}g_{t}g_{t}^{\prime}.\]</div> <p>If the HAC estimator is used,</p> <div class="math notranslate nohighlight"> \[\begin{split}\begin{aligned} \hat{S} &amp; =T^{-1}\left\{ \hat{\Gamma}_{0}+\sum_{i=1}^{bw}K\left(\frac{i}{bw}\right)\left(\hat{\Gamma}_{i}+\hat{\Gamma}_{i}^{\prime}\right)\right\} \\ \hat{\Gamma}_{j} &amp; =\sum_{t=j+1}^{T}g_{t}g_{t-j}^{\prime}\end{aligned}\end{split}\]</div> <p>where <span class="math notranslate nohighlight">\(K\left(\frac{i}{bw}\right)\)</span> is a kernel weighting function and <span class="math notranslate nohighlight">\(bw\)</span> is the bandwidth. The reported risk premia are just the average returns on the factors, and the covariance of the risk premia estimates is based on the factor residuals after demeaning using either the simple estimator or the kernel estimator.</p> <h3 id=the-j-statistic >The J statistic<a class=headerlink  href="#the-j-statistic" title="Permalink to this headline">¶</a></h3> <p>The J statistic is implemented as</p> <div class="math notranslate nohighlight"> \[J=\hat{\alpha}^{\prime}\hat{\Sigma}_{\alpha}^{-1}\hat{\alpha}^{\prime}\sim\chi_{N}^{2}\]</div> <p>where <span class="math notranslate nohighlight">\(\hat{\Sigma}_{\alpha}\)</span> consists of rows and columns<span class="math notranslate nohighlight">\(1,(k+1)+1,2(k+1)+1,\ldots\)</span> of <span class="math notranslate nohighlight">\(\hat{\Sigma}\)</span>.</p> <h2 id=linear-factor-model-for-non-traded-factors >Linear Factor Model for Non-traded Factors<a class=headerlink  href="#linear-factor-model-for-non-traded-factors" title="Permalink to this headline">¶</a></h2> <p>When factors are not traded, the SUR approach cannot be used since the expected value of the factor is not equal to its risk premium. One solution is to use a multi-step estimator. The first step regresses the test portfolio returns on the factors and a (throw-away) constant. This constant is included only to demean the factors to compute the correct factor loadings. The second stage then uses the estimated factor loadings and the average portfolio returns to estimate the risk premia. This second stage can be (optionally) improved by removing the effects of the demeaned factors from returns when computing risk premia.</p> <p>The first stage regressions are virtually identical to the SUR regressions except the constant is no longer <span class="math notranslate nohighlight">\(\alpha_{i}\)</span>,</p> <div class="math notranslate nohighlight"> \[r_{it}^{e}=c_{i}+\beta_{i}f_{t}+\epsilon_{it}.\]</div> <p>The second stage regression then uses the estimated coefficients as regressors to estimate the risk premia,</p> <div class="math notranslate nohighlight"> \[\bar{r}_{i}^{e}=\left[1_{N}\,\hat{\beta}\right]\lambda+\eta_{i}.\]</div> <p>Note that the residual from this regression<span class="math notranslate nohighlight">\(\hat{\eta}_{i}=\hat{\alpha}_{i}\)</span>, the excess compensation test portfolio <span class="math notranslate nohighlight">\(i\)</span> is generating. If the risk free rate is assumed to be 0, then the column of 1s is not included and <span class="math notranslate nohighlight">\(\lambda\)</span> is <span class="math notranslate nohighlight">\(K\)</span> by 1.</p> <p>Inference is conducted by treating this as a 3-step GMM problem where the first two steps were just described and the third estimated the model <span class="math notranslate nohighlight">\(\hat{\alpha}\)</span>. The moment conditions corresponding to the FOC of these three steps are</p> <div class="math notranslate nohighlight"> \[\begin{split}g_{t}=\left[\begin{array}{c} f_{c,t}\otimes\epsilon_{t}\\ \left[1_{N}\,\beta\right]^{\prime}\left(r_{t}-\left[1_{N}\,\beta\right]\lambda\right)\\ r_{t}-\left[1_{N}\,\beta\right]\lambda-\alpha \end{array}\right]\end{split}\]</div> <p>where <span class="math notranslate nohighlight">\(\epsilon_{it}=r_{it}^{e}-c_{i}-\beta_{i}f_{t}\)</span> is <span class="math notranslate nohighlight">\(N\)</span> by 1 , <span class="math notranslate nohighlight">\(\beta\)</span> is <span class="math notranslate nohighlight">\(N\)</span> by <span class="math notranslate nohighlight">\(K\)</span>, <span class="math notranslate nohighlight">\(\lambda\)</span> is <span class="math notranslate nohighlight">\(K+1\)</span> by 1 and<span class="math notranslate nohighlight">\(\alpha\)</span> is <span class="math notranslate nohighlight">\(N\)</span> by 1. Inference is based on</p> <div class="math notranslate nohighlight"> \[\hat{\Sigma}=\left(T-df\right)^{-1}G^{-1}S\left(G^{-1}\right)^{\prime}\]</div> <p>where the Jacobian <span class="math notranslate nohighlight">\(G\)</span> is estimated by</p> <div class="math notranslate nohighlight"> \[\begin{split}\hat{G}=-\left[\begin{array}{ccc} I_{N}\otimes\Sigma_{f_{c}} &amp; 0 &amp; 0\\ G_{21} &amp; \left[1_{N}\,\hat{\beta}\right]^{\prime}\left[1_{N}\,\hat{\beta}\right] &amp; 0\\ I_{N}\otimes\left[0\ \hat{\lambda}\right] &amp; \left[1_{N}\,\hat{\beta}\right] &amp; I_{N} \end{array}\right]\end{split}\]</div> <p>The block <span class="math notranslate nohighlight">\(G_{21}\)</span>is</p> <div class="math notranslate nohighlight"> \[G_{21}=\left[G_{21,1}\ G_{21,2}\:\ldots\ G_{21,N}\right]\]</div> <div class="math notranslate nohighlight"> \[G_{21,i}=\left[0_{\left(K+1\right)\times1}\;\left(\left[1\;\hat{\beta}_{i}\right]^{\prime}\lambda^{\prime}-\left[0_{K}\;\bar{u}_{i}I_{K}\right]^{\prime}\right)\right]\]</div> <p>When the risk free rate is 0, all terms of the form <span class="math notranslate nohighlight">\([1_{N}\;\beta]\)</span> become <span class="math notranslate nohighlight">\(\beta\)</span> and</p> <div class="math notranslate nohighlight"> \[G_{21,i}=\left[0_{K\times1}\;\left(\hat{\beta}_{i}^{\prime}\lambda^{\prime}-\;\bar{u}_{i}I_{K}\right)\right]\]</div> <p><span class="math notranslate nohighlight">\(S\)</span> is an estimator of the covariance of the moment conditions, <span class="math notranslate nohighlight">\(g_{t}\)</span>, and its form is identical to either the heteroskedasticity consistent estimator or the HAC estimator in the previous section.</p> <h3 id=improved-specification-using-gls >Improved Specification using GLS<a class=headerlink  href="#improved-specification-using-gls" title="Permalink to this headline">¶</a></h3> <div class="math notranslate nohighlight"> \[\begin{split}\left[\begin{array}{c} f_{c,t}\otimes\epsilon_{t}\\ \beta_{c}^{\prime}\Sigma^{-1}\left(r_{t}-\beta_{c}\lambda\right)\\ r_{t}-\beta_{c}\lambda-\alpha \end{array}\right]\end{split}\]</div> <p>The Jacobian is than</p> <div class="math notranslate nohighlight"> \[\begin{split}\hat{G}=-\left[\begin{array}{ccc} I_{N}\otimes\Sigma_{f_{c}} &amp; 0 &amp; 0\\ G_{12} &amp; \hat{\beta}_{c}^{\prime}\Sigma^{-1}\hat{\beta}_{c} &amp; 0\\ I_{N}\otimes\left[0\ \tilde{\lambda}\right] &amp; \hat{\beta}_{c} &amp; I_{N} \end{array}\right]\end{split}\]</div> <p><span class="math notranslate nohighlight">\(\beta_{c}=\left[1_{N}\,\beta\right]\)</span>. <span class="math notranslate nohighlight">\(\tilde{\lambda}=\left[\lambda_{1},\ldots,\lambda_{K}\right]\)</span> and so does not include the risk-free rate <span class="math notranslate nohighlight">\(\lambda_{0}\)</span> when included in the model. The final piece has the structure</p> <div class="math notranslate nohighlight"> \[G_{21}=\left[G_{21,1}\ G_{21,2}\:\ldots\ G_{21,N}\right]\]</div> <div class="math notranslate nohighlight"> \[G_{21,i}=\left[0_{\left(K+1\right)}\;\tilde{\beta}_{c,i}^{\prime}\tilde{\lambda}^{\prime}-\left[0_{K}\;\bar{u}_{i}I_{K}\right]^{\prime}\right]\]</div> <p>where <span class="math notranslate nohighlight">\(\tilde{\beta}_{c,i}\)</span> is row <span class="math notranslate nohighlight">\(i\)</span> of <span class="math notranslate nohighlight">\(\Sigma^{-1}\beta_{c}\)</span>, <span class="math notranslate nohighlight">\(\bar{u}_{i}=T^{-1}\sum_{t=1}^{T}\tilde{u}_{it}\)</span> and <span class="math notranslate nohighlight">\(\tilde{u}_{it}\)</span> is the element in position <span class="math notranslate nohighlight">\(i\)</span> of <span class="math notranslate nohighlight">\(\tilde{u}_{t}=\Sigma^{-1}\left(r_{t}-\lambda_{0}-\beta\tilde{\lambda}\right)\)</span>. Each block has a 0 columns corresponding to <span class="math notranslate nohighlight">\(c_{i}\)</span>.</p> <p><span class="math notranslate nohighlight">\(S\)</span> is an estimator of the covariance of the moment conditions, <span class="math notranslate nohighlight">\(g_{t}\)</span>, and its form is identical to either the heteroskedasticity consistent estimator or the HAC estimator in the previous section.</p> <h3 id=id1 >The J statistic<a class=headerlink  href="#id1" title="Permalink to this headline">¶</a></h3> <p>The J statistic is virtually identical to the <span class="math notranslate nohighlight">\(J\)</span> statistic from traded factor model except that it has a difference distribution.</p> <div class="math notranslate nohighlight"> \[J=\hat{\alpha}^{\prime}\hat{\Sigma}_{\alpha}^{-1}\hat{\alpha}^{\prime}\sim\chi_{N-K}^{2}\]</div> <p>The loss of degrees of freedom occurs since <span class="math notranslate nohighlight">\(\hat{\alpha}=\hat{\eta}\)</span> which are regression residuals from a regression of <span class="math notranslate nohighlight">\(N\)</span> average returns on <span class="math notranslate nohighlight">\(K\)</span> factor loadings. <span class="math notranslate nohighlight">\(\hat{\Sigma}_{\alpha}\)</span> is the bottom right <span class="math notranslate nohighlight">\(K\times K\)</span> block of <span class="math notranslate nohighlight">\(\hat{\Sigma}\)</span>.</p> <h2 id=gmm-estimation-of-linear-factor-models >GMM Estimation of Linear Factor Models<a class=headerlink  href="#gmm-estimation-of-linear-factor-models" title="Permalink to this headline">¶</a></h2> <p>The GMM estimator solves a set of non-linear moment conditions of the form</p> <div class="math notranslate nohighlight"> \[\begin{split}\left[\begin{array}{c} \epsilon_{t}\otimes f_{c,t}\\ f_{t}-\mu \end{array}\right]\end{split}\]</div> <p>where</p> <div class="math notranslate nohighlight"> \[\epsilon_{t}=r_{t}-\left[1_{N}\;\beta\right]\lambda-\beta\left(f_{t}-\mu\right)\]</div> <p>is the vector of pricing errors. The factors can be traded or non-traded. This assumes that the model for expected returns is</p> <div class="math notranslate nohighlight"> \[E\left[r_{it}\right]=\lambda_{0}+\sum_{i=1}^{k}\beta_{i}\lambda_{i}\]</div> <p>so that the risk-free rate might not be zero. This form is sometimes used with excess returns if there is doubt about the risk-free rate used. The Jacobian is then</p> <div class="math notranslate nohighlight"> \[\begin{split}\hat{G}=T^{-1}\sum_{t=1}^{T}-\left[\begin{array}{ccc} I_{N}\otimes\left(f_{t}-\mu+\tilde{\lambda}\right)f_{c,t} &amp; \left[\begin{array}{c} f_{c,t}\left[1\!\hat{\beta}_{1}\right]\\ \vdots\\ f_{c,t}\left[1\!\hat{\beta}_{N}\right] \end{array}\right] &amp; \left[\begin{array}{c} -f_{c,t}\hat{\beta}_{1}\\ \vdots\\ -f_{c,t}\hat{\beta}_{N} \end{array}\right]\\ 0 &amp; 0 &amp; I_{K} \end{array}\right]\end{split}\]</div> <p><span class="math notranslate nohighlight">\(S\)</span> is an estimator of the covariance of the moment conditions, <span class="math notranslate nohighlight">\(g_{t}\)</span>, and its form is identical to either the heteroskedasticity consistent estimator or the HAC estimator in the previous section. The parameter covariance estimator uses the form appropriate for efficient GMM,</p> <div class="math notranslate nohighlight"> \[\hat{\Sigma}=\left(\hat{G}\hat{^{\prime}S}^{-1}\hat{G}\right)^{-1}.\]</div> <p>Sources used in writing the code include <a class="reference internal" href="../references.html#bryzgalova" id=id2 ><span>[Bryzgalova]</span></a>, <a class="reference internal" href="../references.html#cochrane" id=id3 ><span>[Cochrane]</span></a> and <a class="reference internal" href="../references.html#jagannathanetal" id=id4 ><span>[JagannathanEtAl]</span></a>.</p> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> <a href="asset-pricing/linearmodels.asset_pricing.covariance.KernelCovariance.square.html" title=linearmodels.asset_pricing.covariance.KernelCovariance.square  class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev > <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Previous </span> linearmodels.asset_pricing.covariance.KernelCovariance.square </span> </div> </a> <a href="../system/index.html" title="System Regression Models" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next > <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Next </span> System Regression Models </span> </div> <div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2017, Kevin Sheppard. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.1.2. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>