



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../introduction.html">
      
      
        <link rel="next" href="advanced-examples.html">
      
      
      <link rel="icon" href="../../_static/favicon.ico">
    
    
  
      
        <title>Basic Examples - linearmodels v6.2 (+25)</title>
      
    

  <link rel="apple-touch-icon" sizes="180x180" href="../../_static/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../_static/icons/safari-pinned-tab.svg" color="#2196f3">
  <link rel="shortcut icon" href="../../_static/icons/favicon.ico">
  <meta name="msapplication-TileColor" content="#f8f8f8">
  <meta name="msapplication-config" content="../../_static/icons/browserconfig.xml">

    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../_static/sphinx_immaterial_theme.6ec1c446c2c357833.min.css?v=e2e8fea8" />
        <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
        <link rel="stylesheet" type="text/css" href="../../_static/css/small_fixes.css?v=34934119" />
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Wages-of-Married-Women" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="linearmodels v6.2 (+25)" class="md-header__button md-logo" aria-label="linearmodels v6.2 (+25)" data-md-component="logo">
      <img src="../../_static/bw-logo.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            linearmodels v6.2 (+25)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Basic Examples
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    linearmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="linearmodels v6.2 (+25)" class="md-nav__button md-logo" aria-label="linearmodels v6.2 (+25)" data-md-component="logo">
      <img src="../../_static/bw-logo.svg" alt="logo">
    </a>
    linearmodels v6.2 (+25)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    linearmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/iv/index.rst (reference label)">Instrumental Variable Estimation</span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            <span title="/iv/index.rst (reference label)">Instrumental Variable Estimation</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/iv/introduction.rst (reference label)">Introduction</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/iv/examples/basic-examples.ipynb (reference label)">Basic Examples</span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/iv/examples/basic-examples.ipynb (reference label)">Basic Examples</span>
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Wages-of-Married-Women" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#wages-of-married-women (reference label)">Wages of Married Women</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Wages-of-Men" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#wages-of-men (reference label)">Wages of Men</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Weighted-IV" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#weighted-iv (reference label)">Weighted IV</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Smoking-and-birth-weight" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#smoking-and-birth-weight (reference label)">Smoking and birth weight</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Proximity-and-education" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#proximity-and-education (reference label)">Proximity and education</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Formula-interface" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#formula-interface (reference label)">Formula interface</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Categorical-Variables" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#categorical-variables (reference label)">Categorical Variables</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Post-estimation-diagnostics" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#post-estimation-diagnostics (reference label)">Post-<wbr>estimation diagnostics</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Panel-IV" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#panel-iv (reference label)">Panel IV</span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="advanced-examples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/iv/examples/advanced-examples.ipynb (reference label)">Further Examples</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="using-formulas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/iv/examples/using-formulas.ipynb (reference label)">Using formulas to specify models</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="absorbing-regression.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/iv/examples/absorbing-regression.ipynb (reference label)">Absorbing Regression</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/iv/reference.rst (reference label)">Module Reference</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../mathematical-formula.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/iv/mathematical-formula.rst (reference label)">Formulas and Mathematical Detail</span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../panel/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/panel/index.rst (reference label)">Panel Data Model Estimation</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asset-pricing/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/asset-pricing/index.rst (reference label)">Linear Factor Models for Asset Pricing</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/system/index.rst (reference label)">System Regression Models</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utility.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/utility.rst (reference label)">Utilities</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compatibility.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/compatibility.rst (reference label)">Compatibility</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../types.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/types.rst (reference label)">Type Aliases</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plan.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/plan.rst (reference label)">Module Plans</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/contributing.rst (reference label)">Contributing</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/changes.rst (reference label)">Change Log</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/references.rst (reference label)">References</span>
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Wages-of-Married-Women" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#wages-of-married-women (reference label)">Wages of Married Women</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Wages-of-Men" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#wages-of-men (reference label)">Wages of Men</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Weighted-IV" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#weighted-iv (reference label)">Weighted IV</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Smoking-and-birth-weight" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#smoking-and-birth-weight (reference label)">Smoking and birth weight</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Proximity-and-education" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#proximity-and-education (reference label)">Proximity and education</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Formula-interface" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#formula-interface (reference label)">Formula interface</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Categorical-Variables" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#categorical-variables (reference label)">Categorical Variables</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Post-estimation-diagnostics" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#post-estimation-diagnostics (reference label)">Post-<wbr>estimation diagnostics</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Panel-IV" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/iv/examples/basic-examples.ipynb#panel-iv (reference label)">Panel IV</span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="Basic-Examples">Basic Examples<a class="headerlink" href="#Basic-Examples" title="Link to this heading">¶</a></h1>
<p>These examples are based on <strong>Chapter 15</strong> of <em>Introduction to Econometrics</em> by Jeffrey Wooldridge and demonstrate the basic use of the IV estimators (primarily IV2SLS – the two-stage least squares estimator)</p>
<h2 id="Wages-of-Married-Women">Wages of Married Women<a class="headerlink" href="#Wages-of-Married-Women" title="Link to this heading">¶</a></h2>
<p>This first example examines the effect of education on the wages of women. Education is a classic endogenous variable since it has signaling value beyond the actual direct effect (among other reasons).</p>
<p>This first block imports the data and uses the <code class="docutils literal notranslate"><span class="pre">DESCR</span></code> attribute to describe the dataset. <code class="docutils literal notranslate"><span class="pre">add_constant</span></code> from statsmodels is used to add a variable named <code class="docutils literal notranslate"><span class="pre">const</span></code> to the DataFrame. Observations with missing values are dropped.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">add_constant</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">linearmodels.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">mroz</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mroz</span><span class="o">.</span><span class="n">DESCR</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">mroz</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">has_constant</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

T.A. Mroz (1987), &#34;The Sensitivity of an Empirical Model of Married Women&#39;s
Hours of Work to Economic and Statistical Assumptions,&#34; Econometrica 55,
765-799.

nlf        1 if in labor force, 1975
hours      hours worked, 1975
kidslt6    # kids &lt; 6 years
kidsge6    # kids 6-18
age        woman&#39;s age in yrs
educ       years of schooling
wage       estimated wage from earns., hours
repwage    reported wage at interview in 1976
hushrs     hours worked by husband, 1975
husage     husband&#39;s age
huseduc    husband&#39;s years of schooling
huswage    husband&#39;s hourly wage, 1975
faminc     family income, 1975
mtr        fed. marginal tax rate facing woman
motheduc   mother&#39;s years of schooling
fatheduc   father&#39;s years of schooling
unem       unem. rate in county of resid.
city       =1 if live in SMSA
exper      actual labor mkt exper
nwifeinc   (faminc - wage*hours)/1000
lwage      log(wage)
expersq    exper^2

</pre></div></div>
</div>
<p>Since OLS is a special case of 2SLS, IV2SLS can be used to estimate a model using OLS by setting <code class="docutils literal notranslate"><span class="pre">endog</span></code> and <code class="docutils literal notranslate"><span class="pre">instruments</span></code> variables to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>This first regression uses OLS to estimate the effect of education on the log of wage. It indicates that 1 year of education increases wage by 10%.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">linearmodels.iv</span><span class="w"> </span><span class="kn">import</span> <span class="n">IV2SLS</span>

<span class="n">res_ols</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">wage</span><span class="p">),</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;educ&quot;</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_ols</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Estimation Summary
==============================================================================
Dep. Variable:                   wage   R-squared:                      0.1179
Estimator:                        OLS   Adj. R-squared:                 0.1158
No. Observations:                 428   F-statistic:                    57.196
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:49   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.1852     0.1848    -1.0022     0.3163     -0.5474      0.1770
educ           0.1086     0.0144     7.5628     0.0000      0.0805      0.1368
==============================================================================
</pre></div></div>
</div>
<p>Two-stage least squares is estimated “as-if” two regressions are run. Here the first stage regression where OLS is used to fit the value on the instrument (in this case the education of the subject”s father). The fitted value is saved for use later.</p>
<p>This first stage regression indicates that there is a strong relationship and the first stage easily passes the rule of thumb test where the F-statistic is at least 10.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_first</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">educ</span><span class="p">,</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;fatheduc&quot;</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_first</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;educ_hat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">educ</span> <span class="o">-</span> <span class="n">res_first</span><span class="o">.</span><span class="n">resids</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Estimation Summary
==============================================================================
Dep. Variable:                   educ   R-squared:                      0.1726
Estimator:                        OLS   Adj. R-squared:                 0.1706
No. Observations:                 428   F-statistic:                    89.258
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:49   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          10.237     0.2753     37.186     0.0000      9.6975      10.777
fatheduc       0.2694     0.0285     9.4476     0.0000      0.2135      0.3253
==============================================================================
</pre></div></div>
</div>
<p>The second stage uses the instrument to fit the model. This model indicates a much lower effect of education.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_second</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">wage</span><span class="p">),</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">]],</span> <span class="n">data</span><span class="o">.</span><span class="n">educ</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">fatheduc</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_second</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          IV-2SLS Estimation Summary
==============================================================================
Dep. Variable:                   wage   R-squared:                      0.0934
Estimator:                    IV-2SLS   Adj. R-squared:                 0.0913
No. Observations:                 428   F-statistic:                    2.8487
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0914
Time:                        15:12:49   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.4411     0.4451     0.9911     0.3216     -0.4312      1.3134
educ           0.0592     0.0351     1.6878     0.0914     -0.0095      0.1279
==============================================================================

Endogenous: educ
Instruments: fatheduc
Unadjusted Covariance (Homoskedastic)
Debiased: False
</pre></div></div>
</div>
<p>The fitted value can be used with OLS to estimate the same parameters. Note that the other values reported such as t-statistics or <span class="math notranslate nohighlight">\(R^2\)</span> are not correct.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">compare</span></code> function is used to compare the different models. The 2SLS coefficient on education and the direct coefficient on educ_hat are identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">linearmodels.iv</span><span class="w"> </span><span class="kn">import</span> <span class="n">compare</span>

<span class="n">res_direct</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">wage</span><span class="p">),</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;educ_hat&quot;</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">compare</span><span class="p">({</span><span class="s2">&quot;OLS&quot;</span><span class="p">:</span> <span class="n">res_ols</span><span class="p">,</span> <span class="s2">&quot;2SLS&quot;</span><span class="p">:</span> <span class="n">res_second</span><span class="p">,</span> <span class="s2">&quot;Direct&quot;</span><span class="p">:</span> <span class="n">res_direct</span><span class="p">}))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                         Model Comparison
=================================================================
                                OLS           2SLS         Direct
-----------------------------------------------------------------
Dep. Variable                  wage           wage           wage
Estimator                       OLS        IV-2SLS            OLS
No. Observations                428            428            428
Cov. Est.                unadjusted     unadjusted     unadjusted
R-squared                    0.1179         0.0934         0.0060
Adj. R-squared               0.1158         0.0913         0.0037
F-statistic                  57.196         2.8487         2.5982
P-value (F-stat)          3.941e-14         0.0914         0.1070
==================     ============   ============   ============
const                       -0.1852         0.4411         0.4411
                          (-1.0022)       (0.9911)       (0.9465)
educ                         0.1086         0.0592
                           (7.5628)       (1.6878)
educ_hat                                                   0.0592
                                                         (1.6119)
==================== ============== ============== ==============
Instruments                               fatheduc
-----------------------------------------------------------------

T-stats reported in parentheses
</pre></div></div>
</div>
<h2 id="Wages-of-Men">Wages of Men<a class="headerlink" href="#Wages-of-Men" title="Link to this heading">¶</a></h2>
<p>This next example examines the returns to education for men and uses the number of siblings as an instrument.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">linearmodels.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">wage</span>

<span class="n">men</span> <span class="o">=</span> <span class="n">wage</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wage</span><span class="o">.</span><span class="n">DESCR</span><span class="p">)</span>
<span class="n">men</span> <span class="o">=</span> <span class="n">men</span><span class="p">[[</span><span class="s2">&quot;educ&quot;</span><span class="p">,</span> <span class="s2">&quot;wage&quot;</span><span class="p">,</span> <span class="s2">&quot;sibs&quot;</span><span class="p">,</span> <span class="s2">&quot;exper&quot;</span><span class="p">]]</span>
<span class="n">men</span> <span class="o">=</span> <span class="n">add_constant</span><span class="p">(</span><span class="n">men</span><span class="p">)</span>
<span class="n">men</span> <span class="o">=</span> <span class="n">men</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

M. Blackburn and D. Neumark (1992), &#34;Unobserved Ability, Efficiency Wages, and
Interindustry Wage Differentials,&#34; Quarterly Journal of Economics 107, 1421-1436.

wage                     monthly earnings
hours                    average weekly hours
IQ                       IQ score
KWW                      knowledge of world work score
educ                     years of education
exper                    years of work experience
tenure                   years with current employer
age                      age in years
married                  =1 if married
black                    =1 if black
south                    =1 if live in south
urban                    =1 if live in SMSA
sibs                     number of siblings
brthord                  birth order
meduc                    mother&#39;s education
feduc                    father&#39;s education
lwage                    natural log of wage

</pre></div></div>
</div>
<p>OLS estimates indicate a small effect of education for men in this sample.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_ols</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">men</span><span class="o">.</span><span class="n">wage</span><span class="p">),</span> <span class="n">men</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;educ&quot;</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_ols</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Estimation Summary
==============================================================================
Dep. Variable:                   wage   R-squared:                      0.0973
Estimator:                        OLS   Adj. R-squared:                 0.0964
No. Observations:                 934   F-statistic:                    100.71
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:49   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          5.9733     0.0814     73.419     0.0000      5.8139      6.1328
educ           0.0598     0.0060     10.035     0.0000      0.0481      0.0715
==============================================================================
</pre></div></div>
</div>
<p>The first stage regressed the endogenous variable on the instrument. There is a strong, negative relationship here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_first</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">men</span><span class="o">.</span><span class="n">educ</span><span class="p">,</span> <span class="n">men</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;sibs&quot;</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_first</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Estimation Summary
==============================================================================
Dep. Variable:                   educ   R-squared:                      0.0576
Estimator:                        OLS   Adj. R-squared:                 0.0566
No. Observations:                 934   F-statistic:                    57.107
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:49   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          14.143     0.1131     125.02     0.0000      13.921      14.365
sibs          -0.2287     0.0303    -7.5569     0.0000     -0.2880     -0.1694
==============================================================================
</pre></div></div>
</div>
<p>The second stage indicates a much strong relationship than the OLS estimate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">men</span><span class="o">.</span><span class="n">wage</span><span class="p">),</span> <span class="n">men</span><span class="o">.</span><span class="n">const</span><span class="p">,</span> <span class="n">men</span><span class="o">.</span><span class="n">educ</span><span class="p">,</span> <span class="n">men</span><span class="o">.</span><span class="n">sibs</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          IV-2SLS Estimation Summary
==============================================================================
Dep. Variable:                   wage   R-squared:                     -0.0090
Estimator:                    IV-2SLS   Adj. R-squared:                -0.0101
No. Observations:                 934   F-statistic:                    21.715
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:49   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          5.1310     0.3539     14.497     0.0000      4.4373      5.8248
educ           0.1224     0.0263     4.6599     0.0000      0.0709      0.1738
==============================================================================

Endogenous: educ
Instruments: sibs
Unadjusted Covariance (Homoskedastic)
Debiased: False
</pre></div></div>
</div>
<h2 id="Weighted-IV">Weighted IV<a class="headerlink" href="#Weighted-IV" title="Link to this heading">¶</a></h2>
<p>All IV estimator support weighted which extends the concept of WLS in an OLS model to IV estimation. The weights are applied to the dependent variables, the matrix of regressors (endogenous and exogenous) and the matrix of instrument (exogenous and instruments) which allows for GLS-type estimation. In particular, if the variance of model residuals was <span class="math notranslate nohighlight">\(\sigma^2_i\)</span>, then setting <span class="math notranslate nohighlight">\(w_i = 1 / \sigma^2_i\)</span> would produce GLS estimates.</p>
<p>This example shows how a feasible GLS-type of estimator could be used.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res2</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">resids</span><span class="o">**</span><span class="mi">2</span>
<span class="n">fgls_mod</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">res2</span><span class="p">),</span> <span class="n">men</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;sibs&quot;</span><span class="p">,</span> <span class="s2">&quot;exper&quot;</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">fgls_res</span> <span class="o">=</span> <span class="n">fgls_mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">sigma2_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">res2</span><span class="p">)</span> <span class="o">-</span> <span class="n">fgls_res</span><span class="o">.</span><span class="n">resids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fgls_res</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Estimation Summary
==============================================================================
Dep. Variable:               residual   R-squared:                      0.0045
Estimator:                        OLS   Adj. R-squared:                 0.0024
No. Observations:                 934   F-statistic:                    3.9903
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.1360
Time:                        15:12:49   Distribution:                  chi2(2)
Cov. Estimator:                robust

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.9315     0.2224    -13.179     0.0000     -3.3675     -2.4956
sibs          -0.0651     0.0335    -1.9452     0.0518     -0.1307      0.0005
exper          0.0084     0.0158     0.5311     0.5953     -0.0226      0.0394
==============================================================================
</pre></div></div>
</div>
<p>The variance of the squared residuals is not particularly well explained by the data, and so the GLS-type estimates and the usual IV estimates don”t differ by much.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_gls</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">men</span><span class="o">.</span><span class="n">wage</span><span class="p">),</span> <span class="n">men</span><span class="o">.</span><span class="n">const</span><span class="p">,</span> <span class="n">men</span><span class="o">.</span><span class="n">educ</span><span class="p">,</span> <span class="n">men</span><span class="o">.</span><span class="n">sibs</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="n">sigma2_hat</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_gls</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          IV-2SLS Estimation Summary
==============================================================================
Dep. Variable:                   wage   R-squared:                      0.0090
Estimator:                    IV-2SLS   Adj. R-squared:                 0.0080
No. Observations:                 934   F-statistic:                    23.520
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:49   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          5.2031     0.3231     16.105     0.0000      4.5699      5.8363
educ           0.1166     0.0241     4.8497     0.0000      0.0695      0.1638
==============================================================================

Endogenous: educ
Instruments: sibs
Unadjusted Covariance (Homoskedastic)
Debiased: False
</pre></div></div>
</div>
<h2 id="Smoking-and-birth-weight">Smoking and birth weight<a class="headerlink" href="#Smoking-and-birth-weight" title="Link to this heading">¶</a></h2>
<p>This example examines the effect of smoking on the birth weight of babies.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">linearmodels.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">birthweight</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">birthweight</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">birthweight</span><span class="o">.</span><span class="n">DESCR</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

J. Mullahy (1997), &#34;Instrumental-Variable Estimation of Count Data Models:
Applications to Models of Cigarette Smoking Behavior,&#34; Review of Economics
and Statistics 79, 596-593.

faminc                   1988 family income, $1000s
cigtax                   cig. tax in home state, 1988
cigprice                 cig. price in home state, 1988
bwght                    birth weight, ounces
fatheduc                 father&#39;s yrs of educ
motheduc                 mother&#39;s yrs of educ
parity                   birth order of child
male                     =1 if male child
white                    =1 if white
cigs                     cigs smked per day while preg
lbwght                   log of bwght
bwghtlbs                 birth weight, pounds
packs                    packs smked per day while preg
faminc                   log(faminc)

</pre></div></div>
</div>
<p>The first stage regresses the number of packs smoked on the cigarette price. There is a very weak relationship – so weak that this is an example of a _weak instrument.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">packs</span><span class="p">,</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;cigprice&quot;</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Estimation Summary
==============================================================================
Dep. Variable:                  packs   R-squared:                      0.0015
Estimator:                        OLS   Adj. R-squared:                 0.0008
No. Observations:                1388   F-statistic:                    2.0731
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.1499
Time:                        15:12:49   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.9746     3.2361    -0.9192     0.3580     -9.3172      3.3681
cigprice       0.0356     0.0247     1.4398     0.1499     -0.0129      0.0840
==============================================================================
</pre></div></div>
</div>
<p>Despite the weak relationship between the price and the number of pack smoked, the 2SLS can be estimated, although substantial caution is warranted to interpret the results. Note the very negative <span class="math notranslate nohighlight">\(R^2\)</span> (-150%).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">bwght</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">const</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">packs</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">cigprice</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          IV-2SLS Estimation Summary
==============================================================================
Dep. Variable:                  bwght   R-squared:                     -1.5224
Estimator:                    IV-2SLS   Adj. R-squared:                -1.5242
No. Observations:                1388   F-statistic:                    1.1356
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.2866
Time:                        15:12:49   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          4.7203     0.0381     123.80     0.0000      4.6456      4.7951
packs          0.0238     0.0223     1.0656     0.2866     -0.0199      0.0675
==============================================================================

Endogenous: packs
Instruments: cigprice
Unadjusted Covariance (Homoskedastic)
Debiased: False
</pre></div></div>
</div>
<h2 id="Proximity-and-education">Proximity and education<a class="headerlink" href="#Proximity-and-education" title="Link to this heading">¶</a></h2>
<p>This next example uses a well-known dataset that uses proximity to a 4 year college as an instrument for education.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">linearmodels.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">card</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">card</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">DESCR</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

D. Card (1995), &#34;Using Geographic Variation in College Proximity to Estimate
the Return to Schooling,&#34; in Aspects of Labour Market Behavior:  Essays in
Honour of John Vanderkamp.  Ed. L.N. Christophides, E.K. Grant, and R.
Swidinsky, 201-222.  Toronto: University of Toronto Press.

id                       person identifier
nearc2                   =1 if near 2 yr college, 1966
nearc4                   =1 if near 4 yr college, 1966
educ                     years of schooling, 1976
age                      in years
fatheduc                 father&#39;s schooling
motheduc                 mother&#39;s schooling
weight                   NLS sampling weight, 1976
momdad14                 =1 if live with mom, dad at 14
sinmom14                 =1 if with single mom at 14
step14                   =1 if with step parent at 14
reg661                   =1 for region 1, 1966
reg662                   =1 for region 2, 1966
reg663                   =1 for region 3, 1966
reg664                   =1 for region 4, 1966
reg665                   =1 for region 5, 1966
reg666                   =1 for region 6, 1966
reg667                   =1 for region 7, 1966
reg668                   =1 for region 8, 1966
reg669                   =1 for region 9, 1966
south66                  =1 if in south in 1966
black                    =1 if black
smsa                     =1 in in SMSA, 1976
south                    =1 if in south, 1976
smsa66                   =1 if in SMSA, 1966
wage                     hourly wage in cents, 1976
enroll                   =1 if enrolled in school, 1976
KWW                      knowledge world of work score
IQ                       IQ score
married                  =1 if married, 1976
libcrd14                 =1 if lib. card in home at 14
exper                    age - educ - 6
lwage                    log(wage)
xpersq                   exper**2

</pre></div></div>
</div>
<p>Lists are used to hold the groups of variable in this large model and missing values are dropped.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">dep</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wage&quot;</span><span class="p">]</span>
<span class="n">endog</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;educ&quot;</span><span class="p">]</span>
<span class="n">exog</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;const&quot;</span><span class="p">,</span>
    <span class="s2">&quot;exper&quot;</span><span class="p">,</span>
    <span class="s2">&quot;expersq&quot;</span><span class="p">,</span>
    <span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smsa&quot;</span><span class="p">,</span>
    <span class="s2">&quot;south&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smsa66&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg662&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg663&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg664&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg665&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg666&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg667&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg668&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg669&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">instr</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;nearc4&quot;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">dep</span> <span class="o">+</span> <span class="n">exog</span> <span class="o">+</span> <span class="n">endog</span> <span class="o">+</span> <span class="n">instr</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>The first stage estimate shows a very large F-statistic. Note that when there are many exogenous variables the results cannot be directly interpreted. It is better to use the <code class="docutils literal notranslate"><span class="pre">first_stage</span></code> information from a 2SLS estimate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">educ</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">instr</span> <span class="o">+</span> <span class="n">exog</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Estimation Summary
==============================================================================
Dep. Variable:                   educ   R-squared:                      0.4771
Estimator:                        OLS   Adj. R-squared:                 0.4745
No. Observations:                3010   F-statistic:                    3693.4
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:49   Distribution:                 chi2(15)
Cov. Estimator:                robust

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
nearc4         0.3199     0.0848     3.7702     0.0002      0.1536      0.4862
const          16.638     0.2148     77.456     0.0000      16.217      17.059
exper         -0.4125     0.0320    -12.896     0.0000     -0.4752     -0.3498
expersq        0.0009     0.0017     0.5100     0.6100     -0.0025      0.0042
black         -0.9355     0.0923    -10.138     0.0000     -1.1164     -0.7547
smsa           0.4022     0.1109     3.6255     0.0003      0.1848      0.6196
south         -0.0516     0.1416    -0.3645     0.7155     -0.3291      0.2259
smsa66         0.0255     0.1103     0.2309     0.8174     -0.1908      0.2417
reg662        -0.0786     0.1854    -0.4242     0.6714     -0.4420      0.2847
reg663        -0.0279     0.1789    -0.1562     0.8759     -0.3785      0.3226
reg664         0.1172     0.2070     0.5660     0.5714     -0.2886      0.5230
reg665        -0.2726     0.2237    -1.2186     0.2230     -0.7111      0.1659
reg666        -0.3028     0.2361    -1.2826     0.1996     -0.7656      0.1599
reg667        -0.2168     0.2389    -0.9077     0.3640     -0.6850      0.2513
reg668         0.5239     0.2562     2.0449     0.0409      0.0218      1.0260
reg669         0.2103     0.1988     1.0575     0.2903     -0.1794      0.6000
==============================================================================
</pre></div></div>
</div>
<p>The OLS estimate indicates an increase of 7% for a year of education.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">wage</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="n">exog</span> <span class="o">+</span> <span class="n">endog</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Estimation Summary
==============================================================================
Dep. Variable:                   wage   R-squared:                      0.2998
Estimator:                        OLS   Adj. R-squared:                 0.2963
No. Observations:                3010   F-statistic:                    1377.0
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:49   Distribution:                 chi2(15)
Cov. Estimator:                robust

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          4.6208     0.0740     62.417     0.0000      4.4757      4.7659
exper          0.0848     0.0067     12.592     0.0000      0.0716      0.0980
expersq       -0.0023     0.0003    -7.1798     0.0000     -0.0029     -0.0017
black         -0.1990     0.0181    -10.985     0.0000     -0.2345     -0.1635
smsa           0.1364     0.0192     7.1159     0.0000      0.0988      0.1739
south         -0.1480     0.0280    -5.2917     0.0000     -0.2028     -0.0932
smsa66         0.0262     0.0185     1.4153     0.1570     -0.0101      0.0626
reg662         0.0964     0.0350     2.7531     0.0059      0.0278      0.1650
reg663         0.1445     0.0337     4.2850     0.0000      0.0784      0.2107
reg664         0.0551     0.0411     1.3402     0.1802     -0.0255      0.1356
reg665         0.1280     0.0428     2.9912     0.0028      0.0441      0.2119
reg666         0.1405     0.0450     3.1223     0.0018      0.0523      0.2287
reg667         0.1180     0.0455     2.5934     0.0095      0.0288      0.2071
reg668        -0.0564     0.0505    -1.1183     0.2634     -0.1553      0.0425
reg669         0.1186     0.0387     3.0658     0.0022      0.0428      0.1944
educ           0.0747     0.0036     20.540     0.0000      0.0676      0.0818
==============================================================================
</pre></div></div>
</div>
<p>The 2SLS estimate of the effect is nearly double. However, there is some reason to be concerned about the strength of the instrument despite the F-statistic in the first stage regression.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_2sls</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">wage</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="n">exog</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">endog</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">instr</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_2sls</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          IV-2SLS Estimation Summary
==============================================================================
Dep. Variable:                   wage   R-squared:                      0.2382
Estimator:                    IV-2SLS   Adj. R-squared:                 0.2343
No. Observations:                3010   F-statistic:                    840.83
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:49   Distribution:                 chi2(15)
Cov. Estimator:                robust

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          3.6662     0.9085     4.0352     0.0001      1.8855      5.4468
exper          0.1083     0.0233     4.6376     0.0000      0.0625      0.1540
expersq       -0.0023     0.0003    -6.7128     0.0000     -0.0030     -0.0017
black         -0.1468     0.0524    -2.8031     0.0051     -0.2494     -0.0441
smsa           0.1118     0.0311     3.5995     0.0003      0.0509      0.1727
south         -0.1447     0.0291    -4.9775     0.0000     -0.2016     -0.0877
smsa66         0.0185     0.0205     0.9035     0.3663     -0.0217      0.0587
reg662         0.1008     0.0365     2.7644     0.0057      0.0293      0.1722
reg663         0.1483     0.0355     4.1760     0.0000      0.0787      0.2178
reg664         0.0499     0.0435     1.1471     0.2514     -0.0354      0.1352
reg665         0.1463     0.0491     2.9794     0.0029      0.0500      0.2425
reg666         0.1629     0.0516     3.1553     0.0016      0.0617      0.2641
reg667         0.1346     0.0504     2.6689     0.0076      0.0357      0.2334
reg668        -0.0831     0.0571    -1.4552     0.1456     -0.1950      0.0288
reg669         0.1078     0.0410     2.6317     0.0085      0.0275      0.1881
educ           0.1315     0.0540     2.4353     0.0149      0.0257      0.2373
==============================================================================

Endogenous: educ
Instruments: nearc4
Robust Covariance (Heteroskedastic)
Debiased: False
</pre></div></div>
</div>
<p>The property <code class="docutils literal notranslate"><span class="pre">first_stage</span></code> can be used to show a large set of first stage diagnostics. These results show a much lower <em>partial</em> <span class="math notranslate nohighlight">\(R^2\)</span> that has measures the unique effect of the instrument on the endogenous controlling for the exogenous regressors. This is much smaller than the naive first stage <span class="math notranslate nohighlight">\(R^2\)</span> of 47%. The partial F-statistic is also much smaller, although it technically over the rule-of-thumb of 10 for a single instrument.</p>
<p>The instrument is a dummy variable and being close to a 4 year college is only worth 0.3 years of education on average.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">res_2sls</span><span class="o">.</span><span class="n">first_stage</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    First Stage Estimation Results
======================================
                                  educ
--------------------------------------
R-squared                       0.4771
Partial R-squared               0.0044
Shea&#39;s R-squared                0.0044
Partial F-statistic             14.214
P-value (Partial F-stat)        0.0002
Partial F-stat Distn           chi2(1)
========================== ===========
const                           16.638
                              (77.456)
exper                          -0.4125
                             (-12.896)
expersq                         0.0009
                              (0.5100)
black                          -0.9355
                             (-10.138)
smsa                            0.4022
                              (3.6255)
south                          -0.0516
                             (-0.3645)
smsa66                          0.0255
                              (0.2309)
reg662                         -0.0786
                             (-0.4242)
reg663                         -0.0279
                             (-0.1562)
reg664                          0.1172
                              (0.5660)
reg665                         -0.2726
                             (-1.2186)
reg666                         -0.3028
                             (-1.2826)
reg667                         -0.2168
                             (-0.9077)
reg668                          0.5239
                              (2.0449)
reg669                          0.2103
                              (1.0575)
nearc4                          0.3199
                              (3.7702)
--------------------------------------

T-stats reported in parentheses
T-stats use same covariance type as original model
</pre></div></div>
</div>
<h2 id="Formula-interface">Formula interface<a class="headerlink" href="#Formula-interface" title="Link to this heading">¶</a></h2>
<p>This model was large and so it might be simpler to use a formula. While formulas are discussed in <a class="reference internal" href="using-formulas.html"><span class="doc">detail in another notebook</span></a>, they use the formula language of <a class="reference external" href="https://matthewwardrop.github.io/formulaic/">formulaic</a> with an augmentation to specify the endogenous and instrumental variables. The generic form is</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>dependent ~ exog + [endog ~ instr]
</code></pre></div>
</div>
<p>where each block can contain multiple variables.</p>
<p>Here the model is compared to the direct parameterization using DataFrames by differencing the <span class="math notranslate nohighlight">\(R^2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">formula</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;np.log(wage) ~ 1 + exper + expersq + black + smsa + south + smsa66 + reg662 + reg663 + reg664 + &quot;</span>
    <span class="s2">&quot;reg665 + reg666 + reg667 + reg668 + reg669 + [educ ~ nearc4]&quot;</span>
<span class="p">)</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">res_formula</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_formula</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">-</span> <span class="n">res_2sls</span><span class="o">.</span><span class="n">rsquared</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.0
</pre></div></div>
</div>
<h2 id="Categorical-Variables">Categorical Variables<a class="headerlink" href="#Categorical-Variables" title="Link to this heading">¶</a></h2>
<p>pandas <code class="docutils literal notranslate"><span class="pre">categorical</span></code>s are automatically treated as factors and expanded to dummies. The first is always dropped. This next block constructs a categorical from the region dummies and then uses it instead of the individual dummies. The model is identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">data</span><span class="p">[</span><span class="s2">&quot;reg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;661&quot;</span>  <span class="c1"># The default region, which was omitted</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;reg66&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;reg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;reg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;reg&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">res_cat</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">wage</span><span class="p">),</span>
    <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;exper&quot;</span><span class="p">,</span> <span class="s2">&quot;expersq&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;smsa&quot;</span><span class="p">,</span> <span class="s2">&quot;south&quot;</span><span class="p">,</span> <span class="s2">&quot;smsa66&quot;</span><span class="p">,</span> <span class="s2">&quot;reg&quot;</span><span class="p">]],</span>
    <span class="n">data</span><span class="o">.</span><span class="n">educ</span><span class="p">,</span>
    <span class="n">data</span><span class="o">.</span><span class="n">nearc4</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_cat</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          IV-2SLS Estimation Summary
==============================================================================
Dep. Variable:                   wage   R-squared:                      0.2382
Estimator:                    IV-2SLS   Adj. R-squared:                 0.2343
No. Observations:                3010   F-statistic:                    840.83
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:50   Distribution:                 chi2(15)
Cov. Estimator:                robust

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          3.6662     0.9085     4.0352     0.0001      1.8855      5.4468
exper          0.1083     0.0233     4.6376     0.0000      0.0625      0.1540
expersq       -0.0023     0.0003    -6.7128     0.0000     -0.0030     -0.0017
black         -0.1468     0.0524    -2.8031     0.0051     -0.2494     -0.0441
smsa           0.1118     0.0311     3.5995     0.0003      0.0509      0.1727
south         -0.1447     0.0291    -4.9775     0.0000     -0.2016     -0.0877
smsa66         0.0185     0.0205     0.9035     0.3663     -0.0217      0.0587
reg.662        0.1008     0.0365     2.7644     0.0057      0.0293      0.1722
reg.663        0.1483     0.0355     4.1760     0.0000      0.0787      0.2178
reg.664        0.0499     0.0435     1.1471     0.2514     -0.0354      0.1352
reg.665        0.1463     0.0491     2.9794     0.0029      0.0500      0.2425
reg.666        0.1629     0.0516     3.1553     0.0016      0.0617      0.2641
reg.667        0.1346     0.0504     2.6689     0.0076      0.0357      0.2334
reg.668       -0.0831     0.0571    -1.4552     0.1456     -0.1950      0.0288
reg.669        0.1078     0.0410     2.6317     0.0085      0.0275      0.1881
educ           0.1315     0.0540     2.4353     0.0149      0.0257      0.2373
==============================================================================

Endogenous: educ
Instruments: nearc4
Robust Covariance (Heteroskedastic)
Debiased: False
</pre></div></div>
</div>
<h2 id="Post-estimation-diagnostics">Post-estimation diagnostics<a class="headerlink" href="#Post-estimation-diagnostics" title="Link to this heading">¶</a></h2>
<p>Common post-estimation diagnostics are to test the assumption of endogeneity and to examine if instruments are valid (when there are more instruments than endogenous variables).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">mroz</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">has_constant</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnwage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">wage</span><span class="p">)</span>
<span class="n">dep</span> <span class="o">=</span> <span class="s2">&quot;lnwage&quot;</span>
<span class="n">exog</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;exper&quot;</span><span class="p">,</span> <span class="s2">&quot;expersq&quot;</span><span class="p">]</span>
<span class="n">endog</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;educ&quot;</span><span class="p">]</span>
<span class="n">instr</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fatheduc&quot;</span><span class="p">,</span> <span class="s2">&quot;motheduc&quot;</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<p>The first step is to fit the model using 2SLS.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">dep</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">exog</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">endog</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">instr</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          IV-2SLS Estimation Summary
==============================================================================
Dep. Variable:                 lnwage   R-squared:                      0.1357
Estimator:                    IV-2SLS   Adj. R-squared:                 0.1296
No. Observations:                 428   F-statistic:                    24.653
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:50   Distribution:                  chi2(3)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0481     0.3985     0.1207     0.9039     -0.7329      0.8291
exper          0.0442     0.0134     3.3038     0.0010      0.0180      0.0704
expersq       -0.0009     0.0004    -2.2485     0.0245     -0.0017     -0.0001
educ           0.0614     0.0313     1.9622     0.0497   7.043e-05      0.1227
==============================================================================

Endogenous: educ
Instruments: fatheduc, motheduc
Unadjusted Covariance (Homoskedastic)
Debiased: False
</pre></div></div>
</div>
<p>Wooldridge”s regression test of exogeneity uses regression residual where the endogenous variables are regressed on the exogenous and the instrument to test for endogeneity. IF the endogenous variable is actually exogenous these residuals should not be correlated with the variable of interest.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">wooldridge_regression</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Wooldridge&#39;s regression test of exogeneity
H0: Endogenous variables are exogenous
Statistic: 2.8256
P-value: 0.0928
Distributed: chi2(1)
WaldTestStatistic, id: 0x7f6fdbdc6350
</pre></div></div>
</div>
<p>This test can be easily implemented using two regression. The first one constructs the residuals and the second re-fits the model using 2SLS but including the residuals.</p>
<p>Note that the p-value of the t-state on <code class="docutils literal notranslate"><span class="pre">residuals</span></code> is the same as the P-value of the previous test – this is not an accident.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">v</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">endog</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">exog</span> <span class="o">+</span> <span class="n">instr</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">resids</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">endog</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">exog</span> <span class="o">+</span> <span class="n">instr</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">resids</span>

<span class="n">res_direct</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dep</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">v</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">exog</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="n">endog</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">instr</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_direct</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          IV-2SLS Estimation Summary
==============================================================================
Dep. Variable:                 lnwage   R-squared:                      0.1624
Estimator:                    IV-2SLS   Adj. R-squared:                 0.1544
No. Observations:                 428   F-statistic:                    82.954
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:50   Distribution:                  chi2(4)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
residual       0.0582     0.0346     1.6810     0.0928     -0.0097      0.1260
const          0.0481     0.3923     0.1226     0.9024     -0.7207      0.8169
exper          0.0442     0.0132     3.3559     0.0008      0.0184      0.0700
expersq       -0.0009     0.0004    -2.2840     0.0224     -0.0017     -0.0001
educ           0.0614     0.0308     1.9932     0.0462      0.0010      0.1218
==============================================================================

Endogenous: educ
Instruments: fatheduc, motheduc
Unadjusted Covariance (Homoskedastic)
Debiased: False
</pre></div></div>
</div>
<p>Since this regression has two instrument it is possible to test for overidentification. Wooldridge”s overidentification test uses a regression to test whether the 2SLS residuals are uncorrelated with the instruments, which should be the case if the model is correct and the instruments are not needed in the original model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">wooldridge_overid</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Wooldridge&#39;s score test of overidentification
H0: Model is not overidentified.
Statistic: 0.4435
P-value: 0.5055
Distributed: chi2(1)
WaldTestStatistic, id: 0x7f6fdbf03d60
</pre></div></div>
</div>
<p>A naive version of this test can be directly implemented. This direct implementation is different from the formal test but would be consistent if the model was overidentified.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[28]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">u</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">resids</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;exper&quot;</span><span class="p">,</span> <span class="s2">&quot;expersq&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">instr</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>The test is <span class="math notranslate nohighlight">\(n\times R^2\)</span>, and has the same <span class="math notranslate nohighlight">\(\chi^2_1\)</span> distribution. The test statistic is slightly smaller but the conclusions are the same.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">nobs</span> <span class="o">*</span> <span class="n">res</span><span class="o">.</span><span class="n">rsquared</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.3719811106150277
</pre></div></div>
</div>
<p>Husband”s education can be used as an additional instrument, and its validity tested.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[30]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">instr</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fatheduc&quot;</span><span class="p">,</span> <span class="s2">&quot;motheduc&quot;</span><span class="p">,</span> <span class="s2">&quot;huseduc&quot;</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">dep</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">exog</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">endog</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">instr</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>Testing overidentification does not indicate any difference from the previous result.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[31]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">wooldridge_overid</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[31]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Wooldridge&#39;s score test of overidentification
H0: Model is not overidentified.
Statistic: 1.0421
P-value: 0.5939
Distributed: chi2(2)
WaldTestStatistic, id: 0x7f6fde0892a0
</pre></div></div>
</div>
<p>Directly testing using two regression would reach the same conclusion.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[32]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">u</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">resids</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;exper&quot;</span><span class="p">,</span> <span class="s2">&quot;expersq&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">instr</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">nobs</span> <span class="o">*</span> <span class="n">res</span><span class="o">.</span><span class="n">rsquared</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[32]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.1126588681969989
</pre></div></div>
</div>
<h2 id="Panel-IV">Panel IV<a class="headerlink" href="#Panel-IV" title="Link to this heading">¶</a></h2>
<p>Instrumental variable regression can also be used with panel data. This example makes use of first differences to eliminate a year-specific effect and then uses</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[33]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">linearmodels.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">jobtraining</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">jobtraining</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jobtraining</span><span class="o">.</span><span class="n">DESCR</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">isin</span><span class="p">((</span><span class="mi">1987</span><span class="p">,</span> <span class="mi">1988</span><span class="p">)))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;fcode&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;fcode&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;hrsemp&quot;</span><span class="p">,</span> <span class="s2">&quot;grant&quot;</span><span class="p">,</span> <span class="s2">&quot;scrap&quot;</span><span class="p">,</span> <span class="s2">&quot;lscrap&quot;</span><span class="p">]]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

H. Holzer, R. Block, M. Cheatham, and J. Knott (1993), &#34;Are Training Subsidies
Effective? The Michigan Experience,&#34; Industrial and Labor Relations Review 46,
625-636.

year                     1987, 1988, or 1989
fcode                    firm code number
employ                   # employees at plant
sales                    annual sales, $
avgsal                   average employee salary
scrap                    scrap rate (per 100 items)
rework                   rework rate (per 100 items)
tothrs                   total hours training
union                    =1 if unionized
grant                    =1 if received grant
d89                      =1 if year = 1989
d88                      =1 if year = 1988
totrain                  total employees trained
hrsemp                   tothrs/totrain
lscrap                   log(scrap)
lemploy                  log(employ)
lsales                   log(sales)
lrework                  log(rework)
lhrsemp                  log(1 + hrsemp)
lscrap_1                 lagged lscrap; missing 1987
grant_1                  lagged grant; assumed 0 in 1987
clscrap                  lscrap - lscrap_1; year &gt; 1987
cgrant                   grant - grant_1
clemploy                 lemploy - lemploy[t-1]
clsales                  lavgsal - lavgsal[t-1]
lavgsal                  log(avgsal)
clavgsal                 lavgsal - lavgsal[t-1]
cgrant_1                 cgrant[t-1]
chrsemp                  hrsemp - hrsemp[t-1]
lhrsemp                 lhrsemp - lhrsemp[t-1]

              year          fcode      employ         sales        avgsal  \
count   314.000000     314.000000  290.000000  2.450000e+02    267.000000
mean   1987.500000  415708.885350   56.903448  5.679815e+06  18326.284644
std       0.500798    4025.063452   70.843101  6.977975e+06   6507.584305
min    1987.000000  410032.000000    4.000000  1.100000e+05   4237.000000
25%    1987.000000  410604.000000   15.000000  1.527000e+06  13664.000000
50%    1987.500000  418084.000000   27.500000  2.900000e+06  17160.000000
75%    1988.000000  419309.000000   70.000000  7.000000e+06  22000.000000
max    1988.000000  419486.000000  500.000000  4.700000e+07  40563.000000

            scrap     rework      tothrs       union       grant  ...  \
count  108.000000  82.000000  276.000000  314.000000  314.000000  ...
mean     4.199722   3.883537   25.648551    0.197452    0.114650  ...
std      6.188094   6.145294   45.694834    0.398712    0.319107  ...
min      0.010000   0.000000    0.000000    0.000000    0.000000  ...
25%      0.767500   0.332500    0.000000    0.000000    0.000000  ...
50%      1.555000   1.500000    8.000000    0.000000    0.000000  ...
75%      5.000000   4.267500   39.250000    0.000000    0.000000  ...
max     30.000000  40.000000  290.000000    1.000000    1.000000  ...

       grant_1    clscrap      cgrant    clemploy     clsales     lavgsal  \
count    314.0  54.000000  314.000000  144.000000  119.000000  267.000000
mean       0.0  -0.168993    0.114650    0.096876    0.128995    9.754753
std        0.0   0.589774    0.319107    0.251180    0.489422    0.353818
min        0.0  -2.502170    0.000000   -0.411099   -1.982874    8.351611
25%        0.0  -0.350983    0.000000   -0.031946    0.023286    9.522509
50%        0.0  -0.115118    0.000000    0.064538    0.116219    9.750337
75%        0.0   0.092537    0.000000    0.182321    0.215391    9.998797
max        0.0   2.397895    1.000000    1.673976    2.896701   10.610610

         clavgsal  cgrant_1     chrsemp    clhrsemp
count  131.000000     157.0  125.000000  125.000000
mean     0.058601       0.0    7.423050    0.642580
std      0.074255       0.0   19.301290    1.235229
min     -0.080411       0.0  -47.753490   -2.338574
25%      0.020135       0.0    0.000000    0.000000
50%      0.057159       0.0    0.272727    0.039375
75%      0.086255       0.0   10.000000    1.063067
max      0.568912       0.0  107.027800    4.394449

[8 rows x 30 columns]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[34]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">deltas</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">1988</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">1987</span><span class="p">]</span>
<span class="n">deltas</span> <span class="o">=</span> <span class="n">add_constant</span><span class="p">(</span><span class="n">deltas</span><span class="p">,</span> <span class="n">has_constant</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">)</span>
<span class="n">deltas</span> <span class="o">=</span> <span class="n">deltas</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">deltas</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
       const  year     hrsemp      grant      scrap     lscrap
count   45.0  45.0  45.000000  45.000000  45.000000  45.000000
mean     1.0   1.0  10.812321   0.377778  -0.817556  -0.185697
std      0.0   0.0  20.523825   0.490310   2.496392   0.626858
min      1.0   1.0 -19.850180   0.000000 -10.000000  -2.502169
25%      1.0   1.0   0.000000   0.000000  -1.000000  -0.355820
50%      1.0   1.0   1.846154   0.000000  -0.110000  -0.167054
75%      1.0   1.0  15.333330   1.000000   0.090000   0.054067
max      1.0   1.0  80.000000   1.000000   5.000000   2.397895
</pre></div></div>
</div>
<p>The first stage indicates a relatively strong relationship between grant and the number of hours employed. Note that grant is a dummy and so the coefficient is just the difference in means.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[35]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mod</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">deltas</span><span class="o">.</span><span class="n">hrsemp</span><span class="p">,</span> <span class="n">deltas</span><span class="p">[[</span><span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;grant&quot;</span><span class="p">]],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Estimation Summary
==============================================================================
Dep. Variable:                 hrsemp   R-squared:                      0.3408
Estimator:                        OLS   Adj. R-squared:                 0.3255
No. Observations:                  45   F-statistic:                    23.266
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0000
Time:                        15:12:50   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          1.5806     3.1139     0.5076     0.6117     -4.5225      7.6837
grant          24.437     5.0662     4.8235     0.0000      14.507      34.367
==============================================================================
</pre></div></div>
</div>
<p>Here a formula is used to specify the model since it is cleaner. Note that the <code class="docutils literal notranslate"><span class="pre">[]</span></code> contains the endogenous variables and instruments.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[36]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mod</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s2">&quot;lscrap ~ 1 + [hrsemp ~ grant]&quot;</span><span class="p">,</span> <span class="n">deltas</span><span class="p">)</span>
<span class="n">res_iv</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_iv</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          IV-2SLS Estimation Summary
==============================================================================
Dep. Variable:                 lscrap   R-squared:                      0.0159
Estimator:                    IV-2SLS   Adj. R-squared:                -0.0070
No. Observations:                  45   F-statistic:                    3.3464
Date:                Wed, Jul 23 2025   P-value (F-stat)                0.0674
Time:                        15:12:50   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept     -0.0327     0.1241    -0.2632     0.7924     -0.2759      0.2106
hrsemp        -0.0142     0.0077    -1.8293     0.0674     -0.0293      0.0010
==============================================================================

Endogenous: hrsemp
Instruments: grant
Unadjusted Covariance (Homoskedastic)
Debiased: False
</pre></div></div>
</div>
<p>The 2SLS estimate is nearly twice as large as the OLS estimate and is slightly more significant.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[37]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_ols</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s2">&quot;lscrap ~ 1 + hrsemp&quot;</span><span class="p">,</span> <span class="n">deltas</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">compare</span><span class="p">({</span><span class="s2">&quot;Panel OLS&quot;</span><span class="p">:</span> <span class="n">res_ols</span><span class="p">,</span> <span class="s2">&quot;Panel IV&quot;</span><span class="p">:</span> <span class="n">res_iv</span><span class="p">}))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                 Model Comparison
==================================================
                          Panel OLS       Panel IV
--------------------------------------------------
Dep. Variable                lscrap         lscrap
Estimator                       OLS        IV-2SLS
No. Observations                 45             45
Cov. Est.                unadjusted     unadjusted
R-squared                    0.0619         0.0159
Adj. R-squared               0.0401        -0.0070
F-statistic                  2.9707         3.3464
P-value (F-stat)             0.0848         0.0674
==================     ============   ============
Intercept                   -0.1035        -0.0327
                          (-1.0208)      (-0.2632)
hrsemp                      -0.0076        -0.0142
                          (-1.7236)      (-1.8293)
==================== ============== ==============
Instruments                                  grant
--------------------------------------------------

T-stats reported in parentheses
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[38]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mod</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s2">&quot;lscrap ~ 1 + [hrsemp ~ grant]&quot;</span><span class="p">,</span> <span class="n">deltas</span><span class="p">)</span>
<span class="n">res_iv</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">deltas</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="n">deltas</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">res_iv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">pred_exog</span><span class="p">,</span> <span class="n">endog</span><span class="o">=</span><span class="n">deltas</span><span class="p">[[</span><span class="s2">&quot;hrsemp&quot;</span><span class="p">]])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[38]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>predictions</th>
    </tr>
    <tr>
      <th>fcode</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>410523.0</th>
      <td>-0.016018</td>
    </tr>
    <tr>
      <th>410563.0</th>
      <td>-0.032668</td>
    </tr>
    <tr>
      <th>410565.0</th>
      <td>-0.032668</td>
    </tr>
    <tr>
      <th>410566.0</th>
      <td>0.037845</td>
    </tr>
    <tr>
      <th>410567.0</th>
      <td>-0.032668</td>
    </tr>
    <tr>
      <th>410577.0</th>
      <td>-0.040453</td>
    </tr>
    <tr>
      <th>410593.0</th>
      <td>-0.032668</td>
    </tr>
    <tr>
      <th>410596.0</th>
      <td>-0.060975</td>
    </tr>
    <tr>
      <th>410606.0</th>
      <td>-0.010335</td>
    </tr>
    <tr>
      <th>410626.0</th>
      <td>-0.011102</td>
    </tr>
    <tr>
      <th>418011.0</th>
      <td>-0.154386</td>
    </tr>
    <tr>
      <th>418021.0</th>
      <td>-0.119765</td>
    </tr>
    <tr>
      <th>418035.0</th>
      <td>-0.293087</td>
    </tr>
    <tr>
      <th>418045.0</th>
      <td>-0.089281</td>
    </tr>
    <tr>
      <th>418054.0</th>
      <td>-0.058797</td>
    </tr>
    <tr>
      <th>418065.0</th>
      <td>-0.202584</td>
    </tr>
    <tr>
      <th>418076.0</th>
      <td>-0.227847</td>
    </tr>
    <tr>
      <th>418091.0</th>
      <td>-0.193340</td>
    </tr>
    <tr>
      <th>418097.0</th>
      <td>-0.067874</td>
    </tr>
    <tr>
      <th>418107.0</th>
      <td>-1.065849</td>
    </tr>
    <tr>
      <th>418118.0</th>
      <td>-0.342269</td>
    </tr>
    <tr>
      <th>418125.0</th>
      <td>-0.339713</td>
    </tr>
    <tr>
      <th>418140.0</th>
      <td>-1.164922</td>
    </tr>
    <tr>
      <th>418163.0</th>
      <td>-0.598795</td>
    </tr>
    <tr>
      <th>418168.0</th>
      <td>-0.032668</td>
    </tr>
    <tr>
      <th>418177.0</th>
      <td>-0.400651</td>
    </tr>
    <tr>
      <th>418237.0</th>
      <td>-0.117587</td>
    </tr>
    <tr>
      <th>419198.0</th>
      <td>-0.998414</td>
    </tr>
    <tr>
      <th>419201.0</th>
      <td>-0.152554</td>
    </tr>
    <tr>
      <th>419242.0</th>
      <td>-0.469395</td>
    </tr>
    <tr>
      <th>419268.0</th>
      <td>-0.032668</td>
    </tr>
    <tr>
      <th>419272.0</th>
      <td>0.084601</td>
    </tr>
    <tr>
      <th>419289.0</th>
      <td>-0.032668</td>
    </tr>
    <tr>
      <th>419297.0</th>
      <td>0.248274</td>
    </tr>
    <tr>
      <th>419307.0</th>
      <td>-0.036528</td>
    </tr>
    <tr>
      <th>419339.0</th>
      <td>-0.032668</td>
    </tr>
    <tr>
      <th>419343.0</th>
      <td>-0.042576</td>
    </tr>
    <tr>
      <th>419357.0</th>
      <td>-0.386498</td>
    </tr>
    <tr>
      <th>419378.0</th>
      <td>-0.434747</td>
    </tr>
    <tr>
      <th>419381.0</th>
      <td>0.027988</td>
    </tr>
    <tr>
      <th>419388.0</th>
      <td>-0.049180</td>
    </tr>
    <tr>
      <th>419409.0</th>
      <td>-0.249684</td>
    </tr>
    <tr>
      <th>419459.0</th>
      <td>-0.033183</td>
    </tr>
    <tr>
      <th>419482.0</th>
      <td>-0.032668</td>
    </tr>
    <tr>
      <th>419483.0</th>
      <td>-0.032668</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>







  
  






                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2021, Kevin Sheppard.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/bashtage/linearmodels" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/linearmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.2591973" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216m256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": [{"aliases": [], "title": "Release", "version": "https://bashtage.github.io/linearmodels"}, {"aliases": [], "title": "Development", "version": "https://bashtage.github.io/linearmodels/devel"}], "versionPath": null}}</script>
    
      
        <script src="../../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>