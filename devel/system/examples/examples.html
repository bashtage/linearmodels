


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../_static/favicon.ico">
    
    
  
      
        <title>Examples - linearmodels v6.1 (+10)</title>
      
    

  <link rel="apple-touch-icon" sizes="180x180" href="../../_static/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../_static/icons/safari-pinned-tab.svg" color="#2196f3">
  <link rel="shortcut icon" href="../../_static/icons/favicon.ico">
  <meta name="msapplication-TileColor" content="#f8f8f8">
  <meta name="msapplication-config" content="../../_static/icons/browserconfig.xml">

    
      
        
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../_static/sphinx_immaterial_theme.e0b5691b38cca82da.min.css?v=b1736040" />
        <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
        <link rel="stylesheet" type="text/css" href="../../_static/css/small_fixes.css?v=34934119" />
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="linearmodels v6.1 (+10)" class="md-header__button md-logo" aria-label="linearmodels v6.1 (+10)" data-md-component="logo">
      <img src="../../_static/bw-logo.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            linearmodels v6.1 (+10)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Examples
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    linearmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="linearmodels v6.1 (+10)" class="md-nav__button md-logo" aria-label="linearmodels v6.1 (+10)" data-md-component="logo">
      <img src="../../_static/bw-logo.svg" alt="logo">
    </a>
    linearmodels v6.1 (+10)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    linearmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../iv/index.html" class="md-nav__link">
        <span title="/iv/index.rst (reference label)" class="md-ellipsis">Instrumental Variable Estimation</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../panel/index.html" class="md-nav__link">
        <span title="/panel/index.rst (reference label)" class="md-ellipsis">Panel Data Model Estimation</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../asset-pricing/index.html" class="md-nav__link">
        <span title="/asset-pricing/index.rst (reference label)" class="md-ellipsis">Linear Factor Models for Asset Pricing</span>
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../index.html"><span title="/system/index.rst (reference label)" class="md-ellipsis">System Regression Models</span></a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="System Regression Models" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span title="/system/index.rst (reference label)" class="md-ellipsis">System Regression Models</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/system/examples/examples.ipynb (reference label)" class="md-ellipsis">Examples</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/system/examples/examples.ipynb (reference label)" class="md-ellipsis">Examples</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Data" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#data (reference label)" class="md-ellipsis">Data</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Basic-Usage" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#basic-usage (reference label)" class="md-ellipsis">Basic Usage</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Estimation-Options" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#estimation-options (reference label)" class="md-ellipsis">Estimation Options</span>
  </a>
  
    <nav class="md-nav" aria-label="Estimation Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Iterative-GLS" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#iterative-gls (reference label)" class="md-ellipsis">Iterative GLS</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Alternative-Covariance-Estimators" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#alternative-covariance-estimators (reference label)" class="md-ellipsis">Alternative Covariance Estimators</span>
  </a>
  
    <nav class="md-nav" aria-label="Alternative Covariance Estimators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Heteroskedasticity-Robust-Covariance-Estimation" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#heteroskedasticity-robust-covariance-estimation (reference label)" class="md-ellipsis">Heteroskedasticity Robust Covariance Estimation</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Kernel-(HAC)" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#kernel-(hac) (reference label)" class="md-ellipsis">Kernel <wbr>(HAC)</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Clustered-(Rogers)" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#clustered-(rogers) (reference label)" class="md-ellipsis">Clustered <wbr>(Rogers)</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Prespecified-Residual-Covariance-Estimators" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#prespecified-residual-covariance-estimators (reference label)" class="md-ellipsis">Prespecified Residual Covariance Estimators</span>
  </a>
  
    <nav class="md-nav" aria-label="Prespecified Residual Covariance Estimators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Diagonal-Residual-Covariance" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#diagonal-residual-covariance (reference label)" class="md-ellipsis">Diagonal Residual Covariance</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Cross-Equation-Restrictions" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#cross-equation-restrictions (reference label)" class="md-ellipsis">Cross-<wbr>Equation Restrictions</span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Equation Restrictions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Pooling-using-constraints" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#pooling-using-constraints (reference label)" class="md-ellipsis">Pooling using constraints</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Multivariate-OLS" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#multivariate-ols (reference label)" class="md-ellipsis">Multivariate OLS</span>
  </a>
  
    <nav class="md-nav" aria-label="Multivariate OLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Using-GLS-with-common-regressors" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#using-gls-with-common-regressors (reference label)" class="md-ellipsis">Using GLS with common regressors</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="formulas.html" class="md-nav__link">
        <span title="/system/examples/formulas.ipynb (reference label)" class="md-ellipsis">Using formulas to specify models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="three-stage-ls.html" class="md-nav__link">
        <span title="/system/examples/three-stage-ls.ipynb (reference label)" class="md-ellipsis">Three-<wbr>stage Least Squares <wbr>(3SLS)</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference.html" class="md-nav__link">
        <span title="/system/reference.rst (reference label)" class="md-ellipsis">Module Reference</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../mathematical-formula.html" class="md-nav__link">
        <span title="/system/mathematical-formula.rst (reference label)" class="md-ellipsis">Seemingly Unrelated Regression <wbr>(SUR/SURE)</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../mathematical-formula.html#covariance-estimation" class="md-nav__link">
        <span title="/system/mathematical-formula.rst#covariance-estimation (reference label)" class="md-ellipsis">Covariance Estimation</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../mathematical-formula.html#memory-efficient-calculations" class="md-nav__link">
        <span title="/system/mathematical-formula.rst#memory-efficient-calculations (reference label)" class="md-ellipsis">Memory efficient calculations</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../mathematical-formula.html#three-stage-least-squares-3sls" class="md-nav__link">
        <span title="/system/mathematical-formula.rst#three-stage-least-squares-3sls (reference label)" class="md-ellipsis">Three Stage Least Squares <wbr>(3SLS)</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../mathematical-formula.html#system-generalized-method-of-moments-gmm" class="md-nav__link">
        <span title="/system/mathematical-formula.rst#system-generalized-method-of-moments-gmm (reference label)" class="md-ellipsis">System Generalized Method of Moments <wbr>(GMM)</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../mathematical-formula.html#testing-covariance-and-correlations" class="md-nav__link">
        <span title="/system/mathematical-formula.rst#testing-covariance-and-correlations (reference label)" class="md-ellipsis">Testing Covariance and Correlations</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../mathematical-formula.html#system-measures-of-fit-r-2" class="md-nav__link">
        <span title="/system/mathematical-formula.rst#system-measures-of-fit-r-2 (reference label)" class="md-ellipsis">System Measures of Fit <wbr>(R^<wbr>{2})</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../utility.html" class="md-nav__link">
        <span title="/utility.rst (reference label)" class="md-ellipsis">Utilities</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../compatibility.html" class="md-nav__link">
        <span title="/compatibility.rst (reference label)" class="md-ellipsis">Compatibility</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../types.html" class="md-nav__link">
        <span title="/types.rst (reference label)" class="md-ellipsis">Type Aliases</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../plan.html" class="md-nav__link">
        <span title="/plan.rst (reference label)" class="md-ellipsis">Module Plans</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing.html" class="md-nav__link">
        <span title="/contributing.rst (reference label)" class="md-ellipsis">Contributing</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../changes.html" class="md-nav__link">
        <span title="/changes.rst (reference label)" class="md-ellipsis">Change Log</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../references.html" class="md-nav__link">
        <span title="/references.rst (reference label)" class="md-ellipsis">References</span>
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Data" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#data (reference label)" class="md-ellipsis">Data</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Basic-Usage" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#basic-usage (reference label)" class="md-ellipsis">Basic Usage</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Estimation-Options" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#estimation-options (reference label)" class="md-ellipsis">Estimation Options</span>
  </a>
  
    <nav class="md-nav" aria-label="Estimation Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Iterative-GLS" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#iterative-gls (reference label)" class="md-ellipsis">Iterative GLS</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Alternative-Covariance-Estimators" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#alternative-covariance-estimators (reference label)" class="md-ellipsis">Alternative Covariance Estimators</span>
  </a>
  
    <nav class="md-nav" aria-label="Alternative Covariance Estimators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Heteroskedasticity-Robust-Covariance-Estimation" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#heteroskedasticity-robust-covariance-estimation (reference label)" class="md-ellipsis">Heteroskedasticity Robust Covariance Estimation</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Kernel-(HAC)" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#kernel-(hac) (reference label)" class="md-ellipsis">Kernel <wbr>(HAC)</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Clustered-(Rogers)" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#clustered-(rogers) (reference label)" class="md-ellipsis">Clustered <wbr>(Rogers)</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Prespecified-Residual-Covariance-Estimators" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#prespecified-residual-covariance-estimators (reference label)" class="md-ellipsis">Prespecified Residual Covariance Estimators</span>
  </a>
  
    <nav class="md-nav" aria-label="Prespecified Residual Covariance Estimators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Diagonal-Residual-Covariance" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#diagonal-residual-covariance (reference label)" class="md-ellipsis">Diagonal Residual Covariance</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Cross-Equation-Restrictions" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#cross-equation-restrictions (reference label)" class="md-ellipsis">Cross-<wbr>Equation Restrictions</span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Equation Restrictions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Pooling-using-constraints" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#pooling-using-constraints (reference label)" class="md-ellipsis">Pooling using constraints</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Multivariate-OLS" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#multivariate-ols (reference label)" class="md-ellipsis">Multivariate OLS</span>
  </a>
  
    <nav class="md-nav" aria-label="Multivariate OLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Using-GLS-with-common-regressors" class="md-nav__link">
    <span title="/system/examples/examples.ipynb#using-gls-with-common-regressors (reference label)" class="md-ellipsis">Using GLS with common regressors</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<h1 id="Examples">Examples<a class="headerlink" href="#Examples" title="Link to this heading">¶</a></h1>
<p>System regression simultaneously estimates multiple models. This has three distinct advantages:</p>
<ul class="simple">
<li><p>Joint inference across models</p></li>
<li><p>Linear restrictions can be imposed on the parameters across different models</p></li>
<li><p>Improved precision of parameter estimates (depending on the model specification and data)</p></li>
</ul>
<p>There are <span class="math notranslate nohighlight">\(K\)</span> models and each model can be expressed in vector notation as</p>
<div class="math notranslate nohighlight">
\[Y_i = X_i\beta_i + \epsilon_i\]</div>
<p>so that the set of models can be expressed as</p>
<div class="math notranslate nohighlight">
\[Y = X\beta + \epsilon\]</div>
<p>where <span class="math notranslate nohighlight">\(Y\)</span> is a column vector that stacks the vectors <span class="math notranslate nohighlight">\(Y_i\)</span> for <span class="math notranslate nohighlight">\(i=1,2,\ldots,K\)</span>, <span class="math notranslate nohighlight">\(X\)</span> is a block-diagonal matrix where diagonal block i is <span class="math notranslate nohighlight">\(X_i\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> is a stacked vector of the <span class="math notranslate nohighlight">\(K\)</span> <span class="math notranslate nohighlight">\(\beta_i\)</span>s and <span class="math notranslate nohighlight">\(\epsilon\)</span> is similarly comprised of the stacked columns of <span class="math notranslate nohighlight">\(\epsilon_i\)</span>.</p>
<p>The model can be estimated using OLS with the usual estimator</p>
<div class="math notranslate nohighlight">
\[\hat{\beta}_{OLS} = \left(X^\prime X\right)^{-1}X^\prime Y.\]</div>
<p>Since there are multiple series, a GLS estimator that accounts for the cross-sectional heteroskedasticity as well as the correlation of residuals can be estimated</p>
<div class="math notranslate nohighlight">
\[\hat{\beta}_{GLS} = \left(X^\prime \Omega^{-1} X\right)^{-1}X^\prime  \Omega^{-1} Y\]</div>
<p>where <span class="math notranslate nohighlight">\(\Omega^{-1} = \Sigma^{-1} \otimes I_{T}\)</span>, <span class="math notranslate nohighlight">\(\Sigma_{ij}\)</span> is the covariance between <span class="math notranslate nohighlight">\(\epsilon_i\)</span> and <span class="math notranslate nohighlight">\(\epsilon_j\)</span> and <span class="math notranslate nohighlight">\(T\)</span> is the number of observations. The GLS estimator is only beneficial when the regressors in different models differ and when residuals are correlated. There GLS estimates are identical to the multivariate OLS estimates when all regressors are common.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Common libraries</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</code></pre></div>
</div>
</div>
<h2 id="Data">Data<a class="headerlink" href="#Data" title="Link to this heading">¶</a></h2>
<p>Two data sets will be used. The first is from Munnell which looks at the effect of capital on state GDP. This example follows the example in Chapter 10 in recent editions of Greene”s <em>Econometric Analysis</em>.</p>
<p>The data is state-level but the model is estimated in region. The first step is to aggregate the data by region. All capital measures are summed and the unemployment rate is averaged using weights proportional to the total employment in each state.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">linearmodels.datasets</span> <span class="kn">import</span> <span class="n">munnell</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">munnell</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">regions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;GF&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;AL&quot;</span><span class="p">,</span> <span class="s2">&quot;FL&quot;</span><span class="p">,</span> <span class="s2">&quot;LA&quot;</span><span class="p">,</span> <span class="s2">&quot;MS&quot;</span><span class="p">],</span>
    <span class="s2">&quot;MW&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;IL&quot;</span><span class="p">,</span> <span class="s2">&quot;IN&quot;</span><span class="p">,</span> <span class="s2">&quot;KY&quot;</span><span class="p">,</span> <span class="s2">&quot;MI&quot;</span><span class="p">,</span> <span class="s2">&quot;MN&quot;</span><span class="p">,</span> <span class="s2">&quot;OH&quot;</span><span class="p">,</span> <span class="s2">&quot;WI&quot;</span><span class="p">],</span>
    <span class="s2">&quot;MA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="s2">&quot;MD&quot;</span><span class="p">,</span> <span class="s2">&quot;NJ&quot;</span><span class="p">,</span> <span class="s2">&quot;NY&quot;</span><span class="p">,</span> <span class="s2">&quot;PA&quot;</span><span class="p">,</span> <span class="s2">&quot;VA&quot;</span><span class="p">],</span>
    <span class="s2">&quot;MT&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CO&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;MT&quot;</span><span class="p">,</span> <span class="s2">&quot;ND&quot;</span><span class="p">,</span> <span class="s2">&quot;SD&quot;</span><span class="p">,</span> <span class="s2">&quot;WY&quot;</span><span class="p">],</span>
    <span class="s2">&quot;NE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CT&quot;</span><span class="p">,</span> <span class="s2">&quot;ME&quot;</span><span class="p">,</span> <span class="s2">&quot;MA&quot;</span><span class="p">,</span> <span class="s2">&quot;NH&quot;</span><span class="p">,</span> <span class="s2">&quot;RI&quot;</span><span class="p">,</span> <span class="s2">&quot;VT&quot;</span><span class="p">],</span>
    <span class="s2">&quot;SO&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GA&quot;</span><span class="p">,</span> <span class="s2">&quot;NC&quot;</span><span class="p">,</span> <span class="s2">&quot;SC&quot;</span><span class="p">,</span> <span class="s2">&quot;TN&quot;</span><span class="p">,</span> <span class="s2">&quot;WV&quot;</span><span class="p">,</span> <span class="s2">&quot;AR&quot;</span><span class="p">],</span>
    <span class="s2">&quot;SW&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;AZ&quot;</span><span class="p">,</span> <span class="s2">&quot;NV&quot;</span><span class="p">,</span> <span class="s2">&quot;NM&quot;</span><span class="p">,</span> <span class="s2">&quot;TX&quot;</span><span class="p">,</span> <span class="s2">&quot;UT&quot;</span><span class="p">],</span>
    <span class="s2">&quot;CN&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;AK&quot;</span><span class="p">,</span> <span class="s2">&quot;IA&quot;</span><span class="p">,</span> <span class="s2">&quot;KS&quot;</span><span class="p">,</span> <span class="s2">&quot;MO&quot;</span><span class="p">,</span> <span class="s2">&quot;NE&quot;</span><span class="p">,</span> <span class="s2">&quot;OK&quot;</span><span class="p">],</span>
    <span class="s2">&quot;WC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;OR&quot;</span><span class="p">,</span> <span class="s2">&quot;WA&quot;</span><span class="p">],</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">map_region</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">key</span>


<span class="n">data</span><span class="p">[</span><span class="s2">&quot;REGION&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ST_ABB</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">map_region</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;TOTAL_EMP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;REGION&quot;</span><span class="p">,</span> <span class="s2">&quot;YR&quot;</span><span class="p">])[</span><span class="s2">&quot;EMP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;EMP_SHARE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EMP</span> <span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">TOTAL_EMP</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;WEIGHED_UNEMP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EMP_SHARE</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">UNEMP</span>
</code></pre></div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">groupby</span></code> transformation is used to aggregate the data, and finally all values except the unemployment rate are logged.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;REGION&quot;</span><span class="p">,</span> <span class="s2">&quot;YR&quot;</span><span class="p">])</span>
<span class="n">agg_data</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[[</span><span class="s2">&quot;GSP&quot;</span><span class="p">,</span> <span class="s2">&quot;PC&quot;</span><span class="p">,</span> <span class="s2">&quot;HWY&quot;</span><span class="p">,</span> <span class="s2">&quot;WATER&quot;</span><span class="p">,</span> <span class="s2">&quot;UTIL&quot;</span><span class="p">,</span> <span class="s2">&quot;EMP&quot;</span><span class="p">,</span> <span class="s2">&quot;WEIGHED_UNEMP&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;GSP&quot;</span><span class="p">,</span> <span class="s2">&quot;PC&quot;</span><span class="p">,</span> <span class="s2">&quot;HWY&quot;</span><span class="p">,</span> <span class="s2">&quot;WATER&quot;</span><span class="p">,</span> <span class="s2">&quot;UTIL&quot;</span><span class="p">,</span> <span class="s2">&quot;EMP&quot;</span><span class="p">]:</span>
    <span class="n">agg_data</span><span class="p">[</span><span class="s2">&quot;ln&quot;</span> <span class="o">+</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">agg_data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
<span class="n">agg_data</span><span class="p">[</span><span class="s2">&quot;UNEMP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agg_data</span><span class="o">.</span><span class="n">WEIGHED_UNEMP</span>
<span class="n">agg_data</span><span class="p">[</span><span class="s2">&quot;Intercept&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</code></pre></div>
</div>
</div>
<h2 id="Basic-Usage">Basic Usage<a class="headerlink" href="#Basic-Usage" title="Link to this heading">¶</a></h2>
<p>Seemingly Unrelated Models are fairly complex and each equation could have a different number of regressors. As a result, it is not possibly to use standard <code class="docutils literal notranslate"><span class="pre">pandas</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy</span></code> data structures, and so dictionaries (or technically dictionary-like objects) are used. In practice, it is strongly recommended to use a <code class="docutils literal notranslate"><span class="pre">OrderedDictionary</span></code> from the <code class="docutils literal notranslate"><span class="pre">collections</span></code> module. This ensures that equation order will be preserved. In addition, the dictionary must have the following structure:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keys</span></code> <strong>must be strings</strong> and will be used as equation labels</p></li>
<li><p>The value associated with each key must be either a dictionary or a tuple.</p>
<ul>
<li><p>When a dictionary is used, it must have two keys, <code class="docutils literal notranslate"><span class="pre">dependent</span></code> and <code class="docutils literal notranslate"><span class="pre">exog</span></code>. It can optionally have a third key <code class="docutils literal notranslate"><span class="pre">weights</span></code> which provides weights to use in the regression.</p></li>
<li><p>When a tuple is used, it must have two elements and takes the form <code class="docutils literal notranslate"><span class="pre">(dependent,</span> <span class="pre">exog)</span></code>. It can optionally contains weights in which case it takes the form <code class="docutils literal notranslate"><span class="pre">(dependent,</span> <span class="pre">exog,</span> <span class="pre">weights)</span></code>.</p></li>
</ul>
</li>
</ul>
<p>This example uses the dictionary syntax to contain the data for each region and uses the region identified as the equation label.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="n">mod_data</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;GF&quot;</span><span class="p">,</span> <span class="s2">&quot;SW&quot;</span><span class="p">,</span> <span class="s2">&quot;WC&quot;</span><span class="p">,</span> <span class="s2">&quot;MT&quot;</span><span class="p">,</span> <span class="s2">&quot;NE&quot;</span><span class="p">,</span> <span class="s2">&quot;MA&quot;</span><span class="p">,</span> <span class="s2">&quot;SO&quot;</span><span class="p">,</span> <span class="s2">&quot;MW&quot;</span><span class="p">,</span> <span class="s2">&quot;CN&quot;</span><span class="p">]:</span>
    <span class="n">region_data</span> <span class="o">=</span> <span class="n">agg_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">region</span><span class="p">]</span>
    <span class="n">dependent</span> <span class="o">=</span> <span class="n">region_data</span><span class="o">.</span><span class="n">lnGSP</span>
    <span class="n">exog</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;Intercept&quot;</span><span class="p">,</span> <span class="s2">&quot;lnPC&quot;</span><span class="p">,</span> <span class="s2">&quot;lnHWY&quot;</span><span class="p">,</span> <span class="s2">&quot;lnWATER&quot;</span><span class="p">,</span> <span class="s2">&quot;lnUTIL&quot;</span><span class="p">,</span> <span class="s2">&quot;lnEMP&quot;</span><span class="p">,</span> <span class="s2">&quot;UNEMP&quot;</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">mod_data</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dependent&quot;</span><span class="p">:</span> <span class="n">dependent</span><span class="p">,</span> <span class="s2">&quot;exog&quot;</span><span class="p">:</span> <span class="n">exog</span><span class="p">}</span>
</code></pre></div>
</div>
</div>
<p>Fitting the model is virtually identical to fitting any other model with the exception of the special data structure required.</p>
<p>The fitting options here ensure that the homoskedastic covariance estimator are used (<code class="docutils literal notranslate"><span class="pre">cov_type=&quot;unadjusted&quot;</span></code>) and that a small sample adjustment is applied. By default, GLS is used (this can be overridden using <code class="docutils literal notranslate"><span class="pre">method=&quot;ols&quot;</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">linearmodels.system</span> <span class="kn">import</span> <span class="n">SUR</span>

<span class="n">mod</span> <span class="o">=</span> <span class="n">SUR</span><span class="p">(</span><span class="n">mod_data</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>One of the requirements for there to be an efficiency gain in a SUR is that the residuals are correlated. A heatmap is used to inspect this correlation, which is substantial and varies by region.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">cov</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">sigma</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">sigma</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">])</span>
<span class="n">regions</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">mod_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cov</span> <span class="o">/</span> <span class="p">(</span><span class="n">std</span> <span class="o">@</span> <span class="n">std</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">regions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">regions</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">corr</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/system_examples_examples_11_0.png" src="../../_images/system_examples_examples_11_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_1bda5">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_1bda5_level0_col0" class="col_heading level0 col0" >GF</th>
      <th id="T_1bda5_level0_col1" class="col_heading level0 col1" >SW</th>
      <th id="T_1bda5_level0_col2" class="col_heading level0 col2" >WC</th>
      <th id="T_1bda5_level0_col3" class="col_heading level0 col3" >MT</th>
      <th id="T_1bda5_level0_col4" class="col_heading level0 col4" >NE</th>
      <th id="T_1bda5_level0_col5" class="col_heading level0 col5" >MA</th>
      <th id="T_1bda5_level0_col6" class="col_heading level0 col6" >SO</th>
      <th id="T_1bda5_level0_col7" class="col_heading level0 col7" >MW</th>
      <th id="T_1bda5_level0_col8" class="col_heading level0 col8" >CN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_1bda5_level0_row0" class="row_heading level0 row0" >GF</th>
      <td id="T_1bda5_row0_col0" class="data row0 col0" >1.000</td>
      <td id="T_1bda5_row0_col1" class="data row0 col1" >0.173</td>
      <td id="T_1bda5_row0_col2" class="data row0 col2" >0.447</td>
      <td id="T_1bda5_row0_col3" class="data row0 col3" >-0.547</td>
      <td id="T_1bda5_row0_col4" class="data row0 col4" >0.525</td>
      <td id="T_1bda5_row0_col5" class="data row0 col5" >0.425</td>
      <td id="T_1bda5_row0_col6" class="data row0 col6" >0.763</td>
      <td id="T_1bda5_row0_col7" class="data row0 col7" >0.167</td>
      <td id="T_1bda5_row0_col8" class="data row0 col8" >0.325</td>
    </tr>
    <tr>
      <th id="T_1bda5_level0_row1" class="row_heading level0 row1" >SW</th>
      <td id="T_1bda5_row1_col0" class="data row1 col0" >0.173</td>
      <td id="T_1bda5_row1_col1" class="data row1 col1" >1.000</td>
      <td id="T_1bda5_row1_col2" class="data row1 col2" >0.697</td>
      <td id="T_1bda5_row1_col3" class="data row1 col3" >-0.290</td>
      <td id="T_1bda5_row1_col4" class="data row1 col4" >0.489</td>
      <td id="T_1bda5_row1_col5" class="data row1 col5" >0.132</td>
      <td id="T_1bda5_row1_col6" class="data row1 col6" >0.314</td>
      <td id="T_1bda5_row1_col7" class="data row1 col7" >0.565</td>
      <td id="T_1bda5_row1_col8" class="data row1 col8" >0.119</td>
    </tr>
    <tr>
      <th id="T_1bda5_level0_row2" class="row_heading level0 row2" >WC</th>
      <td id="T_1bda5_row2_col0" class="data row2 col0" >0.447</td>
      <td id="T_1bda5_row2_col1" class="data row2 col1" >0.697</td>
      <td id="T_1bda5_row2_col2" class="data row2 col2" >1.000</td>
      <td id="T_1bda5_row2_col3" class="data row2 col3" >-0.537</td>
      <td id="T_1bda5_row2_col4" class="data row2 col4" >0.343</td>
      <td id="T_1bda5_row2_col5" class="data row2 col5" >0.130</td>
      <td id="T_1bda5_row2_col6" class="data row2 col6" >0.505</td>
      <td id="T_1bda5_row2_col7" class="data row2 col7" >0.574</td>
      <td id="T_1bda5_row2_col8" class="data row2 col8" >0.037</td>
    </tr>
    <tr>
      <th id="T_1bda5_level0_row3" class="row_heading level0 row3" >MT</th>
      <td id="T_1bda5_row3_col0" class="data row3 col0" >-0.547</td>
      <td id="T_1bda5_row3_col1" class="data row3 col1" >-0.290</td>
      <td id="T_1bda5_row3_col2" class="data row3 col2" >-0.537</td>
      <td id="T_1bda5_row3_col3" class="data row3 col3" >1.000</td>
      <td id="T_1bda5_row3_col4" class="data row3 col4" >-0.241</td>
      <td id="T_1bda5_row3_col5" class="data row3 col5" >-0.322</td>
      <td id="T_1bda5_row3_col6" class="data row3 col6" >-0.351</td>
      <td id="T_1bda5_row3_col7" class="data row3 col7" >-0.058</td>
      <td id="T_1bda5_row3_col8" class="data row3 col8" >0.091</td>
    </tr>
    <tr>
      <th id="T_1bda5_level0_row4" class="row_heading level0 row4" >NE</th>
      <td id="T_1bda5_row4_col0" class="data row4 col0" >0.525</td>
      <td id="T_1bda5_row4_col1" class="data row4 col1" >0.489</td>
      <td id="T_1bda5_row4_col2" class="data row4 col2" >0.343</td>
      <td id="T_1bda5_row4_col3" class="data row4 col3" >-0.241</td>
      <td id="T_1bda5_row4_col4" class="data row4 col4" >1.000</td>
      <td id="T_1bda5_row4_col5" class="data row4 col5" >0.259</td>
      <td id="T_1bda5_row4_col6" class="data row4 col6" >0.783</td>
      <td id="T_1bda5_row4_col7" class="data row4 col7" >0.269</td>
      <td id="T_1bda5_row4_col8" class="data row4 col8" >0.200</td>
    </tr>
    <tr>
      <th id="T_1bda5_level0_row5" class="row_heading level0 row5" >MA</th>
      <td id="T_1bda5_row5_col0" class="data row5 col0" >0.425</td>
      <td id="T_1bda5_row5_col1" class="data row5 col1" >0.132</td>
      <td id="T_1bda5_row5_col2" class="data row5 col2" >0.130</td>
      <td id="T_1bda5_row5_col3" class="data row5 col3" >-0.322</td>
      <td id="T_1bda5_row5_col4" class="data row5 col4" >0.259</td>
      <td id="T_1bda5_row5_col5" class="data row5 col5" >1.000</td>
      <td id="T_1bda5_row5_col6" class="data row5 col6" >0.388</td>
      <td id="T_1bda5_row5_col7" class="data row5 col7" >-0.037</td>
      <td id="T_1bda5_row5_col8" class="data row5 col8" >0.713</td>
    </tr>
    <tr>
      <th id="T_1bda5_level0_row6" class="row_heading level0 row6" >SO</th>
      <td id="T_1bda5_row6_col0" class="data row6 col0" >0.763</td>
      <td id="T_1bda5_row6_col1" class="data row6 col1" >0.314</td>
      <td id="T_1bda5_row6_col2" class="data row6 col2" >0.505</td>
      <td id="T_1bda5_row6_col3" class="data row6 col3" >-0.351</td>
      <td id="T_1bda5_row6_col4" class="data row6 col4" >0.783</td>
      <td id="T_1bda5_row6_col5" class="data row6 col5" >0.388</td>
      <td id="T_1bda5_row6_col6" class="data row6 col6" >1.000</td>
      <td id="T_1bda5_row6_col7" class="data row6 col7" >0.366</td>
      <td id="T_1bda5_row6_col8" class="data row6 col8" >0.350</td>
    </tr>
    <tr>
      <th id="T_1bda5_level0_row7" class="row_heading level0 row7" >MW</th>
      <td id="T_1bda5_row7_col0" class="data row7 col0" >0.167</td>
      <td id="T_1bda5_row7_col1" class="data row7 col1" >0.565</td>
      <td id="T_1bda5_row7_col2" class="data row7 col2" >0.574</td>
      <td id="T_1bda5_row7_col3" class="data row7 col3" >-0.058</td>
      <td id="T_1bda5_row7_col4" class="data row7 col4" >0.269</td>
      <td id="T_1bda5_row7_col5" class="data row7 col5" >-0.037</td>
      <td id="T_1bda5_row7_col6" class="data row7 col6" >0.366</td>
      <td id="T_1bda5_row7_col7" class="data row7 col7" >1.000</td>
      <td id="T_1bda5_row7_col8" class="data row7 col8" >0.298</td>
    </tr>
    <tr>
      <th id="T_1bda5_level0_row8" class="row_heading level0 row8" >CN</th>
      <td id="T_1bda5_row8_col0" class="data row8 col0" >0.325</td>
      <td id="T_1bda5_row8_col1" class="data row8 col1" >0.119</td>
      <td id="T_1bda5_row8_col2" class="data row8 col2" >0.037</td>
      <td id="T_1bda5_row8_col3" class="data row8 col3" >0.091</td>
      <td id="T_1bda5_row8_col4" class="data row8 col4" >0.200</td>
      <td id="T_1bda5_row8_col5" class="data row8 col5" >0.713</td>
      <td id="T_1bda5_row8_col6" class="data row8 col6" >0.350</td>
      <td id="T_1bda5_row8_col7" class="data row8 col7" >0.298</td>
      <td id="T_1bda5_row8_col8" class="data row8 col8" >1.000</td>
    </tr>
  </tbody>
</table></div>
</div>
<p>These values can be seen to be identical to the reported results in the existing example from Greene.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display_png</span>

<span class="n">display_png</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;system_correct-greene-table-10-2.png&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/system_examples_examples_13_0.png" src="../../_images/system_examples_examples_13_0.png" />
</div>
</div>
<p>The full result is fairly long and so here I only print the first 33 lines which show results for two regions. By default it reports all estimates along with the usual measures of precision.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">as_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[:</span><span class="mi">33</span><span class="p">]))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.9937
No. Equations.:                     9   McElroy&#39;s R-squared:                 0.9988
No. Observations:                  17   Judge&#39;s (OLS) R-squared:             0.9937
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  1.0000
Time:                        17:54:27   Dhrymes&#39;s R-squared:                 0.9937
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                   Equation: GF, Dependent Variable: lnGSP
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      12.310     2.2513     5.4680     0.0000      7.8976      16.723
lnPC          -0.2010     0.1424    -1.4117     0.1580     -0.4800      0.0780
lnHWY         -1.8856     0.5169    -3.6480     0.0003     -2.8987     -0.8725
lnWATER        0.1785     0.0607     2.9399     0.0033      0.0595      0.2975
lnUTIL         1.1898     0.3744     3.1774     0.0015      0.4559      1.9237
lnEMP          0.9533     0.0847     11.252     0.0000      0.7872      1.1193
UNEMP         -0.0031     0.0021    -1.5007     0.1334     -0.0072      0.0009
                   Equation: SW, Dependent Variable: lnGSP
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      4.0831     0.9979     4.0918     0.0000      2.1273      6.0389
lnPC           0.0766     0.0858     0.8929     0.3719     -0.0916      0.2449
lnHWY         -0.1312     0.1279    -1.0258     0.3050     -0.3819      0.1195
lnWATER       -0.1360     0.0611    -2.2240     0.0261     -0.2558     -0.0161
lnUTIL         0.5216     0.1107     4.7102     0.0000      0.3045      0.7386
lnEMP          0.5387     0.0849     6.3439     0.0000      0.3723      0.7051
UNEMP         -0.0156     0.0025    -6.2950     0.0000     -0.0205     -0.0108
                   Equation: WC, Dependent Variable: lnGSP
==============================================================================
</pre></div></div>
</div>
<p>Individual results are contained in a dictionary located at the attribute <code class="docutils literal notranslate"><span class="pre">equations</span></code> and can be accessed using equation labels (available using the attribute <code class="docutils literal notranslate"><span class="pre">equation_labels</span></code>). Additional information about the model is presented in this view. The West Coast results are show.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">equations</span><span class="p">[</span><span class="s2">&quot;WC&quot;</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            GLS Estimation Summary
==============================================================================
Eq. Label:                         WC   R-squared:                      0.9937
Dep. Variable:                  lnGSP   Adj. R-squared:                 0.9900
Estimator:                        GLS   Cov. Estimator:             unadjusted
No. Observations:                  17   F-statistic:                    2862.4
Date:                Fri, Jul 19 2024   P-value (F-stat)                0.0000
Time:                        17:54:27   Distribution:                  chi2(6)

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      1.9602     3.4542     0.5675     0.5704     -4.8100      8.7303
lnPC           0.1699     0.0919     1.8500     0.0643     -0.0101      0.3500
lnHWY          0.1317     0.1138     1.1569     0.2473     -0.0914      0.3547
lnWATER       -0.3470     0.1733    -2.0020     0.0453     -0.6867     -0.0073
lnUTIL         0.0895     0.4642     0.1928     0.8471     -0.8204      0.9994
lnEMP          1.0696     0.1708     6.2634     0.0000      0.7349      1.4043
UNEMP         -0.0060     0.0042    -1.4180     0.1562     -0.0143      0.0023

==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div>
</div>
<p>The current version of the model does not facilitate cross equation comparisons and so this is manually implemented here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># TODO: Implement method to compare across equations</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">equation_labels</span><span class="p">:</span>
    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">equations</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">equation_labels</span>
<span class="n">params</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_2c737">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_2c737_level0_col0" class="col_heading level0 col0" >Intercept</th>
      <th id="T_2c737_level0_col1" class="col_heading level0 col1" >lnPC</th>
      <th id="T_2c737_level0_col2" class="col_heading level0 col2" >lnHWY</th>
      <th id="T_2c737_level0_col3" class="col_heading level0 col3" >lnWATER</th>
      <th id="T_2c737_level0_col4" class="col_heading level0 col4" >lnUTIL</th>
      <th id="T_2c737_level0_col5" class="col_heading level0 col5" >lnEMP</th>
      <th id="T_2c737_level0_col6" class="col_heading level0 col6" >UNEMP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_2c737_level0_row0" class="row_heading level0 row0" >GF</th>
      <td id="T_2c737_row0_col0" class="data row0 col0" >12.310</td>
      <td id="T_2c737_row0_col1" class="data row0 col1" >-0.201</td>
      <td id="T_2c737_row0_col2" class="data row0 col2" >-1.886</td>
      <td id="T_2c737_row0_col3" class="data row0 col3" >0.178</td>
      <td id="T_2c737_row0_col4" class="data row0 col4" >1.190</td>
      <td id="T_2c737_row0_col5" class="data row0 col5" >0.953</td>
      <td id="T_2c737_row0_col6" class="data row0 col6" >-0.003</td>
    </tr>
    <tr>
      <th id="T_2c737_level0_row1" class="row_heading level0 row1" >SW</th>
      <td id="T_2c737_row1_col0" class="data row1 col0" >4.083</td>
      <td id="T_2c737_row1_col1" class="data row1 col1" >0.077</td>
      <td id="T_2c737_row1_col2" class="data row1 col2" >-0.131</td>
      <td id="T_2c737_row1_col3" class="data row1 col3" >-0.136</td>
      <td id="T_2c737_row1_col4" class="data row1 col4" >0.522</td>
      <td id="T_2c737_row1_col5" class="data row1 col5" >0.539</td>
      <td id="T_2c737_row1_col6" class="data row1 col6" >-0.016</td>
    </tr>
    <tr>
      <th id="T_2c737_level0_row2" class="row_heading level0 row2" >WC</th>
      <td id="T_2c737_row2_col0" class="data row2 col0" >1.960</td>
      <td id="T_2c737_row2_col1" class="data row2 col1" >0.170</td>
      <td id="T_2c737_row2_col2" class="data row2 col2" >0.132</td>
      <td id="T_2c737_row2_col3" class="data row2 col3" >-0.347</td>
      <td id="T_2c737_row2_col4" class="data row2 col4" >0.090</td>
      <td id="T_2c737_row2_col5" class="data row2 col5" >1.070</td>
      <td id="T_2c737_row2_col6" class="data row2 col6" >-0.006</td>
    </tr>
    <tr>
      <th id="T_2c737_level0_row3" class="row_heading level0 row3" >MT</th>
      <td id="T_2c737_row3_col0" class="data row3 col0" >3.463</td>
      <td id="T_2c737_row3_col1" class="data row3 col1" >-0.115</td>
      <td id="T_2c737_row3_col2" class="data row3 col2" >0.180</td>
      <td id="T_2c737_row3_col3" class="data row3 col3" >0.262</td>
      <td id="T_2c737_row3_col4" class="data row3 col4" >-0.330</td>
      <td id="T_2c737_row3_col5" class="data row3 col5" >1.079</td>
      <td id="T_2c737_row3_col6" class="data row3 col6" >-0.001</td>
    </tr>
    <tr>
      <th id="T_2c737_level0_row4" class="row_heading level0 row4" >NE</th>
      <td id="T_2c737_row4_col0" class="data row4 col0" >-12.294</td>
      <td id="T_2c737_row4_col1" class="data row4 col1" >0.118</td>
      <td id="T_2c737_row4_col2" class="data row4 col2" >0.934</td>
      <td id="T_2c737_row4_col3" class="data row4 col3" >-0.557</td>
      <td id="T_2c737_row4_col4" class="data row4 col4" >-0.290</td>
      <td id="T_2c737_row4_col5" class="data row4 col5" >2.494</td>
      <td id="T_2c737_row4_col6" class="data row4 col6" >0.020</td>
    </tr>
    <tr>
      <th id="T_2c737_level0_row5" class="row_heading level0 row5" >MA</th>
      <td id="T_2c737_row5_col0" class="data row5 col0" >-18.616</td>
      <td id="T_2c737_row5_col1" class="data row5 col1" >-0.311</td>
      <td id="T_2c737_row5_col2" class="data row5 col2" >3.060</td>
      <td id="T_2c737_row5_col3" class="data row5 col3" >-0.109</td>
      <td id="T_2c737_row5_col4" class="data row5 col4" >-1.659</td>
      <td id="T_2c737_row5_col5" class="data row5 col5" >2.186</td>
      <td id="T_2c737_row5_col6" class="data row5 col6" >0.018</td>
    </tr>
    <tr>
      <th id="T_2c737_level0_row6" class="row_heading level0 row6" >SO</th>
      <td id="T_2c737_row6_col0" class="data row6 col0" >3.162</td>
      <td id="T_2c737_row6_col1" class="data row6 col1" >-0.063</td>
      <td id="T_2c737_row6_col2" class="data row6 col2" >-0.641</td>
      <td id="T_2c737_row6_col3" class="data row6 col3" >-0.081</td>
      <td id="T_2c737_row6_col4" class="data row6 col4" >0.281</td>
      <td id="T_2c737_row6_col5" class="data row6 col5" >1.620</td>
      <td id="T_2c737_row6_col6" class="data row6 col6" >0.008</td>
    </tr>
    <tr>
      <th id="T_2c737_level0_row7" class="row_heading level0 row7" >MW</th>
      <td id="T_2c737_row7_col0" class="data row7 col0" >-9.258</td>
      <td id="T_2c737_row7_col1" class="data row7 col1" >0.096</td>
      <td id="T_2c737_row7_col2" class="data row7 col2" >1.612</td>
      <td id="T_2c737_row7_col3" class="data row7 col3" >0.694</td>
      <td id="T_2c737_row7_col4" class="data row7 col4" >-0.340</td>
      <td id="T_2c737_row7_col5" class="data row7 col5" >-0.062</td>
      <td id="T_2c737_row7_col6" class="data row7 col6" >-0.031</td>
    </tr>
    <tr>
      <th id="T_2c737_level0_row8" class="row_heading level0 row8" >CN</th>
      <td id="T_2c737_row8_col0" class="data row8 col0" >-3.405</td>
      <td id="T_2c737_row8_col1" class="data row8 col1" >0.295</td>
      <td id="T_2c737_row8_col2" class="data row8 col2" >0.934</td>
      <td id="T_2c737_row8_col3" class="data row8 col3" >0.539</td>
      <td id="T_2c737_row8_col4" class="data row8 col4" >0.003</td>
      <td id="T_2c737_row8_col5" class="data row8 col5" >-0.321</td>
      <td id="T_2c737_row8_col6" class="data row8 col6" >-0.029</td>
    </tr>
  </tbody>
</table></div>
</div>
<p>These results can be compared to the results in Greene – they are unsurprisingly identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">display_png</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;system_correct-greene-table-10-1.png&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/system_examples_examples_21_0.png" src="../../_images/system_examples_examples_21_0.png" />
</div>
</div>
<p>The GLS estimation method requires stronger assumptions for parameter estimates to be consistent. If these are violated then it might be the case that OLS is still consistent (in some sense) and so OLS can be used by passing <code class="docutils literal notranslate"><span class="pre">method=&quot;ols&quot;</span></code> when calling <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
<p>These results can be compared to Greene”s table – they are identical except the final value which seems to have a small typo.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_ols</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;ols&quot;</span><span class="p">,</span> <span class="n">debiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">r2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">equation_labels</span><span class="p">:</span>
    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res_ols</span><span class="o">.</span><span class="n">equations</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
    <span class="n">r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res_ols</span><span class="o">.</span><span class="n">equations</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">rsquared</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">equation_labels</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">T</span>
<span class="n">params</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r2</span>
<span class="n">params</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
</style>
<table id="T_088bf">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_088bf_level0_col0" class="col_heading level0 col0" >Intercept</th>
      <th id="T_088bf_level0_col1" class="col_heading level0 col1" >lnPC</th>
      <th id="T_088bf_level0_col2" class="col_heading level0 col2" >lnHWY</th>
      <th id="T_088bf_level0_col3" class="col_heading level0 col3" >lnWATER</th>
      <th id="T_088bf_level0_col4" class="col_heading level0 col4" >lnUTIL</th>
      <th id="T_088bf_level0_col5" class="col_heading level0 col5" >lnEMP</th>
      <th id="T_088bf_level0_col6" class="col_heading level0 col6" >UNEMP</th>
      <th id="T_088bf_level0_col7" class="col_heading level0 col7" >R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_088bf_level0_row0" class="row_heading level0 row0" >GF</th>
      <td id="T_088bf_row0_col0" class="data row0 col0" >11.567</td>
      <td id="T_088bf_row0_col1" class="data row0 col1" >0.002</td>
      <td id="T_088bf_row0_col2" class="data row0 col2" >-2.029</td>
      <td id="T_088bf_row0_col3" class="data row0 col3" >0.101</td>
      <td id="T_088bf_row0_col4" class="data row0 col4" >1.358</td>
      <td id="T_088bf_row0_col5" class="data row0 col5" >0.805</td>
      <td id="T_088bf_row0_col6" class="data row0 col6" >-0.007</td>
      <td id="T_088bf_row0_col7" class="data row0 col7" >0.997</td>
    </tr>
    <tr>
      <th id="T_088bf_level0_row1" class="row_heading level0 row1" >SW</th>
      <td id="T_088bf_row1_col0" class="data row1 col0" >3.028</td>
      <td id="T_088bf_row1_col1" class="data row1 col1" >0.164</td>
      <td id="T_088bf_row1_col2" class="data row1 col2" >-0.075</td>
      <td id="T_088bf_row1_col3" class="data row1 col3" >-0.169</td>
      <td id="T_088bf_row1_col4" class="data row1 col4" >0.637</td>
      <td id="T_088bf_row1_col5" class="data row1 col5" >0.362</td>
      <td id="T_088bf_row1_col6" class="data row1 col6" >-0.017</td>
      <td id="T_088bf_row1_col7" class="data row1 col7" >0.998</td>
    </tr>
    <tr>
      <th id="T_088bf_level0_row2" class="row_heading level0 row2" >WC</th>
      <td id="T_088bf_row2_col0" class="data row2 col0" >3.590</td>
      <td id="T_088bf_row2_col1" class="data row2 col1" >0.295</td>
      <td id="T_088bf_row2_col2" class="data row2 col2" >0.174</td>
      <td id="T_088bf_row2_col3" class="data row2 col3" >-0.226</td>
      <td id="T_088bf_row2_col4" class="data row2 col4" >-0.214</td>
      <td id="T_088bf_row2_col5" class="data row2 col5" >0.917</td>
      <td id="T_088bf_row2_col6" class="data row2 col6" >-0.008</td>
      <td id="T_088bf_row2_col7" class="data row2 col7" >0.994</td>
    </tr>
    <tr>
      <th id="T_088bf_level0_row3" class="row_heading level0 row3" >MT</th>
      <td id="T_088bf_row3_col0" class="data row3 col0" >6.378</td>
      <td id="T_088bf_row3_col1" class="data row3 col1" >-0.153</td>
      <td id="T_088bf_row3_col2" class="data row3 col2" >-0.123</td>
      <td id="T_088bf_row3_col3" class="data row3 col3" >0.306</td>
      <td id="T_088bf_row3_col4" class="data row3 col4" >-0.533</td>
      <td id="T_088bf_row3_col5" class="data row3 col5" >1.344</td>
      <td id="T_088bf_row3_col6" class="data row3 col6" >0.005</td>
      <td id="T_088bf_row3_col7" class="data row3 col7" >0.999</td>
    </tr>
    <tr>
      <th id="T_088bf_level0_row4" class="row_heading level0 row4" >NE</th>
      <td id="T_088bf_row4_col0" class="data row4 col0" >-13.730</td>
      <td id="T_088bf_row4_col1" class="data row4 col1" >-0.020</td>
      <td id="T_088bf_row4_col2" class="data row4 col2" >0.662</td>
      <td id="T_088bf_row4_col3" class="data row4 col3" >-0.969</td>
      <td id="T_088bf_row4_col4" class="data row4 col4" >-0.107</td>
      <td id="T_088bf_row4_col5" class="data row4 col5" >3.380</td>
      <td id="T_088bf_row4_col6" class="data row4 col6" >0.034</td>
      <td id="T_088bf_row4_col7" class="data row4 col7" >0.985</td>
    </tr>
    <tr>
      <th id="T_088bf_level0_row5" class="row_heading level0 row5" >MA</th>
      <td id="T_088bf_row5_col0" class="data row5 col0" >-22.855</td>
      <td id="T_088bf_row5_col1" class="data row5 col1" >-0.378</td>
      <td id="T_088bf_row5_col2" class="data row5 col2" >3.348</td>
      <td id="T_088bf_row5_col3" class="data row5 col3" >-0.264</td>
      <td id="T_088bf_row5_col4" class="data row5 col4" >-1.778</td>
      <td id="T_088bf_row5_col5" class="data row5 col5" >2.673</td>
      <td id="T_088bf_row5_col6" class="data row5 col6" >0.026</td>
      <td id="T_088bf_row5_col7" class="data row5 col7" >0.986</td>
    </tr>
    <tr>
      <th id="T_088bf_level0_row6" class="row_heading level0 row6" >SO</th>
      <td id="T_088bf_row6_col0" class="data row6 col0" >3.927</td>
      <td id="T_088bf_row6_col1" class="data row6 col1" >0.043</td>
      <td id="T_088bf_row6_col2" class="data row6 col2" >-0.773</td>
      <td id="T_088bf_row6_col3" class="data row6 col3" >-0.035</td>
      <td id="T_088bf_row6_col4" class="data row6 col4" >0.140</td>
      <td id="T_088bf_row6_col5" class="data row6 col5" >1.665</td>
      <td id="T_088bf_row6_col6" class="data row6 col6" >0.008</td>
      <td id="T_088bf_row6_col7" class="data row6 col7" >0.994</td>
    </tr>
    <tr>
      <th id="T_088bf_level0_row7" class="row_heading level0 row7" >MW</th>
      <td id="T_088bf_row7_col0" class="data row7 col0" >-9.111</td>
      <td id="T_088bf_row7_col1" class="data row7 col1" >0.233</td>
      <td id="T_088bf_row7_col2" class="data row7 col2" >1.604</td>
      <td id="T_088bf_row7_col3" class="data row7 col3" >0.717</td>
      <td id="T_088bf_row7_col4" class="data row7 col4" >-0.356</td>
      <td id="T_088bf_row7_col5" class="data row7 col5" >-0.259</td>
      <td id="T_088bf_row7_col6" class="data row7 col6" >-0.034</td>
      <td id="T_088bf_row7_col7" class="data row7 col7" >0.989</td>
    </tr>
    <tr>
      <th id="T_088bf_level0_row8" class="row_heading level0 row8" >CN</th>
      <td id="T_088bf_row8_col0" class="data row8 col0" >-5.621</td>
      <td id="T_088bf_row8_col1" class="data row8 col1" >0.386</td>
      <td id="T_088bf_row8_col2" class="data row8 col2" >1.267</td>
      <td id="T_088bf_row8_col3" class="data row8 col3" >0.546</td>
      <td id="T_088bf_row8_col4" class="data row8 col4" >-0.108</td>
      <td id="T_088bf_row8_col5" class="data row8 col5" >-0.475</td>
      <td id="T_088bf_row8_col6" class="data row8 col6" >-0.031</td>
      <td id="T_088bf_row8_col7" class="data row8 col7" >0.995</td>
    </tr>
  </tbody>
</table></div>
</div>
<p>The parameter estimates for one coefficient – unemployment – can be compared across the two estimation methods.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">res_ols</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">7</span><span class="p">],</span>
        <span class="n">res_ols</span><span class="o">.</span><span class="n">std_errors</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">7</span><span class="p">],</span>
        <span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">7</span><span class="p">],</span>
        <span class="n">res</span><span class="o">.</span><span class="n">std_errors</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">7</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;OLS&quot;</span><span class="p">,</span> <span class="s2">&quot;OLS se&quot;</span><span class="p">,</span> <span class="s2">&quot;GLS&quot;</span><span class="p">,</span> <span class="s2">&quot;GLS se&quot;</span><span class="p">]</span>
<span class="n">params</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">regions</span>
<span class="n">params</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OLS</th>
      <th>OLS se</th>
      <th>GLS</th>
      <th>GLS se</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GF</th>
      <td>0.002124</td>
      <td>0.301235</td>
      <td>-0.200966</td>
      <td>0.142355</td>
    </tr>
    <tr>
      <th>SW</th>
      <td>0.163546</td>
      <td>0.165995</td>
      <td>0.076637</td>
      <td>0.085831</td>
    </tr>
    <tr>
      <th>WC</th>
      <td>0.294855</td>
      <td>0.205417</td>
      <td>0.169950</td>
      <td>0.091865</td>
    </tr>
    <tr>
      <th>MT</th>
      <td>-0.152601</td>
      <td>0.084031</td>
      <td>-0.114834</td>
      <td>0.048489</td>
    </tr>
    <tr>
      <th>NE</th>
      <td>-0.020407</td>
      <td>0.285621</td>
      <td>0.118316</td>
      <td>0.131329</td>
    </tr>
    <tr>
      <th>MA</th>
      <td>-0.377570</td>
      <td>0.167307</td>
      <td>-0.310861</td>
      <td>0.080893</td>
    </tr>
    <tr>
      <th>SO</th>
      <td>0.042818</td>
      <td>0.279472</td>
      <td>-0.063212</td>
      <td>0.104344</td>
    </tr>
    <tr>
      <th>MW</th>
      <td>0.233403</td>
      <td>0.206248</td>
      <td>0.095886</td>
      <td>0.101564</td>
    </tr>
    <tr>
      <th>CN</th>
      <td>0.385885</td>
      <td>0.211083</td>
      <td>0.294570</td>
      <td>0.090104</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The parameters and their standard errors match those reported in Greene.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">display_png</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;system_correct-greene-table-10-3.png&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/system_examples_examples_27_0.png" src="../../_images/system_examples_examples_27_0.png" />
</div>
</div>
<h2 id="Estimation-Options">Estimation Options<a class="headerlink" href="#Estimation-Options" title="Link to this heading">¶</a></h2>
<h3 id="Iterative-GLS">Iterative GLS<a class="headerlink" href="#Iterative-GLS" title="Link to this heading">¶</a></h3>
<p>These next examples use data on fringe benefits from F. Vella (1993), “A Simple Estimator for Simultaneous Models with Censored Endogenous Regressors” which appears in Wooldridge (2002). The model consists of two equations, one for hourly wage and the other for hourly benefits. The initial model uses the same regressors in both equations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">linearmodels.datasets</span> <span class="kn">import</span> <span class="n">fringe</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fringe</span><span class="o">.</span><span class="n">DESCR</span><span class="p">)</span>
<span class="n">fdata</span> <span class="o">=</span> <span class="n">fringe</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

F. Vella (1993), &#34;A Simple Estimator for Simultaneous Models with Censored
Endogenous Regressors,&#34; International Economic Review 34, 441-457.

annearn                  annual earnings, $
hrearn                   hourly earnings, $
exper                    years work experience
age                      age in years
depends                  number of dependents
married                  =1 if married
tenure                   years with current employer
educ                     years schooling
nrtheast                 =1 if live in northeast
nrthcen                  =1 if live in north central
south                    =1 if live in south
male                     =1 if male
white                    =1 if white
union                    =1 if union member
office                   =1 if office worker
annhrs                   annual hours worked
ind1                     =1 if industry == 1
ind2                     =1 if industry == 2
ind3                     =1 if industry == 3
ind4                     =1 if industry == 4
ind5                     =1 if industry == 5
ind6                     =1 if industry == 6
ind7                     =1 if industry == 7
ind8                     =1 if industry == 8
ind9                     =1 if industry == 9
vacdays                  $ value of vac days
sicklve                  $ value of sick leave
insur                    $ value of employee insur
pension                  $ value of employee pension
annbens                  vacdays+sicklve+insur+pension
hrbens                   hourly benefits, $
annhrssq                 annhrs^2
beratio                  annbens/annearn
lannhrs                  log(annhrs)
tenuresq                 tenure^2
expersq                  exper^2
lannearn                 log(annearn)
peratio                  pension/annearn
vserat                   (vacdays+sicklve)/annearn

</pre></div></div>
</div>
<p>The estimated model is reported as “System OLS Estimation” since when all regressors are identical, OLS is used since GLS brings no efficiency gains. OLS will be used when the data structure containing the exogenous regressors in each equations is the same (i.e., <code class="docutils literal notranslate"><span class="pre">id(exog)</span></code> is the same for all equations).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">exog</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span>
    <span class="n">fdata</span><span class="p">[</span>
        <span class="p">[</span>
            <span class="s2">&quot;educ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;exper&quot;</span><span class="p">,</span>
            <span class="s2">&quot;expersq&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tenure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tenuresq&quot;</span><span class="p">,</span>
            <span class="s2">&quot;union&quot;</span><span class="p">,</span>
            <span class="s2">&quot;south&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nrtheast&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nrthcen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;married&quot;</span><span class="p">,</span>
            <span class="s2">&quot;white&quot;</span><span class="p">,</span>
            <span class="s2">&quot;male&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">fmod_data</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">fmod_data</span><span class="p">[</span><span class="s2">&quot;hrearn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dependent&quot;</span><span class="p">:</span> <span class="n">fdata</span><span class="o">.</span><span class="n">hrearn</span><span class="p">,</span> <span class="s2">&quot;exog&quot;</span><span class="p">:</span> <span class="n">exog</span><span class="p">}</span>
<span class="n">fmod_data</span><span class="p">[</span><span class="s2">&quot;hrbens&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dependent&quot;</span><span class="p">:</span> <span class="n">fdata</span><span class="o">.</span><span class="n">hrbens</span><span class="p">,</span> <span class="s2">&quot;exog&quot;</span><span class="p">:</span> <span class="n">exog</span><span class="p">}</span>
<span class="n">fmod</span> <span class="o">=</span> <span class="n">SUR</span><span class="p">(</span><span class="n">fmod_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System OLS Estimation Summary
===================================================================================
Estimator:                        OLS   Overall R-squared:                   0.2087
No. Equations.:                     2   McElroy&#39;s R-squared:                 0.2926
No. Observations:                 616   Judge&#39;s (OLS) R-squared:             0.2087
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.4822
Time:                        17:54:28   Dhrymes&#39;s R-squared:                 0.2087
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.6321     1.2153    -2.1658     0.0303     -5.0141     -0.2502
educ           0.4588     0.0684     6.7085     0.0000      0.3248      0.5929
exper         -0.0758     0.0567    -1.3367     0.1813     -0.1870      0.0354
expersq        0.0040     0.0012     3.4274     0.0006      0.0017      0.0063
tenure         0.1101     0.0829     1.3276     0.1843     -0.0524      0.2726
tenuresq      -0.0051     0.0032    -1.5640     0.1178     -0.0114      0.0013
union          0.8080     0.4035     2.0026     0.0452      0.0172      1.5988
south         -0.4566     0.5459    -0.8365     0.4029     -1.5265      0.6132
nrtheast      -1.1508     0.5993    -1.9201     0.0548     -2.3254      0.0239
nrthcen       -0.6363     0.5501    -1.1565     0.2475     -1.7145      0.4420
married        0.6424     0.4134     1.5540     0.1202     -0.1678      1.4526
white          1.1409     0.6054     1.8844     0.0595     -0.0458      2.3275
male           1.7847     0.3938     4.5322     0.0000      1.0129      2.5565
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8897     0.1453    -6.1225     0.0000     -1.1746     -0.6049
educ           0.0768     0.0082     9.3896     0.0000      0.0608      0.0928
exper          0.0226     0.0068     3.3259     0.0009      0.0093      0.0359
expersq       -0.0005     0.0001    -3.3965     0.0007     -0.0007     -0.0002
tenure         0.0536     0.0099     5.4011     0.0000      0.0341      0.0730
tenuresq      -0.0012     0.0004    -3.0014     0.0027     -0.0019     -0.0004
union          0.3659     0.0482     7.5839     0.0000      0.2713      0.4605
south         -0.0227     0.0653    -0.3476     0.7282     -0.1506      0.1052
nrtheast      -0.0567     0.0717    -0.7918     0.4285     -0.1972      0.0837
nrthcen       -0.0380     0.0658    -0.5776     0.5635     -0.1669      0.0909
married        0.0579     0.0494     1.1706     0.2418     -0.0390      0.1547
white          0.0902     0.0724     1.2453     0.2130     -0.0517      0.2321
male           0.2683     0.0471     5.6985     0.0000      0.1760      0.3606
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: False)
</pre></div></div>
</div>
<p>The estimator can be forced to use GLS by setting <code class="docutils literal notranslate"><span class="pre">method=&quot;gls&quot;</span></code>. As can be seen below, the parameter estimates and standard errors do not change even though two-stage GLS is used. The <span class="math notranslate nohighlight">\(R^2\)</span> <strong>does change</strong> since the left-hand side variable is transformed by the GLS weighting before estimation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">fmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;gls&quot;</span><span class="p">,</span> <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.2087
No. Equations.:                     2   McElroy&#39;s R-squared:                 0.2926
No. Observations:                 616   Judge&#39;s (OLS) R-squared:             0.2087
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.4822
Time:                        17:54:28   Dhrymes&#39;s R-squared:                 0.2087
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.6321     1.2153    -2.1658     0.0303     -5.0141     -0.2502
educ           0.4588     0.0684     6.7085     0.0000      0.3248      0.5929
exper         -0.0758     0.0567    -1.3367     0.1813     -0.1870      0.0354
expersq        0.0040     0.0012     3.4274     0.0006      0.0017      0.0063
tenure         0.1101     0.0829     1.3276     0.1843     -0.0524      0.2726
tenuresq      -0.0051     0.0032    -1.5640     0.1178     -0.0114      0.0013
union          0.8080     0.4035     2.0026     0.0452      0.0172      1.5988
south         -0.4566     0.5459    -0.8365     0.4029     -1.5265      0.6132
nrtheast      -1.1508     0.5993    -1.9201     0.0548     -2.3254      0.0239
nrthcen       -0.6363     0.5501    -1.1565     0.2475     -1.7145      0.4420
married        0.6424     0.4134     1.5540     0.1202     -0.1678      1.4526
white          1.1409     0.6054     1.8844     0.0595     -0.0458      2.3275
male           1.7847     0.3938     4.5322     0.0000      1.0129      2.5565
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8897     0.1453    -6.1225     0.0000     -1.1746     -0.6049
educ           0.0768     0.0082     9.3896     0.0000      0.0608      0.0928
exper          0.0226     0.0068     3.3259     0.0009      0.0093      0.0359
expersq       -0.0005     0.0001    -3.3965     0.0007     -0.0007     -0.0002
tenure         0.0536     0.0099     5.4011     0.0000      0.0341      0.0730
tenuresq      -0.0012     0.0004    -3.0014     0.0027     -0.0019     -0.0004
union          0.3659     0.0482     7.5839     0.0000      0.2713      0.4605
south         -0.0227     0.0653    -0.3476     0.7282     -0.1506      0.1052
nrtheast      -0.0567     0.0717    -0.7918     0.4285     -0.1972      0.0837
nrthcen       -0.0380     0.0658    -0.5776     0.5635     -0.1669      0.0909
married        0.0579     0.0494     1.1706     0.2418     -0.0390      0.1547
white          0.0902     0.0724     1.2453     0.2130     -0.0517      0.2321
male           0.2683     0.0471     5.6985     0.0000      0.1760      0.3606
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div>
</div>
<p>The regressors must differ in order to see gains to GLS. Here insignificant variables are dropped from each equation so that the regressors will no longer be identical. The typical standard error is marginally smaller, although this might be due to dropping regressors.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">exog_earn</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span>
    <span class="n">fdata</span><span class="p">[[</span><span class="s2">&quot;educ&quot;</span><span class="p">,</span> <span class="s2">&quot;exper&quot;</span><span class="p">,</span> <span class="s2">&quot;expersq&quot;</span><span class="p">,</span> <span class="s2">&quot;union&quot;</span><span class="p">,</span> <span class="s2">&quot;nrtheast&quot;</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">exog_bens</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span>
    <span class="n">fdata</span><span class="p">[[</span><span class="s2">&quot;educ&quot;</span><span class="p">,</span> <span class="s2">&quot;exper&quot;</span><span class="p">,</span> <span class="s2">&quot;expersq&quot;</span><span class="p">,</span> <span class="s2">&quot;tenure&quot;</span><span class="p">,</span> <span class="s2">&quot;tenuresq&quot;</span><span class="p">,</span> <span class="s2">&quot;union&quot;</span><span class="p">,</span> <span class="s2">&quot;male&quot;</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">fmod_data</span><span class="p">[</span><span class="s2">&quot;hrearn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dependent&quot;</span><span class="p">:</span> <span class="n">fdata</span><span class="o">.</span><span class="n">hrearn</span><span class="p">,</span> <span class="s2">&quot;exog&quot;</span><span class="p">:</span> <span class="n">exog_earn</span><span class="p">}</span>
<span class="n">fmod_data</span><span class="p">[</span><span class="s2">&quot;hrbens&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dependent&quot;</span><span class="p">:</span> <span class="n">fdata</span><span class="o">.</span><span class="n">hrbens</span><span class="p">,</span> <span class="s2">&quot;exog&quot;</span><span class="p">:</span> <span class="n">exog_bens</span><span class="p">}</span>
<span class="n">fmod</span> <span class="o">=</span> <span class="n">SUR</span><span class="p">(</span><span class="n">fmod_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy&#39;s R-squared:                 0.2762
No. Observations:                 616   Judge&#39;s (OLS) R-squared:             0.1685
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.4504
Time:                        17:54:28   Dhrymes&#39;s R-squared:                 0.1685
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5240     1.0857    -2.3246     0.0201     -4.6520     -0.3959
educ           0.5000     0.0685     7.2987     0.0000      0.3657      0.6342
exper         -0.0212     0.0522    -0.4058     0.6849     -0.1234      0.0811
expersq        0.0032     0.0011     2.8776     0.0040      0.0010      0.0055
union          1.1043     0.3928     2.8116     0.0049      0.3345      1.8741
nrtheast      -0.5343     0.4305    -1.2411     0.2146     -1.3780      0.3095
white          1.1320     0.5845     1.9368     0.0528     -0.0136      2.2776
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8231     0.1176    -7.0021     0.0000     -1.0535     -0.5927
educ           0.0791     0.0080     9.8927     0.0000      0.0634      0.0948
exper          0.0260     0.0066     3.9114     0.0001      0.0130      0.0390
expersq       -0.0005     0.0001    -3.8469     0.0001     -0.0008     -0.0003
tenure         0.0494     0.0094     5.2409     0.0000      0.0309      0.0679
tenuresq      -0.0010     0.0004    -2.6275     0.0086     -0.0017     -0.0002
union          0.3766     0.0475     7.9259     0.0000      0.2835      0.4698
male           0.2141     0.0433     4.9413     0.0000      0.1292      0.2990
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div>
</div>
<p>The standard method to estimate models uses two steps. The first uses OLS to estimate the parameters so that the residual covariance can be estimated. The second stage uses the estimated covariance to estimate the model via GLS. Iterative GLS can be used to continue these iterations using the most recent step to estimate the residual covariance and then re-estimating the parameters using GLS. This option can be used by setting <code class="docutils literal notranslate"><span class="pre">iterate=True</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fmod_res</span> <span class="o">=</span> <span class="n">fmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmod_res</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                      System Iterative GLS Estimation Summary
===================================================================================
Estimator:              Iterative GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy&#39;s R-squared:                 0.2749
No. Observations:                 616   Judge&#39;s (OLS) R-squared:             0.1685
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.4532
Time:                        17:54:29   Dhrymes&#39;s R-squared:                 0.1685
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5147     1.0858    -2.3161     0.0206     -4.6428     -0.3867
educ           0.5001     0.0685     7.3004     0.0000      0.3658      0.6344
exper         -0.0211     0.0522    -0.4044     0.6859     -0.1233      0.0811
expersq        0.0032     0.0011     2.8760     0.0040      0.0010      0.0055
union          1.1043     0.3928     2.8115     0.0049      0.3345      1.8741
nrtheast      -0.5314     0.4305    -1.2342     0.2171     -1.3752      0.3124
white          1.1191     0.5845     1.9145     0.0556     -0.0266      2.2648
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8223     0.1176    -6.9947     0.0000     -1.0527     -0.5919
educ           0.0792     0.0080     9.9004     0.0000      0.0635      0.0948
exper          0.0260     0.0066     3.9213     0.0001      0.0130      0.0390
expersq       -0.0005     0.0001    -3.8528     0.0001     -0.0008     -0.0003
tenure         0.0492     0.0094     5.2189     0.0000      0.0307      0.0677
tenuresq      -0.0010     0.0004    -2.6025     0.0093     -0.0017     -0.0002
union          0.3771     0.0475     7.9364     0.0000      0.2840      0.4703
male           0.2107     0.0433     4.8627     0.0000      0.1258      0.2956
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div>
</div>
<p>The number of GLS iterations can be verified using the <code class="docutils literal notranslate"><span class="pre">iterations</span></code> attribute of the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fmod_res</span><span class="o">.</span><span class="n">iterations</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5
</pre></div></div>
</div>
<h3 id="Alternative-Covariance-Estimators">Alternative Covariance Estimators<a class="headerlink" href="#Alternative-Covariance-Estimators" title="Link to this heading">¶</a></h3>
<p>The estimator supports heteroskedasticity robust covariance estimation b setting <code class="docutils literal notranslate"><span class="pre">cov_type=&quot;robust&quot;</span></code>. The estimator allows for arbitrary correlation across series with the same time index but not correlation across time periods, which is the same assumption as in the unadjusted estimator. The main difference is that this estimator will correct standard errors for dependence between regressors (or squared regressors) and squared residuals.</p>
<h4 id="Heteroskedasticity-Robust-Covariance-Estimation">Heteroskedasticity Robust Covariance Estimation<a class="headerlink" href="#Heteroskedasticity-Robust-Covariance-Estimation" title="Link to this heading">¶</a></h4>
<p>In the fringe benefit model there are some large differences between standard errors computed using the the homoskedastic covariance estimator and the heteroskedasticity robust covariance estimator (e.g., <code class="docutils literal notranslate"><span class="pre">exper</span></code>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fres_het</span> <span class="o">=</span> <span class="n">fmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;robust&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fres_het</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy&#39;s R-squared:                 0.2762
No. Observations:                 616   Judge&#39;s (OLS) R-squared:             0.1685
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.4504
Time:                        17:54:29   Dhrymes&#39;s R-squared:                 0.1685
                                        Cov. Estimator:                      robust
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5240     0.8703    -2.9002     0.0037     -4.2297     -0.8183
educ           0.5000     0.0809     6.1765     0.0000      0.3413      0.6586
exper         -0.0212     0.2270    -0.0932     0.9257     -0.4661      0.4237
expersq        0.0032     0.0059     0.5507     0.5819     -0.0083      0.0148
union          1.1043     0.2857     3.8647     0.0001      0.5443      1.6644
nrtheast      -0.5343     0.5273    -1.0132     0.3110     -1.5678      0.4992
white          1.1320     0.4921     2.3002     0.0214      0.1674      2.0966
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8231     0.1082    -7.6087     0.0000     -1.0352     -0.6111
educ           0.0791     0.0081     9.7768     0.0000      0.0632      0.0949
exper          0.0260     0.0059     4.3675     0.0000      0.0143      0.0376
expersq       -0.0005     0.0001    -4.2494     0.0000     -0.0008     -0.0003
tenure         0.0494     0.0097     5.0775     0.0000      0.0303      0.0685
tenuresq      -0.0010     0.0004    -2.4121     0.0159     -0.0018     -0.0002
union          0.3766     0.0514     7.3342     0.0000      0.2760      0.4773
male           0.2141     0.0397     5.3975     0.0000      0.1363      0.2918
==============================================================================

Covariance Estimator:
Heteroskedastic (Robust) Covariance (Debiased: False, GLS: True)
</pre></div></div>
</div>
<p>Other supported covariance estimators include <code class="docutils literal notranslate"><span class="pre">&quot;kernel</span></code>” which implements a HAC and <code class="docutils literal notranslate"><span class="pre">&quot;clustered&quot;</span></code> which supports 1 and 2-way clustering.</p>
<h4 id="Kernel-(HAC)">Kernel (HAC)<a class="headerlink" href="#Kernel-(HAC)" title="Link to this heading">¶</a></h4>
<p>The supported kernels are <code class="docutils literal notranslate"><span class="pre">&quot;bartlett&quot;</span></code> (Newey-West), <code class="docutils literal notranslate"><span class="pre">&quot;parzen&quot;</span></code> (Gallant), and <code class="docutils literal notranslate"><span class="pre">qs</span></code> (Quadratic Spectral, Andrews). This example uses the Parzen kernel. The kernel’s bandwidth is computed automatically if the parameter <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code> is not provided.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">hac_res</span> <span class="o">=</span> <span class="n">fmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;kernel&quot;</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;parzen&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hac_res</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy&#39;s R-squared:                 0.2762
No. Observations:                 616   Judge&#39;s (OLS) R-squared:             0.1685
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.4504
Time:                        17:54:29   Dhrymes&#39;s R-squared:                 0.1685
                                        Cov. Estimator:                      kernel
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5240     1.0048    -2.5120     0.0120     -4.4933     -0.5547
educ           0.5000     0.0973     5.1391     0.0000      0.3093      0.6907
exper         -0.0212     0.2287    -0.0925     0.9263     -0.4694      0.4270
expersq        0.0032     0.0059     0.5486     0.5833     -0.0084      0.0148
union          1.1043     0.2637     4.1882     0.0000      0.5875      1.6211
nrtheast      -0.5343     0.4800    -1.1131     0.2657     -1.4750      0.4065
white          1.1320     0.4813     2.3520     0.0187      0.1887      2.0753
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8231     0.1344    -6.1228     0.0000     -1.0866     -0.5596
educ           0.0791     0.0095     8.3675     0.0000      0.0606      0.0976
exper          0.0260     0.0064     4.0357     0.0001      0.0134      0.0386
expersq       -0.0005     0.0001    -3.9026     0.0001     -0.0008     -0.0003
tenure         0.0494     0.0090     5.5160     0.0000      0.0318      0.0669
tenuresq      -0.0010     0.0003    -2.9161     0.0035     -0.0016     -0.0003
union          0.3766     0.0705     5.3407     0.0000      0.2384      0.5148
male           0.2141     0.0577     3.7117     0.0002      0.1010      0.3271
==============================================================================

Covariance Estimator:
Kernel (HAC) Covariance (Debiased: False, GLS: True, Kernel: parzen)
</pre></div></div>
</div>
<h4 id="Clustered-(Rogers)">Clustered (Rogers)<a class="headerlink" href="#Clustered-(Rogers)" title="Link to this heading">¶</a></h4>
<p>The clustered covariance estimator requires the clusters to be entered as a NumPy array with shape <code class="docutils literal notranslate"><span class="pre">(nobs,</span> <span class="pre">1)</span></code> or <code class="docutils literal notranslate"><span class="pre">(nobs,</span> <span class="pre">2)</span></code>. This example uses random clusters to illustrate the structure of the group id variable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">([</span><span class="mi">983476381</span><span class="p">,</span> <span class="mi">28390328</span><span class="p">,</span> <span class="mi">23829810</span><span class="p">])</span>
<span class="n">random_clusters</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">616</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">clustered_res</span> <span class="o">=</span> <span class="n">fmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;clustered&quot;</span><span class="p">,</span> <span class="n">clusters</span><span class="o">=</span><span class="n">random_clusters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">clustered_res</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy&#39;s R-squared:                 0.2762
No. Observations:                 616   Judge&#39;s (OLS) R-squared:             0.1685
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.4504
Time:                        17:54:29   Dhrymes&#39;s R-squared:                 0.1685
                                        Cov. Estimator:                   clustered
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5240     0.8501    -2.9692     0.0030     -4.1901     -0.8579
educ           0.5000     0.0804     6.2174     0.0000      0.3424      0.6576
exper         -0.0212     0.2285    -0.0926     0.9262     -0.4690      0.4267
expersq        0.0032     0.0059     0.5479     0.5837     -0.0084      0.0149
union          1.1043     0.2696     4.0963     0.0000      0.5759      1.6327
nrtheast      -0.5343     0.5181    -1.0312     0.3024     -1.5497      0.4812
white          1.1320     0.4701     2.4083     0.0160      0.2107      2.0533
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8231     0.1077    -7.6435     0.0000     -1.0342     -0.6121
educ           0.0791     0.0080     9.8547     0.0000      0.0634      0.0948
exper          0.0260     0.0059     4.4288     0.0000      0.0145      0.0375
expersq       -0.0005     0.0001    -4.6793     0.0000     -0.0007     -0.0003
tenure         0.0494     0.0105     4.7036     0.0000      0.0288      0.0700
tenuresq      -0.0010     0.0004    -2.2777     0.0227     -0.0018     -0.0001
union          0.3766     0.0525     7.1717     0.0000      0.2737      0.4795
male           0.2141     0.0317     6.7496     0.0000      0.1519      0.2762
==============================================================================

Covariance Estimator:
Heteroskedastic (Robust) Covariance (Debiased: False, GLS: True, Number of Grouping Variables: 1, Number of Groups: 51 (Variable 0), Group Debias: False)
</pre></div></div>
</div>
<h2 id="Prespecified-Residual-Covariance-Estimators">Prespecified Residual Covariance Estimators<a class="headerlink" href="#Prespecified-Residual-Covariance-Estimators" title="Link to this heading">¶</a></h2>
<p>The GLS estimator can be used with a user specified covariance. This example uses a covariance where all correlations are identical (equicorrelation) in the state GDP model. The estimator must be used when constructing the model through the <code class="docutils literal notranslate"><span class="pre">sigma</span></code> keyword argument.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">avg_corr</span> <span class="o">=</span> <span class="p">(</span><span class="n">corr</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">81</span> <span class="o">/</span> <span class="mi">72</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span> <span class="o">*</span> <span class="n">avg_corr</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">avg_corr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="n">sigma_pre</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="n">std</span> <span class="o">@</span> <span class="n">std</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">mod_pre_sigma</span> <span class="o">=</span> <span class="n">SUR</span><span class="p">(</span><span class="n">mod_data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_pre</span><span class="p">)</span>
<span class="n">res_pre</span> <span class="o">=</span> <span class="n">mod_pre_sigma</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">,</span> <span class="n">debiased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_pre</span><span class="o">.</span><span class="n">equations</span><span class="p">[</span><span class="s2">&quot;GF&quot;</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            GLS Estimation Summary
==============================================================================
Eq. Label:                         GF   R-squared:                      0.9966
Dep. Variable:                  lnGSP   Adj. R-squared:                 0.9945
Estimator:                        GLS   Cov. Estimator:             unadjusted
No. Observations:                  17   F-statistic:                    549.95
Date:                Fri, Jul 19 2024   P-value (F-stat)                0.0000
Time:                        17:54:29   Distribution:                  F(6,90)

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      7.9753     4.3819     1.8200     0.0988     -1.7883      17.739
lnPC           0.1011     0.2727     0.3708     0.7185     -0.5065      0.7087
lnHWY         -0.9882     1.0313    -0.9582     0.3606     -3.2862      1.3098
lnWATER        0.0791     0.1134     0.6971     0.5016     -0.1736      0.3318
lnUTIL         0.5160     0.7720     0.6685     0.5190     -1.2040      2.2361
lnEMP          0.8494     0.1426     5.9557     0.0001      0.5316      1.1671
UNEMP         -0.0057     0.0034    -1.6466     0.1307     -0.0134      0.0020

==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: True, GLS: True)
</pre></div></div>
</div>
<h3 id="Diagonal-Residual-Covariance">Diagonal Residual Covariance<a class="headerlink" href="#Diagonal-Residual-Covariance" title="Link to this heading">¶</a></h3>
<p>The default assumption is that there can be arbitrary correlation between series. The model can be estimated assuming no correlation but different variance by setting the keyword argument <code class="docutils literal notranslate"><span class="pre">full_cov=False</span></code> in the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method. This is only useful when there are cross-equation parameter restrictions.</p>
<h2 id="Cross-Equation-Restrictions">Cross-Equation Restrictions<a class="headerlink" href="#Cross-Equation-Restrictions" title="Link to this heading">¶</a></h2>
<p>One of the more useful features of using a SUR to estimate a system is the ability to impose constraints on parameters across equations. Here only linear constraints of the form</p>
<div class="math notranslate nohighlight">
\[r \beta = q\]</div>
<p>are supported. Linear constraints are entered by passing a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with the shape number of constraints by number of parameters. The number and name of parameters can be seen by inspecting the <code class="docutils literal notranslate"><span class="pre">param_names</span></code> attribute of a model. Below are the parameter names from the state GDP model which consist of the equation label, an underscore, and the variable name. This ensures uniqueness.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mod</span><span class="o">.</span><span class="n">param_names</span><span class="p">[:</span><span class="mi">14</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;GF_Intercept&#39;,
 &#39;GF_lnPC&#39;,
 &#39;GF_lnHWY&#39;,
 &#39;GF_lnWATER&#39;,
 &#39;GF_lnUTIL&#39;,
 &#39;GF_lnEMP&#39;,
 &#39;GF_UNEMP&#39;,
 &#39;SW_Intercept&#39;,
 &#39;SW_lnPC&#39;,
 &#39;SW_lnHWY&#39;,
 &#39;SW_lnWATER&#39;,
 &#39;SW_lnUTIL&#39;,
 &#39;SW_lnEMP&#39;,
 &#39;SW_UNEMP&#39;]
</pre></div></div>
</div>
<p>The example of a parameter constraint will enforce a common value of the coefficient of unemployment in all equations. This restriction takes the form</p>
<div class="math notranslate nohighlight">
\[\beta_{unemp,i} - \beta_{unemp,j} = 0\]</div>
<p>where in all examples i is the first series and j is one of the 8 others. In total there are 8 restrictions.</p>
<p>The construction of the restriction array and the non-zero columns are shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">r</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">mod</span><span class="o">.</span><span class="n">param_names</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rest</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">r</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
<span class="n">r</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">13</span><span class="p">::</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">::</span><span class="mi">7</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
       GF_UNEMP  SW_UNEMP  WC_UNEMP  MT_UNEMP  NE_UNEMP  MA_UNEMP  SO_UNEMP  \
rest0      -1.0       1.0       0.0       0.0       0.0       0.0       0.0
rest1      -1.0       0.0       1.0       0.0       0.0       0.0       0.0
rest2      -1.0       0.0       0.0       1.0       0.0       0.0       0.0
rest3      -1.0       0.0       0.0       0.0       1.0       0.0       0.0
rest4      -1.0       0.0       0.0       0.0       0.0       1.0       0.0
rest5      -1.0       0.0       0.0       0.0       0.0       0.0       1.0
rest6      -1.0       0.0       0.0       0.0       0.0       0.0       0.0
rest7      -1.0       0.0       0.0       0.0       0.0       0.0       0.0

       MW_UNEMP  CN_UNEMP
rest0       0.0       0.0
rest1       0.0       0.0
rest2       0.0       0.0
rest3       0.0       0.0
rest4       0.0       0.0
rest5       0.0       0.0
rest6       1.0       0.0
rest7       0.0       1.0
</pre></div></div>
</div>
<p>The constraint can be added to an existing model using the <code class="docutils literal notranslate"><span class="pre">add_constraint</span></code> method. This method requires one input, <code class="docutils literal notranslate"><span class="pre">r</span></code> and optionally <code class="docutils literal notranslate"><span class="pre">q</span></code>. if <code class="docutils literal notranslate"><span class="pre">q</span></code> is not provided, it is set to 0.</p>
<p>Here the constraint is added, the model is estimated, and the parameters for unemployment are displayed. They all have the same value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mod</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="n">constrained_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">constrained_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">6</span><span class="p">::</span><span class="mi">7</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
GF_UNEMP   -0.005801
SW_UNEMP   -0.005801
WC_UNEMP   -0.005801
MT_UNEMP   -0.005801
NE_UNEMP   -0.005801
MA_UNEMP   -0.005801
SO_UNEMP   -0.005801
MW_UNEMP   -0.005801
CN_UNEMP   -0.005801
Name: params, dtype: float64
</pre></div></div>
</div>
<h3 id="Pooling-using-constraints">Pooling using constraints<a class="headerlink" href="#Pooling-using-constraints" title="Link to this heading">¶</a></h3>
<p>More complicated constraints can be used to produce interesting models. Using the same idea as the previous set of constraints, a pooled SUR (excluding the constant) is constructed by restricting all coefficients to have the same value. Here the form of the restriction is</p>
<div class="math notranslate nohighlight">
\[\beta_{var,0} - \beta_{var,j} = 0\]</div>
<p>so that the restriction is identical to the previous, only applied to all variables excluding the constant.</p>
<p>Here the estimated from the first two equations are shown. All coefficients except the intercept are identical across equations.</p>
<p><strong>Note</strong>: When linear constraints are imposed, the parameter covariance matrix will be singular. Caution is needed to ensure test statistics are meaningful.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[28]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">r2</span><span class="p">[</span><span class="n">loc</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="n">r2</span><span class="p">[</span><span class="n">loc</span><span class="p">,</span> <span class="mi">7</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">loc</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">mod</span><span class="o">.</span><span class="n">param_names</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">reset_constraints</span><span class="p">()</span>
<span class="n">mod</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
<span class="n">pooled_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pooled_res</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">as_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[:</span><span class="mi">33</span><span class="p">]))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.9777
No. Equations.:                     9   McElroy&#39;s R-squared:                 0.9891
No. Observations:                  17   Judge&#39;s (OLS) R-squared:             0.9777
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.9974
Time:                        17:54:29   Dhrymes&#39;s R-squared:                 0.9777
                                        Cov. Estimator:                      robust
                                        Num. Constraints:                        48
                   Equation: GF, Dependent Variable: lnGSP
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      0.2732     0.2159     1.2656     0.2057     -0.1499      0.6963
lnPC           0.3639     0.0205     17.763     0.0000      0.3238      0.4041
lnHWY          0.3103     0.0279     11.141     0.0000      0.2557      0.3649
lnWATER        0.0805     0.0109     7.3615     0.0000      0.0591      0.1020
lnUTIL        -0.1733     0.0166    -10.466     0.0000     -0.2057     -0.1408
lnEMP          0.6142     0.0248     24.752     0.0000      0.5655      0.6628
UNEMP         -0.0128     0.0006    -22.939     0.0000     -0.0139     -0.0117
                   Equation: SW, Dependent Variable: lnGSP
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      0.2869     0.2201     1.3034     0.1924     -0.1445      0.7183
lnPC           0.3639     0.0205     17.763     0.0000      0.3238      0.4041
lnHWY          0.3103     0.0279     11.141     0.0000      0.2557      0.3649
lnWATER        0.0805     0.0109     7.3615     0.0000      0.0591      0.1020
lnUTIL        -0.1733     0.0166    -10.466     0.0000     -0.2057     -0.1408
lnEMP          0.6142     0.0248     24.752     0.0000      0.5655      0.6628
UNEMP         -0.0128     0.0006    -22.939     0.0000     -0.0139     -0.0117
                   Equation: WC, Dependent Variable: lnGSP
==============================================================================
</pre></div></div>
</div>
<h2 id="Multivariate-OLS">Multivariate OLS<a class="headerlink" href="#Multivariate-OLS" title="Link to this heading">¶</a></h2>
<p>One final feature worth demonstrating is a simple interface for specifying multivariate OLS models. These models have the same regressors and so it is possible to specify them with two arrays. The first is a <span class="math notranslate nohighlight">\(T\)</span> by <span class="math notranslate nohighlight">\(K\)</span> array of dependent variables where each column contains a dependent variable. The second contains the common exogenous regressors.</p>
<p>This example shows how a CAPM can be estimated as a MV OLS.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">linearmodels.datasets</span> <span class="kn">import</span> <span class="n">french</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">french</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">factors</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;MktRF&quot;</span><span class="p">]])</span>
<span class="n">mv_ols</span> <span class="o">=</span> <span class="n">SUR</span><span class="o">.</span><span class="n">multivariate_ls</span><span class="p">(</span>
    <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;S1V1&quot;</span><span class="p">,</span> <span class="s2">&quot;S1V3&quot;</span><span class="p">,</span> <span class="s2">&quot;S1V5&quot;</span><span class="p">,</span> <span class="s2">&quot;S5V1&quot;</span><span class="p">,</span> <span class="s2">&quot;S5V3&quot;</span><span class="p">,</span> <span class="s2">&quot;S5V5&quot;</span><span class="p">]],</span> <span class="n">factors</span>
<span class="p">)</span>
<span class="n">mv_ols_res</span> <span class="o">=</span> <span class="n">mv_ols</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mv_ols_res</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System OLS Estimation Summary
===================================================================================
Estimator:                        OLS   Overall R-squared:                   0.6564
No. Equations.:                     6   McElroy&#39;s R-squared:                 0.8776
No. Observations:                 819   Judge&#39;s (OLS) R-squared:             0.6564
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.9773
Time:                        17:54:29   Dhrymes&#39;s R-squared:                 0.6564
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                   Equation: S1V1, Dependent Variable: S1V1
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.0020     0.0017    -1.1608     0.2457     -0.0054      0.0014
MktRF          1.3736     0.0403     34.101     0.0000      1.2947      1.4526
                   Equation: S1V3, Dependent Variable: S1V3
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0048     0.0012     4.0973     0.0000      0.0025      0.0072
MktRF          1.0711     0.0276     38.879     0.0000      1.0171      1.1251
                   Equation: S1V5, Dependent Variable: S1V5
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0082     0.0013     6.5142     0.0000      0.0057      0.0106
MktRF          1.0538     0.0293     36.019     0.0000      0.9965      1.1111
                   Equation: S5V1, Dependent Variable: S5V1
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0032     0.0005     5.8787     0.0000      0.0021      0.0042
MktRF          0.9861     0.0126     78.376     0.0000      0.9615      1.0108
                   Equation: S5V3, Dependent Variable: S5V3
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0052     0.0007     7.4953     0.0000      0.0039      0.0066
MktRF          0.8472     0.0162     52.204     0.0000      0.8154      0.8790
                   Equation: S5V5, Dependent Variable: S5V5
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0051     0.0011     4.5167     0.0000      0.0029      0.0073
MktRF          0.9851     0.0263     37.515     0.0000      0.9337      1.0366
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: False)
</pre></div></div>
</div>
<h3 id="Using-GLS-with-common-regressors">Using GLS with common regressors<a class="headerlink" href="#Using-GLS-with-common-regressors" title="Link to this heading">¶</a></h3>
<p>As noted previously, forcing GLS has no effect (except on changing the <span class="math notranslate nohighlight">\(R^2\)</span>). This can be seen below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[30]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">mv_ols</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;unadjusted&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;gls&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.6564
No. Equations.:                     6   McElroy&#39;s R-squared:                 0.8776
No. Observations:                 819   Judge&#39;s (OLS) R-squared:             0.6564
Date:                Fri, Jul 19 2024   Berndt&#39;s R-squared:                  0.9773
Time:                        17:54:29   Dhrymes&#39;s R-squared:                 0.6564
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                   Equation: S1V1, Dependent Variable: S1V1
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.0020     0.0017    -1.1608     0.2457     -0.0054      0.0014
MktRF          1.3736     0.0403     34.101     0.0000      1.2947      1.4526
                   Equation: S1V3, Dependent Variable: S1V3
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0048     0.0012     4.0973     0.0000      0.0025      0.0072
MktRF          1.0711     0.0276     38.879     0.0000      1.0171      1.1251
                   Equation: S1V5, Dependent Variable: S1V5
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0082     0.0013     6.5142     0.0000      0.0057      0.0106
MktRF          1.0538     0.0293     36.019     0.0000      0.9965      1.1111
                   Equation: S5V1, Dependent Variable: S5V1
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0032     0.0005     5.8787     0.0000      0.0021      0.0042
MktRF          0.9861     0.0126     78.376     0.0000      0.9615      1.0108
                   Equation: S5V3, Dependent Variable: S5V3
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0052     0.0007     7.4953     0.0000      0.0039      0.0066
MktRF          0.8472     0.0162     52.204     0.0000      0.8154      0.8790
                   Equation: S5V5, Dependent Variable: S5V5
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0051     0.0011     4.5167     0.0000      0.0029      0.0073
MktRF          0.9851     0.0263     37.515     0.0000      0.9337      1.0366
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div>
</div>






                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../index.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: System Regression Models" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              System Regression Models
            </div>
          </div>
        </a>
      
      
        
        <a href="formulas.html" class="md-footer__link md-footer__link--next" aria-label="Next: Using formulas to specify models" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Using formulas to specify models
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2021, Kevin Sheppard.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.4.6.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/bashtage/linearmodels" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://pypi.org/project/linearmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.2591973" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216z"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike", "staticVersions": [{"aliases": [], "title": "Release", "version": "https://bashtage.github.io/linearmodels"}, {"aliases": [], "title": "Development", "version": "https://bashtage.github.io/linearmodels/devel"}], "versionPath": null}}</script>
    
      
        <script src="../../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js?v=8ec58cb5"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>