<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml"> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../../_static/javascripts/modernizr.js"></script> <title>Examples &#8212; linearmodels 4.17+6.g556bde7 documentation</title> <link rel=apple-touch-icon  sizes=180x180  href="../../_static/icons/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="../../_static/icons/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="../../_static/icons/favicon-16x16.png"> <link rel=manifest  href="../../_static/icons/site.webmanifest"> <link rel=mask-icon  href="../../_static/icons/safari-pinned-tab.svg" color="#2196f3"> <link rel="shortcut icon" href="../../_static/icons/favicon.ico"> <meta name=msapplication-TileColor  content="#f8f8f8"> <meta name=msapplication-config  content="../../_static/icons/browserconfig.xml"> <style> .highlight { background-color: hsla(0,0%,92.5%,.5) !important; } </style> <link rel=stylesheet  href="../../_static/material.css" type="text/css" /> <link rel=stylesheet  href="../../_static/pygments.css" type="text/css" /> <script id=documentation_options  data-url_root="../../" src="../../_static/documentation_options.js"></script> <script src="../../_static/jquery.js"></script> <script src="../../_static/underscore.js"></script> <script src="../../_static/doctools.js"></script> <script src="../../_static/language_data.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script async=async  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script> <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script> <link rel="shortcut icon" href="../../_static/favicon.ico"/> <link rel=index  title=Index  href="../../genindex.html" /> <link rel=search  title=Search  href="../../search.html" /> <link rel=next  title="Using formulas to specify models" href=formulas.html  /> <link rel=prev  title="System Regression Models" href="../index.html" /> <script src="../../_static/javascripts/version_dropdown.js"></script> <script> var json_loc = "../../"versions.json"", target_loc = "../../../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> <body dir=ltr data-md-color-primary=blue data-md-color-accent=orange> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#system/examples/examples" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../../index.html" title="linearmodels 4.17+6.g556bde7 documentation" class="md-header-nav__button md-logo"> <img src="../../_static/bw-logo.svg" height=26  alt="linearmodels 4.17+6.g556bde7 documentation logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >linearmodels 4.17 (+6)</span> <span class=md-header-nav__topic > Examples </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../../search.html" method=GET  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> </div> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href="../index.html" class=md-tabs__link >System Regression Models</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../../index.html" title="linearmodels 4.17+6.g556bde7 documentation" class="md-nav__button md-logo"> <img src="../../_static/bw-logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../../index.html" title="linearmodels 4.17+6.g556bde7 documentation">linearmodels 4.17 (+6)</a> </label> <div class=md-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <a href="../../iv/index.html" class=md-nav__link >Instrumental Variable Estimation</a> <li class=md-nav__item > <a href="../../panel/index.html" class=md-nav__link >Panel Data Model Estimation</a> <li class=md-nav__item > <a href="../../asset-pricing/index.html" class=md-nav__link >Linear Factor Models for Asset Pricing</a> <li class=md-nav__item > <a href="../index.html" class=md-nav__link >System Regression Models</a> <ul class=md-nav__list > <li class=md-nav__item > <input class="md-toggle md-nav__toggle" data-md-toggle=toc  type=checkbox  id=__toc > <label class="md-nav__link md-nav__link--active" for=__toc > Examples </label> <a href="#" class="md-nav__link md-nav__link--active">Examples</a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#system-examples-examples--page-root" class=md-nav__link >Examples</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Data" class=md-nav__link >Data</a> <li class=md-nav__item ><a href="#Basic-Usage" class=md-nav__link >Basic Usage</a> <li class=md-nav__item ><a href="#Estimation-Options" class=md-nav__link >Estimation Options</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Iterative-GLS" class=md-nav__link >Iterative GLS</a> <li class=md-nav__item ><a href="#Alternative-Covariance-Estimators" class=md-nav__link >Alternative Covariance Estimators</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Heteroskedasticity-Robust-Covariance-Estimation" class=md-nav__link >Heteroskedasticity Robust Covariance Estimation</a> <li class=md-nav__item ><a href="#Kernel-(HAC)" class=md-nav__link >Kernel (HAC)</a> <li class=md-nav__item ><a href="#Clustered-(Rogers)" class=md-nav__link >Clustered (Rogers)</a> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a href="#Prespecified-Residual-Covariance-Estimators" class=md-nav__link >Prespecified Residual Covariance Estimators</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Diagonal-Residual-Covariance" class=md-nav__link >Diagonal Residual Covariance</a> </ul> </nav> <li class=md-nav__item ><a href="#Cross-Equation-Restrictions" class=md-nav__link >Cross-Equation Restrictions</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Pooling-using-constraints" class=md-nav__link >Pooling using constraints</a> </ul> </nav> <li class=md-nav__item ><a href="#Multivariate-OLS" class=md-nav__link >Multivariate OLS</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Using-GLS-with-common-regressors" class=md-nav__link >Using GLS with common regressors</a> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../../_sources/system/examples/examples.ipynb.txt">Show Source</a> </ul> </nav> <li class=md-nav__item > <a href=formulas.html  class=md-nav__link >Using formulas to specify models</a> <li class=md-nav__item > <a href=three-stage-ls.html  class=md-nav__link >Three-stage Least Squares (3SLS)</a> <li class=md-nav__item > <a href="three-stage-ls.html#System-GMM-Estimation" class=md-nav__link >System GMM Estimation</a> <li class=md-nav__item > <a href="../reference.html" class=md-nav__link >Module Reference</a> <li class=md-nav__item > <a href="../mathematical-formula.html" class=md-nav__link >Seemingly Unrelated Regression (SUR/SURE)</a> <li class=md-nav__item > <a href="../mathematical-formula.html#covariance-estimation" class=md-nav__link >Covariance Estimation</a> <li class=md-nav__item > <a href="../mathematical-formula.html#memory-efficient-calculations" class=md-nav__link >Memory efficient calculations</a> <li class=md-nav__item > <a href="../mathematical-formula.html#three-stage-least-squares-3sls" class=md-nav__link >Three Stage Least Squares (3SLS)</a> <li class=md-nav__item > <a href="../mathematical-formula.html#system-generalized-method-of-moments-gmm" class=md-nav__link >System Generalized Method of Moments (GMM)</a> <li class=md-nav__item > <a href="../mathematical-formula.html#system-measures-of-fit-r-2" class=md-nav__link >System Measures of Fit (<span class="math notranslate nohighlight">\(R^{2}\)</span>)</a> </ul> <li class=md-nav__item > <a href="../../utility.html" class=md-nav__link >Utilities</a> <li class=md-nav__item > <a href="../../plan.html" class=md-nav__link >Module Plans</a> <li class=md-nav__item > <a href="../../contributing.html" class=md-nav__link >Contributing</a> <li class=md-nav__item > <a href="../../changes.html" class=md-nav__link >Change Log</a> <li class=md-nav__item > <a href="../../references.html" class=md-nav__link >References</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#system-examples-examples--page-root" class=md-nav__link >Examples</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Data" class=md-nav__link >Data</a> <li class=md-nav__item ><a href="#Basic-Usage" class=md-nav__link >Basic Usage</a> <li class=md-nav__item ><a href="#Estimation-Options" class=md-nav__link >Estimation Options</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Iterative-GLS" class=md-nav__link >Iterative GLS</a> <li class=md-nav__item ><a href="#Alternative-Covariance-Estimators" class=md-nav__link >Alternative Covariance Estimators</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Heteroskedasticity-Robust-Covariance-Estimation" class=md-nav__link >Heteroskedasticity Robust Covariance Estimation</a> <li class=md-nav__item ><a href="#Kernel-(HAC)" class=md-nav__link >Kernel (HAC)</a> <li class=md-nav__item ><a href="#Clustered-(Rogers)" class=md-nav__link >Clustered (Rogers)</a> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a href="#Prespecified-Residual-Covariance-Estimators" class=md-nav__link >Prespecified Residual Covariance Estimators</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Diagonal-Residual-Covariance" class=md-nav__link >Diagonal Residual Covariance</a> </ul> </nav> <li class=md-nav__item ><a href="#Cross-Equation-Restrictions" class=md-nav__link >Cross-Equation Restrictions</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Pooling-using-constraints" class=md-nav__link >Pooling using constraints</a> </ul> </nav> <li class=md-nav__item ><a href="#Multivariate-OLS" class=md-nav__link >Multivariate OLS</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Using-GLS-with-common-regressors" class=md-nav__link >Using GLS with common regressors</a> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../../_sources/system/examples/examples.ipynb.txt">Show Source</a> <li id=searchbox  class=md-nav__item > </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <style> /* CSS for nbsphinx extension */ /* remove conflicting styling from Sphinx themes */ div.nbinput.container, div.nbinput.container div.prompt, div.nbinput.container div.input_area, div.nbinput.container div[class*=highlight], div.nbinput.container div[class*=highlight] pre, div.nboutput.container, div.nboutput.container div.prompt, div.nboutput.container div.output_area, div.nboutput.container div[class*=highlight], div.nboutput.container div[class*=highlight] pre { background: none; border: none; padding: 0 0; margin: 0; box-shadow: none; } /* avoid gaps between output lines */ div.nboutput.container div[class*=highlight] pre { line-height: normal; } /* input/output containers */ div.nbinput.container, div.nboutput.container { display: -webkit-flex; display: flex; align-items: flex-start; margin: 0; width: 100%; } @media (max-width: 540px) { div.nbinput.container, div.nboutput.container { flex-direction: column; } } /* input container */ div.nbinput.container { padding-top: 5px; } /* last container */ div.nblast.container { padding-bottom: 5px; } /* input prompt */ div.nbinput.container div.prompt pre { color: #307FC1; } /* output prompt */ div.nboutput.container div.prompt pre { color: #BF5B3D; } /* all prompts */ div.nbinput.container div.prompt, div.nboutput.container div.prompt { min-width: 5.5ex; padding-top: 0.3rem; padding-right: 0.3rem; text-align: right; flex: 0; } @media (max-width: 540px) { div.nbinput.container div.prompt, div.nboutput.container div.prompt { text-align: left; padding: 0.4em; } div.nboutput.container div.prompt.empty { padding: 0; } } /* disable scrollbars on prompts */ div.nbinput.container div.prompt pre, div.nboutput.container div.prompt pre { overflow: hidden; } /* input/output area */ div.nbinput.container div.input_area, div.nboutput.container div.output_area { -webkit-flex: 1; flex: 1; overflow: auto; } @media (max-width: 540px) { div.nbinput.container div.input_area, div.nboutput.container div.output_area { width: 100%; } } /* input area */ div.nbinput.container div.input_area { border: 1px solid #e0e0e0; border-radius: 2px; background: #f5f5f5; } /* override MathJax center alignment in output cells */ div.nboutput.container div[class*=MathJax] { text-align: left !important; } /* override sphinx.ext.imgmath center alignment in output cells */ div.nboutput.container div.math p { text-align: left; } /* standard error */ div.nboutput.container div.output_area.stderr { background: #fdd; } /* ANSI colors */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } div.nbinput.container div.input_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight].math, div.nboutput.container div.output_area.rendered_html, div.nboutput.container div.output_area > div.output_javascript, div.nboutput.container div.output_area:not(.rendered_html) > img{ padding: 0.3rem; } /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */ div.nbinput.container div.input_area > div[class^='highlight'], div.nboutput.container div.output_area > div[class^='highlight']{ overflow-y: hidden; } /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */ .prompt a.copybtn { display: none; } /* Some additional styling taken form the Jupyter notebook CSS */ div.rendered_html table { border: none; border-collapse: collapse; border-spacing: 0; color: black; font-size: 12px; table-layout: fixed; } div.rendered_html thead { border-bottom: 1px solid black; vertical-align: bottom; } div.rendered_html tr, div.rendered_html th, div.rendered_html td { text-align: right; vertical-align: middle; padding: 0.5em 0.5em; line-height: normal; white-space: normal; max-width: none; border: none; } div.rendered_html th { font-weight: bold; } div.rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } div.rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } </style> <h1 id=system-examples-examples--page-root >Examples<a class=headerlink  href="#system-examples-examples--page-root" title="Permalink to this headline">¶</a></h1> <p>System regression simultaneously estimates multiple models. This has three distinct advantages:</p> <ul class=simple > <li><p>Joint inference across models</p> <li><p>Linear restrictions can be imposed on the parameters across different models</p> <li><p>Improved precision of parameter estimates (depending on the model specification and data)</p> </ul> <p>There are <span class="math notranslate nohighlight">\(K\)</span> models and each model can be expressed in vector notation as</p> <div class="math notranslate nohighlight"> \[Y_i = X_i\beta_i + \epsilon_i\]</div> <p>so that the set of models can be expressed as</p> <div class="math notranslate nohighlight"> \[Y = X\beta + \epsilon\]</div> <p>where <span class="math notranslate nohighlight">\(Y\)</span> is a column vector that stacks the vectors <span class="math notranslate nohighlight">\(Y_i\)</span> for <span class="math notranslate nohighlight">\(i=1,2,\ldots,K\)</span>, <span class="math notranslate nohighlight">\(X\)</span> is a block-diagonal matrix where diagonal block i is <span class="math notranslate nohighlight">\(X_i\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> is a stacked vector of the <span class="math notranslate nohighlight">\(K\)</span> <span class="math notranslate nohighlight">\(\beta_i\)</span>s and <span class="math notranslate nohighlight">\(\epsilon\)</span> is similarly comprised of the stacked columns of <span class="math notranslate nohighlight">\(\epsilon_i\)</span>.</p> <p>The model can be estimated using OLS with the usual estimator</p> <div class="math notranslate nohighlight"> \[\hat{\beta}_{OLS} = \left(X^\prime X\right)^{-1}X^\prime Y.\]</div> <p>Since there are multiple series, a GLS estimator that accounts for the cross-sectional heteroskedasticity as well as the correlation of residuals can be estimated</p> <div class="math notranslate nohighlight"> \[\hat{\beta}_{GLS} = \left(X^\prime \Omega^{-1} X\right)^{-1}X^\prime \Omega^{-1} Y\]</div> <p>where <span class="math notranslate nohighlight">\(\Omega^{-1} = \Sigma^{-1} \otimes I_{T}\)</span>, <span class="math notranslate nohighlight">\(\Sigma_{ij}\)</span> is the covariance between <span class="math notranslate nohighlight">\(\epsilon_i\)</span> and <span class="math notranslate nohighlight">\(\epsilon_j\)</span> and <span class="math notranslate nohighlight">\(T\)</span> is the number of observations. The GLS estimator is only beneficial when the regressors in different models differ and when residuals are correlated. There GLS estimates are identical to the multivariate OLS estimates when all regressors are common.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[1]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># Common libraries</span>
<span class=o >%</span><span class=k >matplotlib</span> inline
<span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>
<span class=kn >import</span> <span class=nn >pandas</span> <span class=k >as</span> <span class=nn >pd</span>
<span class=kn >import</span> <span class=nn >statsmodels.api</span> <span class=k >as</span> <span class=nn >sm</span>
</pre></div> </div> </div> <h2 id=Data >Data<a class=headerlink  href="#Data" title="Permalink to this headline">¶</a></h2> <p>Two data sets will be used. The first is from Munnell which looks at the effect of capital on state GDP. This example follows the example in Chapter 10 in recent editions of Greene”s <em>Econometric Analysis</em>.</p> <p>The data is state-level but the model is estimated in region. The first step is to aggregate the data by region. All capital measures are summed and the unemployment rate is averaged using weights proportional to the total employment in each state.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >from</span> <span class=nn >linearmodels.datasets</span> <span class=kn >import</span> <span class=n >munnell</span>
<span class=n >data</span> <span class=o >=</span> <span class=n >munnell</span><span class=o >.</span><span class=n >load</span><span class=p >()</span>

<span class=n >regions</span> <span class=o >=</span> <span class=p >{</span>
    <span class=s2 >"GF"</span><span class=p >:[</span><span class=s2 >"AL"</span><span class=p >,</span> <span class=s2 >"FL"</span><span class=p >,</span> <span class=s2 >"LA"</span><span class=p >,</span> <span class=s2 >"MS"</span><span class=p >],</span>
    <span class=s2 >"MW"</span><span class=p >:[</span><span class=s2 >"IL"</span><span class=p >,</span> <span class=s2 >"IN"</span><span class=p >,</span> <span class=s2 >"KY"</span><span class=p >,</span> <span class=s2 >"MI"</span><span class=p >,</span> <span class=s2 >"MN"</span><span class=p >,</span> <span class=s2 >"OH"</span><span class=p >,</span> <span class=s2 >"WI"</span><span class=p >],</span>
    <span class=s2 >"MA"</span><span class=p >:[</span><span class=s2 >"DE"</span><span class=p >,</span> <span class=s2 >"MD"</span><span class=p >,</span> <span class=s2 >"NJ"</span><span class=p >,</span> <span class=s2 >"NY"</span><span class=p >,</span> <span class=s2 >"PA"</span><span class=p >,</span> <span class=s2 >"VA"</span><span class=p >],</span>
    <span class=s2 >"MT"</span> <span class=p >:[</span><span class=s2 >"CO"</span><span class=p >,</span> <span class=s2 >"ID"</span><span class=p >,</span> <span class=s2 >"MT"</span><span class=p >,</span> <span class=s2 >"ND"</span><span class=p >,</span> <span class=s2 >"SD"</span><span class=p >,</span> <span class=s2 >"WY"</span><span class=p >],</span>
    <span class=s2 >"NE"</span> <span class=p >:[</span><span class=s2 >"CT"</span><span class=p >,</span> <span class=s2 >"ME"</span><span class=p >,</span> <span class=s2 >"MA"</span><span class=p >,</span> <span class=s2 >"NH"</span><span class=p >,</span> <span class=s2 >"RI"</span><span class=p >,</span> <span class=s2 >"VT"</span><span class=p >],</span>
    <span class=s2 >"SO"</span> <span class=p >:[</span><span class=s2 >"GA"</span><span class=p >,</span> <span class=s2 >"NC"</span><span class=p >,</span> <span class=s2 >"SC"</span><span class=p >,</span> <span class=s2 >"TN"</span><span class=p >,</span> <span class=s2 >"WV"</span><span class=p >,</span> <span class=s2 >"AR"</span><span class=p >],</span>
    <span class=s2 >"SW"</span> <span class=p >:</span> <span class=p >[</span><span class=s2 >"AZ"</span><span class=p >,</span> <span class=s2 >"NV"</span><span class=p >,</span> <span class=s2 >"NM"</span><span class=p >,</span> <span class=s2 >"TX"</span><span class=p >,</span> <span class=s2 >"UT"</span><span class=p >],</span>
    <span class=s2 >"CN"</span><span class=p >:</span> <span class=p >[</span><span class=s2 >"AK"</span><span class=p >,</span> <span class=s2 >"IA"</span><span class=p >,</span><span class=s2 >"KS"</span><span class=p >,</span> <span class=s2 >"MO"</span><span class=p >,</span><span class=s2 >"NE"</span><span class=p >,</span><span class=s2 >"OK"</span><span class=p >],</span>
    <span class=s2 >"WC"</span><span class=p >:</span> <span class=p >[</span><span class=s2 >"CA"</span><span class=p >,</span><span class=s2 >"OR"</span><span class=p >,</span><span class=s2 >"WA"</span><span class=p >]</span>
<span class=p >}</span>

<span class=k >def</span> <span class=nf >map_region</span><span class=p >(</span><span class=n >state</span><span class=p >):</span>
    <span class=k >for</span> <span class=n >key</span> <span class=ow >in</span> <span class=n >regions</span><span class=p >:</span>
        <span class=k >if</span> <span class=n >state</span> <span class=ow >in</span> <span class=n >regions</span><span class=p >[</span><span class=n >key</span><span class=p >]:</span>
            <span class=k >return</span> <span class=n >key</span>


<span class=n >data</span><span class=p >[</span><span class=s2 >"REGION"</span><span class=p >]</span> <span class=o >=</span> <span class=n >data</span><span class=o >.</span><span class=n >ST_ABB</span><span class=o >.</span><span class=n >map</span><span class=p >(</span><span class=n >map_region</span><span class=p >)</span>
<span class=n >data</span><span class=p >[</span><span class=s2 >"TOTAL_EMP"</span><span class=p >]</span> <span class=o >=</span> <span class=n >data</span><span class=o >.</span><span class=n >groupby</span><span class=p >([</span><span class=s2 >"REGION"</span><span class=p >,</span><span class=s2 >"YR"</span><span class=p >])[</span><span class=s2 >"EMP"</span><span class=p >]</span><span class=o >.</span><span class=n >transform</span><span class=p >(</span><span class=s2 >"sum"</span><span class=p >)</span>
<span class=n >data</span><span class=p >[</span><span class=s2 >"EMP_SHARE"</span><span class=p >]</span> <span class=o >=</span> <span class=n >data</span><span class=o >.</span><span class=n >EMP</span> <span class=o >/</span> <span class=n >data</span><span class=o >.</span><span class=n >TOTAL_EMP</span>
<span class=n >data</span><span class=p >[</span><span class=s2 >"WEIGHED_UNEMP"</span><span class=p >]</span> <span class=o >=</span> <span class=n >data</span><span class=o >.</span><span class=n >EMP_SHARE</span> <span class=o >*</span> <span class=n >data</span><span class=o >.</span><span class=n >UNEMP</span>
</pre></div> </div> </div> <p>A <code class="docutils literal notranslate"><span class=pre >groupby</span></code> transformation is used to aggregate the data, and finally all values except the unemployment rate are logged.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >grouped</span> <span class=o >=</span> <span class=n >data</span><span class=o >.</span><span class=n >groupby</span><span class=p >([</span><span class=s2 >"REGION"</span><span class=p >,</span><span class=s2 >"YR"</span><span class=p >])</span>
<span class=n >agg_data</span> <span class=o >=</span> <span class=n >grouped</span><span class=p >[[</span><span class=s2 >"GSP"</span><span class=p >,</span><span class=s2 >"PC"</span><span class=p >,</span><span class=s2 >"HWY"</span><span class=p >,</span><span class=s2 >"WATER"</span><span class=p >,</span><span class=s2 >"UTIL"</span><span class=p >,</span><span class=s2 >"EMP"</span><span class=p >,</span><span class=s2 >"WEIGHED_UNEMP"</span><span class=p >]]</span><span class=o >.</span><span class=n >sum</span><span class=p >()</span>
<span class=k >for</span> <span class=n >col</span> <span class=ow >in</span> <span class=p >[</span><span class=s2 >"GSP"</span><span class=p >,</span><span class=s2 >"PC"</span><span class=p >,</span><span class=s2 >"HWY"</span><span class=p >,</span><span class=s2 >"WATER"</span><span class=p >,</span><span class=s2 >"UTIL"</span><span class=p >,</span><span class=s2 >"EMP"</span><span class=p >]:</span>
    <span class=n >agg_data</span><span class=p >[</span><span class=s2 >"ln"</span><span class=o >+</span><span class=n >col</span><span class=p >]</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >log</span><span class=p >(</span><span class=n >agg_data</span><span class=p >[</span><span class=n >col</span><span class=p >])</span>
<span class=n >agg_data</span><span class=p >[</span><span class=s2 >"UNEMP"</span><span class=p >]</span> <span class=o >=</span> <span class=n >agg_data</span><span class=o >.</span><span class=n >WEIGHED_UNEMP</span>
<span class=n >agg_data</span><span class=p >[</span><span class=s2 >"Intercept"</span><span class=p >]</span> <span class=o >=</span> <span class=mf >1.0</span>
</pre></div> </div> </div> <h2 id=Basic-Usage >Basic Usage<a class=headerlink  href="#Basic-Usage" title="Permalink to this headline">¶</a></h2> <p>Seemingly Unrelated Models are fairly complex and each equation could have a different number of regressors. As a result, it is not possibly to use standard <code class="docutils literal notranslate"><span class=pre >pandas</span></code> or <code class="docutils literal notranslate"><span class=pre >numpy</span></code> data structures, and so dictionaries (or technically dictionary-like objects) are used. In practice, it is strongly recommended to use a <code class="docutils literal notranslate"><span class=pre >OrderedDictionary</span></code> from the <code class="docutils literal notranslate"><span class=pre >collections</span></code> module. This ensures that equation order will be preserved. In addition, the dictionary must have the following structure:</p> <ul class=simple > <li><p><code class="docutils literal notranslate"><span class=pre >keys</span></code> <strong>must be strings</strong> and will be used as equation labels</p> <li><p>The value associated with each key must be either a dictionary or a tuple.</p> <li><p>When a dictionary is used, it must have two keys, <code class="docutils literal notranslate"><span class=pre >dependent</span></code> and <code class="docutils literal notranslate"><span class=pre >exog</span></code>. It can optionally have a third key <code class="docutils literal notranslate"><span class=pre >weights</span></code> which provides weights to use in the regression.</p> <li><p>When a tuple is used, it must have two elements and takes the form <code class="docutils literal notranslate"><span class=pre >(dependent,</span> <span class=pre >exog)</span></code>. It can optionally contains weights in which case it takes the form <code class="docutils literal notranslate"><span class=pre >(dependent,</span> <span class=pre >exog,</span> <span class=pre >weights)</span></code>.</p> </ul> <p>This example uses the dictionary syntax to contain the data for each region and uses the region identified as the equation label.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >from</span> <span class=nn >collections</span> <span class=kn >import</span> <span class=n >OrderedDict</span>
<span class=n >mod_data</span> <span class=o >=</span> <span class=n >OrderedDict</span><span class=p >()</span>
<span class=k >for</span> <span class=n >region</span> <span class=ow >in</span> <span class=p >[</span><span class=s2 >"GF"</span><span class=p >,</span><span class=s2 >"SW"</span><span class=p >,</span><span class=s2 >"WC"</span><span class=p >,</span><span class=s2 >"MT"</span><span class=p >,</span><span class=s2 >"NE"</span><span class=p >,</span><span class=s2 >"MA"</span><span class=p >,</span><span class=s2 >"SO"</span><span class=p >,</span><span class=s2 >"MW"</span><span class=p >,</span><span class=s2 >"CN"</span><span class=p >]:</span>
    <span class=n >region_data</span> <span class=o >=</span> <span class=n >agg_data</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >region</span><span class=p >]</span>
    <span class=n >dependent</span> <span class=o >=</span> <span class=n >region_data</span><span class=o >.</span><span class=n >lnGSP</span>
    <span class=n >exog</span> <span class=o >=</span> <span class=n >region_data</span><span class=p >[[</span><span class=s2 >"Intercept"</span><span class=p >,</span> <span class=s2 >"lnPC"</span><span class=p >,</span> <span class=s2 >"lnHWY"</span><span class=p >,</span> <span class=s2 >"lnWATER"</span><span class=p >,</span> <span class=s2 >"lnUTIL"</span><span class=p >,</span> <span class=s2 >"lnEMP"</span><span class=p >,</span> <span class=s2 >"UNEMP"</span><span class=p >]]</span>
    <span class=n >mod_data</span><span class=p >[</span><span class=n >region</span><span class=p >]</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"dependent"</span><span class=p >:</span> <span class=n >dependent</span><span class=p >,</span> <span class=s2 >"exog"</span><span class=p >:</span> <span class=n >exog</span><span class=p >}</span>
</pre></div> </div> </div> <p>Fitting the model is virtually identical to fitting any other model with the exception of the special data structure required.</p> <p>The fitting options here ensure that the homoskedastic covariance estimator are used (<code class="docutils literal notranslate"><span class=pre >cov_type="unadjusted"</span></code>) and that a small sample adjustment is applied. By default, GLS is used (this can be overridden using <code class="docutils literal notranslate"><span class=pre >method="ols"</span></code>.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >import</span> <span class=nn >pandas</span> <span class=k >as</span> <span class=nn >pd</span>
<span class=kn >from</span> <span class=nn >linearmodels.system</span> <span class=kn >import</span> <span class=n >SUR</span>
<span class=n >mod</span> <span class=o >=</span> <span class=n >SUR</span><span class=p >(</span><span class=n >mod_data</span><span class=p >)</span>
<span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"unadjusted"</span><span class=p >)</span>
</pre></div> </div> </div> <p>One of the requirements for there to be an efficiency gain in a SUR is that the residuals are correlated. A heatmap is used to inspect this correlation, which is substantial and varies by region.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >cov</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >sigma</span>
<span class=n >std</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >diag</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >sigma</span><span class=p >)[:,</span><span class=kc >None</span><span class=p >])</span>
<span class=n >regions</span> <span class=o >=</span>  <span class=p >[</span><span class=n >k</span> <span class=k >for</span> <span class=n >k</span> <span class=ow >in</span> <span class=n >mod_data</span><span class=o >.</span><span class=n >keys</span><span class=p >()]</span>
<span class=n >corr</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >(</span><span class=n >cov</span> <span class=o >/</span> <span class=p >(</span><span class=n >std</span> <span class=o >@</span> <span class=n >std</span><span class=o >.</span><span class=n >T</span><span class=p >),</span> <span class=n >columns</span><span class=o >=</span><span class=n >regions</span><span class=p >,</span> <span class=n >index</span><span class=o >=</span><span class=n >regions</span><span class=p >)</span>

<span class=kn >import</span> <span class=nn >seaborn</span> <span class=k >as</span> <span class=nn >sns</span>
<span class=kn >import</span> <span class=nn >matplotlib.pyplot</span> <span class=k >as</span> <span class=nn >plt</span>
<span class=n >sns</span><span class=o >.</span><span class=n >heatmap</span><span class=p >(</span><span class=n >corr</span><span class=p >,</span> <span class=n >vmax</span><span class=o >=.</span><span class=mi >8</span><span class=p >,</span> <span class=n >square</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span>
<span class=n >plt</span><span class=o >.</span><span class=n >show</span><span class=p >()</span>

<span class=n >corr</span><span class=o >.</span><span class=n >style</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=s2 >"</span><span class=si >{:0.3f}</span><span class=s2 >"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/system_examples_examples_11_0.png" src="../../_images/system_examples_examples_11_0.png"/> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <style> </style><table id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62 ><thead> <tr> <th class="blank level0"> <th class="col_heading level0 col0">GF <th class="col_heading level0 col1">SW <th class="col_heading level0 col2">WC <th class="col_heading level0 col3">MT <th class="col_heading level0 col4">NE <th class="col_heading level0 col5">MA <th class="col_heading level0 col6">SO <th class="col_heading level0 col7">MW <th class="col_heading level0 col8">CN <tr> <th class="row_heading level0 row0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62level0_row0 >GF <td class="data row0 col0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row0_col0 >1.000 <td class="data row0 col1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row0_col1 >0.173 <td class="data row0 col2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row0_col2 >0.447 <td class="data row0 col3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row0_col3 >-0.547 <td class="data row0 col4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row0_col4 >0.525 <td class="data row0 col5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row0_col5 >0.425 <td class="data row0 col6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row0_col6 >0.763 <td class="data row0 col7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row0_col7 >0.167 <td class="data row0 col8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row0_col8 >0.325 <tr> <th class="row_heading level0 row1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62level0_row1 >SW <td class="data row1 col0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row1_col0 >0.173 <td class="data row1 col1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row1_col1 >1.000 <td class="data row1 col2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row1_col2 >0.697 <td class="data row1 col3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row1_col3 >-0.290 <td class="data row1 col4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row1_col4 >0.489 <td class="data row1 col5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row1_col5 >0.132 <td class="data row1 col6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row1_col6 >0.314 <td class="data row1 col7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row1_col7 >0.565 <td class="data row1 col8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row1_col8 >0.119 <tr> <th class="row_heading level0 row2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62level0_row2 >WC <td class="data row2 col0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row2_col0 >0.447 <td class="data row2 col1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row2_col1 >0.697 <td class="data row2 col2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row2_col2 >1.000 <td class="data row2 col3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row2_col3 >-0.537 <td class="data row2 col4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row2_col4 >0.343 <td class="data row2 col5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row2_col5 >0.130 <td class="data row2 col6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row2_col6 >0.505 <td class="data row2 col7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row2_col7 >0.574 <td class="data row2 col8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row2_col8 >0.037 <tr> <th class="row_heading level0 row3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62level0_row3 >MT <td class="data row3 col0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row3_col0 >-0.547 <td class="data row3 col1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row3_col1 >-0.290 <td class="data row3 col2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row3_col2 >-0.537 <td class="data row3 col3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row3_col3 >1.000 <td class="data row3 col4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row3_col4 >-0.241 <td class="data row3 col5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row3_col5 >-0.322 <td class="data row3 col6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row3_col6 >-0.351 <td class="data row3 col7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row3_col7 >-0.058 <td class="data row3 col8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row3_col8 >0.091 <tr> <th class="row_heading level0 row4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62level0_row4 >NE <td class="data row4 col0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row4_col0 >0.525 <td class="data row4 col1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row4_col1 >0.489 <td class="data row4 col2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row4_col2 >0.343 <td class="data row4 col3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row4_col3 >-0.241 <td class="data row4 col4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row4_col4 >1.000 <td class="data row4 col5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row4_col5 >0.259 <td class="data row4 col6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row4_col6 >0.783 <td class="data row4 col7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row4_col7 >0.269 <td class="data row4 col8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row4_col8 >0.200 <tr> <th class="row_heading level0 row5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62level0_row5 >MA <td class="data row5 col0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row5_col0 >0.425 <td class="data row5 col1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row5_col1 >0.132 <td class="data row5 col2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row5_col2 >0.130 <td class="data row5 col3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row5_col3 >-0.322 <td class="data row5 col4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row5_col4 >0.259 <td class="data row5 col5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row5_col5 >1.000 <td class="data row5 col6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row5_col6 >0.388 <td class="data row5 col7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row5_col7 >-0.037 <td class="data row5 col8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row5_col8 >0.713 <tr> <th class="row_heading level0 row6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62level0_row6 >SO <td class="data row6 col0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row6_col0 >0.763 <td class="data row6 col1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row6_col1 >0.314 <td class="data row6 col2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row6_col2 >0.505 <td class="data row6 col3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row6_col3 >-0.351 <td class="data row6 col4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row6_col4 >0.783 <td class="data row6 col5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row6_col5 >0.388 <td class="data row6 col6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row6_col6 >1.000 <td class="data row6 col7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row6_col7 >0.366 <td class="data row6 col8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row6_col8 >0.350 <tr> <th class="row_heading level0 row7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62level0_row7 >MW <td class="data row7 col0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row7_col0 >0.167 <td class="data row7 col1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row7_col1 >0.565 <td class="data row7 col2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row7_col2 >0.574 <td class="data row7 col3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row7_col3 >-0.058 <td class="data row7 col4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row7_col4 >0.269 <td class="data row7 col5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row7_col5 >-0.037 <td class="data row7 col6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row7_col6 >0.366 <td class="data row7 col7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row7_col7 >1.000 <td class="data row7 col8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row7_col8 >0.298 <tr> <th class="row_heading level0 row8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62level0_row8 >CN <td class="data row8 col0" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row8_col0 >0.325 <td class="data row8 col1" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row8_col1 >0.119 <td class="data row8 col2" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row8_col2 >0.037 <td class="data row8 col3" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row8_col3 >0.091 <td class="data row8 col4" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row8_col4 >0.200 <td class="data row8 col5" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row8_col5 >0.713 <td class="data row8 col6" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row8_col6 >0.350 <td class="data row8 col7" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row8_col7 >0.298 <td class="data row8 col8" id=T_b65fc78c_51c1_11ea_9f48_42010a14ff62row8_col8 >1.000 </table></div> </div> <p>These values can be seen to be identical to the reported results in the existing example from Greene.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >from</span> <span class=nn >IPython.display</span> <span class=kn >import</span> <span class=n >Image</span><span class=p >,</span> <span class=n >display_png</span>
<span class=n >display_png</span><span class=p >(</span><span class=n >Image</span><span class=p >(</span><span class=s2 >"system_correct-greene-table-10-2.png"</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/system_examples_examples_13_0.png" src="../../_images/system_examples_examples_13_0.png"/> </div> </div> <p>The full result is fairly long and so here I only print the first 33 lines which show results for two regions. By default it reports all estimates along with the usual measures of precision.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=nb >print</span><span class=p >(</span><span class=s2 >"</span><span class=se >\n</span><span class=s2 >"</span><span class=o >.</span><span class=n >join</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >summary</span><span class=o >.</span><span class=n >as_text</span><span class=p >()</span><span class=o >.</span><span class=n >split</span><span class=p >(</span><span class=s2 >"</span><span class=se >\n</span><span class=s2 >"</span><span class=p >)[:</span><span class=mi >33</span><span class=p >]))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.9937
No. Equations.:                     9   McElroy's R-squared:                 0.9988
No. Observations:                  17   Judge's (OLS) R-squared:             0.9937
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  1.0000
Time:                        20:11:41   Dhrymes's R-squared:                 0.9937
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                   Equation: GF, Dependent Variable: lnGSP
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      12.310     2.2513     5.4680     0.0000      7.8976      16.723
lnPC          -0.2010     0.1424    -1.4117     0.1580     -0.4800      0.0780
lnHWY         -1.8856     0.5169    -3.6480     0.0003     -2.8987     -0.8725
lnWATER        0.1785     0.0607     2.9399     0.0033      0.0595      0.2975
lnUTIL         1.1898     0.3744     3.1774     0.0015      0.4559      1.9237
lnEMP          0.9533     0.0847     11.252     0.0000      0.7872      1.1193
UNEMP         -0.0031     0.0021    -1.5007     0.1334     -0.0072      0.0009
                   Equation: SW, Dependent Variable: lnGSP
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      4.0831     0.9979     4.0918     0.0000      2.1273      6.0389
lnPC           0.0766     0.0858     0.8929     0.3719     -0.0916      0.2449
lnHWY         -0.1312     0.1279    -1.0258     0.3050     -0.3819      0.1195
lnWATER       -0.1360     0.0611    -2.2240     0.0261     -0.2558     -0.0161
lnUTIL         0.5216     0.1107     4.7102     0.0000      0.3045      0.7386
lnEMP          0.5387     0.0849     6.3439     0.0000      0.3723      0.7051
UNEMP         -0.0156     0.0025    -6.2950     0.0000     -0.0205     -0.0108
                   Equation: WC, Dependent Variable: lnGSP
==============================================================================
</pre></div></div> </div> <p>Individual results are contained in a dictionary located at the attribute <code class="docutils literal notranslate"><span class=pre >equations</span></code> and can be accessed using equation labels (available using the attribute <code class="docutils literal notranslate"><span class=pre >equation_labels</span></code>). Additional information about the model is presented in this view. The West Coast results are show.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >equations</span><span class=p >[</span><span class=s2 >"WC"</span><span class=p >])</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                            GLS Estimation Summary
==============================================================================
Eq. Label:                         WC   R-squared:                      0.9937
Dep. Variable:                  lnGSP   Adj. R-squared:                 0.9900
Estimator:                        GLS   Cov. Estimator:             unadjusted
No. Observations:                  17   F-statistic:                    2862.4
Date:                Mon, Feb 17 2020   P-value (F-stat)                0.0000
Time:                        20:11:41   Distribution:                  chi2(6)

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      1.9602     3.4542     0.5675     0.5704     -4.8100      8.7303
lnPC           0.1699     0.0919     1.8500     0.0643     -0.0101      0.3500
lnHWY          0.1317     0.1138     1.1569     0.2473     -0.0914      0.3547
lnWATER       -0.3470     0.1733    -2.0020     0.0453     -0.6867     -0.0073
lnUTIL         0.0895     0.4642     0.1928     0.8471     -0.8204      0.9994
lnEMP          1.0696     0.1708     6.2634     0.0000      0.7349      1.4043
UNEMP         -0.0060     0.0042    -1.4180     0.1562     -0.0143      0.0023

==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div> </div> <p>The current version of the model does not facilitate cross equation comparisons and so this is manually implemented here.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># TODO: Implement method to compare across equations</span>
<span class=n >params</span> <span class=o >=</span> <span class=p >[]</span>
<span class=k >for</span> <span class=n >label</span> <span class=ow >in</span> <span class=n >res</span><span class=o >.</span><span class=n >equation_labels</span><span class=p >:</span>
    <span class=n >params</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >equations</span><span class=p >[</span><span class=n >label</span><span class=p >]</span><span class=o >.</span><span class=n >params</span><span class=p >)</span>
<span class=n >params</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >concat</span><span class=p >(</span><span class=n >params</span><span class=p >,</span><span class=mi >1</span><span class=p >)</span>
<span class=n >params</span><span class=o >.</span><span class=n >columns</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >equation_labels</span>
<span class=n >params</span><span class=o >.</span><span class=n >T</span><span class=o >.</span><span class=n >style</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=s2 >"</span><span class=si >{:0.3f}</span><span class=s2 >"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <style> </style><table id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62 ><thead> <tr> <th class="blank level0"> <th class="col_heading level0 col0">Intercept <th class="col_heading level0 col1">lnPC <th class="col_heading level0 col2">lnHWY <th class="col_heading level0 col3">lnWATER <th class="col_heading level0 col4">lnUTIL <th class="col_heading level0 col5">lnEMP <th class="col_heading level0 col6">UNEMP <tr> <th class="row_heading level0 row0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62level0_row0 >GF <td class="data row0 col0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row0_col0 >12.310 <td class="data row0 col1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row0_col1 >-0.201 <td class="data row0 col2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row0_col2 >-1.886 <td class="data row0 col3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row0_col3 >0.178 <td class="data row0 col4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row0_col4 >1.190 <td class="data row0 col5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row0_col5 >0.953 <td class="data row0 col6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row0_col6 >-0.003 <tr> <th class="row_heading level0 row1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62level0_row1 >SW <td class="data row1 col0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row1_col0 >4.083 <td class="data row1 col1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row1_col1 >0.077 <td class="data row1 col2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row1_col2 >-0.131 <td class="data row1 col3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row1_col3 >-0.136 <td class="data row1 col4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row1_col4 >0.522 <td class="data row1 col5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row1_col5 >0.539 <td class="data row1 col6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row1_col6 >-0.016 <tr> <th class="row_heading level0 row2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62level0_row2 >WC <td class="data row2 col0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row2_col0 >1.960 <td class="data row2 col1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row2_col1 >0.170 <td class="data row2 col2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row2_col2 >0.132 <td class="data row2 col3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row2_col3 >-0.347 <td class="data row2 col4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row2_col4 >0.090 <td class="data row2 col5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row2_col5 >1.070 <td class="data row2 col6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row2_col6 >-0.006 <tr> <th class="row_heading level0 row3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62level0_row3 >MT <td class="data row3 col0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row3_col0 >3.463 <td class="data row3 col1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row3_col1 >-0.115 <td class="data row3 col2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row3_col2 >0.180 <td class="data row3 col3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row3_col3 >0.262 <td class="data row3 col4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row3_col4 >-0.330 <td class="data row3 col5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row3_col5 >1.079 <td class="data row3 col6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row3_col6 >-0.001 <tr> <th class="row_heading level0 row4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62level0_row4 >NE <td class="data row4 col0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row4_col0 >-12.294 <td class="data row4 col1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row4_col1 >0.118 <td class="data row4 col2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row4_col2 >0.934 <td class="data row4 col3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row4_col3 >-0.557 <td class="data row4 col4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row4_col4 >-0.290 <td class="data row4 col5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row4_col5 >2.494 <td class="data row4 col6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row4_col6 >0.020 <tr> <th class="row_heading level0 row5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62level0_row5 >MA <td class="data row5 col0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row5_col0 >-18.616 <td class="data row5 col1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row5_col1 >-0.311 <td class="data row5 col2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row5_col2 >3.060 <td class="data row5 col3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row5_col3 >-0.109 <td class="data row5 col4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row5_col4 >-1.659 <td class="data row5 col5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row5_col5 >2.186 <td class="data row5 col6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row5_col6 >0.018 <tr> <th class="row_heading level0 row6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62level0_row6 >SO <td class="data row6 col0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row6_col0 >3.162 <td class="data row6 col1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row6_col1 >-0.063 <td class="data row6 col2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row6_col2 >-0.641 <td class="data row6 col3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row6_col3 >-0.081 <td class="data row6 col4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row6_col4 >0.281 <td class="data row6 col5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row6_col5 >1.620 <td class="data row6 col6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row6_col6 >0.008 <tr> <th class="row_heading level0 row7" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62level0_row7 >MW <td class="data row7 col0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row7_col0 >-9.258 <td class="data row7 col1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row7_col1 >0.096 <td class="data row7 col2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row7_col2 >1.612 <td class="data row7 col3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row7_col3 >0.694 <td class="data row7 col4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row7_col4 >-0.340 <td class="data row7 col5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row7_col5 >-0.062 <td class="data row7 col6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row7_col6 >-0.031 <tr> <th class="row_heading level0 row8" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62level0_row8 >CN <td class="data row8 col0" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row8_col0 >-3.405 <td class="data row8 col1" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row8_col1 >0.295 <td class="data row8 col2" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row8_col2 >0.934 <td class="data row8 col3" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row8_col3 >0.539 <td class="data row8 col4" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row8_col4 >0.003 <td class="data row8 col5" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row8_col5 >-0.321 <td class="data row8 col6" id=T_b65fc78d_51c1_11ea_9f48_42010a14ff62row8_col6 >-0.029 </table></div> </div> <p>These results can be compared to the results in Greene – they are unsurprisingly identical.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[11]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >display_png</span><span class=p >(</span><span class=n >Image</span><span class=p >(</span><span class=s2 >"system_correct-greene-table-10-1.png"</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/system_examples_examples_21_0.png" src="../../_images/system_examples_examples_21_0.png"/> </div> </div> <p>The GLS estimation method requires stronger assumptions for parameter estimates to be consistent. If these are violated then it might be the case that OLS is still consistent (in some sense) and so OLS can be used by passing <code class="docutils literal notranslate"><span class=pre >method="ols"</span></code> when calling <code class="docutils literal notranslate"><span class=pre >fit</span></code>.</p> <p>These results can be compared to Greene”s table – they are identical except the final value which seems to have a small typo.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[12]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >res_ols</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >method</span><span class=o >=</span><span class=s2 >"ols"</span><span class=p >,</span> <span class=n >debiased</span><span class=o >=</span><span class=kc >True</span><span class=p >,</span> <span class=n >cov_type</span><span class=o >=</span><span class=s2 >"unadjusted"</span><span class=p >)</span>
<span class=n >params</span> <span class=o >=</span> <span class=p >[]</span>
<span class=n >r2</span> <span class=o >=</span> <span class=p >[]</span>
<span class=k >for</span> <span class=n >label</span> <span class=ow >in</span> <span class=n >res</span><span class=o >.</span><span class=n >equation_labels</span><span class=p >:</span>
    <span class=n >params</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >res_ols</span><span class=o >.</span><span class=n >equations</span><span class=p >[</span><span class=n >label</span><span class=p >]</span><span class=o >.</span><span class=n >params</span><span class=p >)</span>
    <span class=n >r2</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >res_ols</span><span class=o >.</span><span class=n >equations</span><span class=p >[</span><span class=n >label</span><span class=p >]</span><span class=o >.</span><span class=n >rsquared</span><span class=p >)</span>
<span class=n >params</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >concat</span><span class=p >(</span><span class=n >params</span><span class=p >,</span><span class=mi >1</span><span class=p >)</span>
<span class=n >params</span><span class=o >.</span><span class=n >columns</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >equation_labels</span>
<span class=n >params</span> <span class=o >=</span> <span class=n >params</span><span class=o >.</span><span class=n >T</span>
<span class=n >params</span><span class=p >[</span><span class=s2 >"R2"</span><span class=p >]</span> <span class=o >=</span> <span class=n >r2</span>
<span class=n >params</span><span class=o >.</span><span class=n >style</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=s2 >"</span><span class=si >{:0.3f}</span><span class=s2 >"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[12]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <style> </style><table id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62 ><thead> <tr> <th class="blank level0"> <th class="col_heading level0 col0">Intercept <th class="col_heading level0 col1">lnPC <th class="col_heading level0 col2">lnHWY <th class="col_heading level0 col3">lnWATER <th class="col_heading level0 col4">lnUTIL <th class="col_heading level0 col5">lnEMP <th class="col_heading level0 col6">UNEMP <th class="col_heading level0 col7">R2 <tr> <th class="row_heading level0 row0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62level0_row0 >GF <td class="data row0 col0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row0_col0 >11.567 <td class="data row0 col1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row0_col1 >0.002 <td class="data row0 col2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row0_col2 >-2.029 <td class="data row0 col3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row0_col3 >0.101 <td class="data row0 col4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row0_col4 >1.358 <td class="data row0 col5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row0_col5 >0.805 <td class="data row0 col6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row0_col6 >-0.007 <td class="data row0 col7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row0_col7 >0.997 <tr> <th class="row_heading level0 row1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62level0_row1 >SW <td class="data row1 col0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row1_col0 >3.028 <td class="data row1 col1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row1_col1 >0.164 <td class="data row1 col2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row1_col2 >-0.075 <td class="data row1 col3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row1_col3 >-0.169 <td class="data row1 col4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row1_col4 >0.637 <td class="data row1 col5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row1_col5 >0.362 <td class="data row1 col6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row1_col6 >-0.017 <td class="data row1 col7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row1_col7 >0.998 <tr> <th class="row_heading level0 row2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62level0_row2 >WC <td class="data row2 col0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row2_col0 >3.590 <td class="data row2 col1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row2_col1 >0.295 <td class="data row2 col2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row2_col2 >0.174 <td class="data row2 col3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row2_col3 >-0.226 <td class="data row2 col4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row2_col4 >-0.214 <td class="data row2 col5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row2_col5 >0.917 <td class="data row2 col6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row2_col6 >-0.008 <td class="data row2 col7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row2_col7 >0.994 <tr> <th class="row_heading level0 row3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62level0_row3 >MT <td class="data row3 col0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row3_col0 >6.378 <td class="data row3 col1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row3_col1 >-0.153 <td class="data row3 col2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row3_col2 >-0.123 <td class="data row3 col3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row3_col3 >0.306 <td class="data row3 col4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row3_col4 >-0.533 <td class="data row3 col5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row3_col5 >1.344 <td class="data row3 col6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row3_col6 >0.005 <td class="data row3 col7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row3_col7 >0.999 <tr> <th class="row_heading level0 row4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62level0_row4 >NE <td class="data row4 col0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row4_col0 >-13.730 <td class="data row4 col1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row4_col1 >-0.020 <td class="data row4 col2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row4_col2 >0.662 <td class="data row4 col3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row4_col3 >-0.969 <td class="data row4 col4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row4_col4 >-0.107 <td class="data row4 col5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row4_col5 >3.380 <td class="data row4 col6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row4_col6 >0.034 <td class="data row4 col7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row4_col7 >0.985 <tr> <th class="row_heading level0 row5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62level0_row5 >MA <td class="data row5 col0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row5_col0 >-22.855 <td class="data row5 col1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row5_col1 >-0.378 <td class="data row5 col2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row5_col2 >3.348 <td class="data row5 col3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row5_col3 >-0.264 <td class="data row5 col4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row5_col4 >-1.778 <td class="data row5 col5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row5_col5 >2.673 <td class="data row5 col6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row5_col6 >0.026 <td class="data row5 col7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row5_col7 >0.986 <tr> <th class="row_heading level0 row6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62level0_row6 >SO <td class="data row6 col0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row6_col0 >3.927 <td class="data row6 col1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row6_col1 >0.043 <td class="data row6 col2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row6_col2 >-0.773 <td class="data row6 col3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row6_col3 >-0.035 <td class="data row6 col4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row6_col4 >0.140 <td class="data row6 col5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row6_col5 >1.665 <td class="data row6 col6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row6_col6 >0.008 <td class="data row6 col7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row6_col7 >0.994 <tr> <th class="row_heading level0 row7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62level0_row7 >MW <td class="data row7 col0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row7_col0 >-9.111 <td class="data row7 col1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row7_col1 >0.233 <td class="data row7 col2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row7_col2 >1.604 <td class="data row7 col3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row7_col3 >0.717 <td class="data row7 col4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row7_col4 >-0.356 <td class="data row7 col5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row7_col5 >-0.259 <td class="data row7 col6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row7_col6 >-0.034 <td class="data row7 col7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row7_col7 >0.989 <tr> <th class="row_heading level0 row8" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62level0_row8 >CN <td class="data row8 col0" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row8_col0 >-5.621 <td class="data row8 col1" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row8_col1 >0.386 <td class="data row8 col2" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row8_col2 >1.267 <td class="data row8 col3" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row8_col3 >0.546 <td class="data row8 col4" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row8_col4 >-0.108 <td class="data row8 col5" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row8_col5 >-0.475 <td class="data row8 col6" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row8_col6 >-0.031 <td class="data row8 col7" id=T_b65fc78e_51c1_11ea_9f48_42010a14ff62row8_col7 >0.995 </table></div> </div> <p>The parameter estimates for one coefficient – unemployment – can be compared across the two estimation methods.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >params</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >concat</span><span class=p >([</span><span class=n >res_ols</span><span class=o >.</span><span class=n >params</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=mi >1</span><span class=p >::</span><span class=mi >7</span><span class=p >],</span> <span class=n >res_ols</span><span class=o >.</span><span class=n >std_errors</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=mi >1</span><span class=p >::</span><span class=mi >7</span><span class=p >],</span>
 <span class=n >res</span><span class=o >.</span><span class=n >params</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=mi >1</span><span class=p >::</span><span class=mi >7</span><span class=p >],</span> <span class=n >res</span><span class=o >.</span><span class=n >std_errors</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=mi >1</span><span class=p >::</span><span class=mi >7</span><span class=p >]],</span><span class=mi >1</span><span class=p >)</span>
<span class=n >params</span><span class=o >.</span><span class=n >columns</span><span class=o >=</span><span class=p >[</span><span class=s2 >"OLS"</span><span class=p >,</span> <span class=s2 >"OLS se"</span><span class=p >,</span> <span class=s2 >"GLS"</span><span class=p >,</span> <span class=s2 >"GLS se"</span><span class=p >]</span>
<span class=n >params</span><span class=o >.</span><span class=n >index</span> <span class=o >=</span> <span class=n >regions</span>
<span class=n >params</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <div> <style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } </style> <table border=1  class=dataframe > <thead> <tr style="text-align: right;"> <th> <th>OLS <th>OLS se <th>GLS <th>GLS se <tr> <th>GF <td>0.002124 <td>0.301235 <td>-0.200966 <td>0.142355 <tr> <th>SW <td>0.163546 <td>0.165995 <td>0.076637 <td>0.085831 <tr> <th>WC <td>0.294855 <td>0.205417 <td>0.169950 <td>0.091865 <tr> <th>MT <td>-0.152601 <td>0.084031 <td>-0.114834 <td>0.048489 <tr> <th>NE <td>-0.020407 <td>0.285621 <td>0.118316 <td>0.131329 <tr> <th>MA <td>-0.377570 <td>0.167307 <td>-0.310861 <td>0.080893 <tr> <th>SO <td>0.042818 <td>0.279472 <td>-0.063212 <td>0.104344 <tr> <th>MW <td>0.233403 <td>0.206248 <td>0.095886 <td>0.101564 <tr> <th>CN <td>0.385885 <td>0.211083 <td>0.294570 <td>0.090104 </table> </div></div> </div> <p>The parameters and their standard errors match those reported in Greene.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[14]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >display_png</span><span class=p >(</span><span class=n >Image</span><span class=p >(</span><span class=s2 >"system_correct-greene-table-10-3.png"</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/system_examples_examples_27_0.png" src="../../_images/system_examples_examples_27_0.png"/> </div> </div> <h2 id=Estimation-Options >Estimation Options<a class=headerlink  href="#Estimation-Options" title="Permalink to this headline">¶</a></h2> <h3 id=Iterative-GLS >Iterative GLS<a class=headerlink  href="#Iterative-GLS" title="Permalink to this headline">¶</a></h3> <p>These next examples use data on fringe benefits from F. Vella (1993), “A Simple Estimator for Simultaneous Models with Censored Endogenous Regressors” which appears in Wooldridge (2002). The model consists of two equations, one for hourly wage and the other for hourly benefits. The initial model uses the same regressors in both equations.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[15]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >from</span> <span class=nn >linearmodels.datasets</span> <span class=kn >import</span> <span class=n >fringe</span>
<span class=nb >print</span><span class=p >(</span><span class=n >fringe</span><span class=o >.</span><span class=n >DESCR</span><span class=p >)</span>
<span class=n >fdata</span> <span class=o >=</span> <span class=n >fringe</span><span class=o >.</span><span class=n >load</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>

F. Vella (1993), "A Simple Estimator for Simultaneous Models with Censored
Endogenous Regressors," International Economic Review 34, 441-457.

annearn                  annual earnings, $
hrearn                   hourly earnings, $
exper                    years work experience
age                      age in years
depends                  number of dependents
married                  =1 if married
tenure                   years with current employer
educ                     years schooling
nrtheast                 =1 if live in northeast
nrthcen                  =1 if live in north central
south                    =1 if live in south
male                     =1 if male
white                    =1 if white
union                    =1 if union member
office                   =1 if office worker
annhrs                   annual hours worked
ind1                     =1 if industry == 1
ind2                     =1 if industry == 2
ind3                     =1 if industry == 3
ind4                     =1 if industry == 4
ind5                     =1 if industry == 5
ind6                     =1 if industry == 6
ind7                     =1 if industry == 7
ind8                     =1 if industry == 8
ind9                     =1 if industry == 9
vacdays                  $ value of vac days
sicklve                  $ value of sick leave
insur                    $ value of employee insur
pension                  $ value of employee pension
annbens                  vacdays+sicklve+insur+pension
hrbens                   hourly benefits, $
annhrssq                 annhrs^2
beratio                  annbens/annearn
lannhrs                  log(annhrs)
tenuresq                 tenure^2
expersq                  exper^2
lannearn                 log(annearn)
peratio                  pension/annearn
vserat                   (vacdays+sicklve)/annearn

</pre></div></div> </div> <p>The estimated model is reported as “System OLS Estimation” since when all regressors are identical, OLS is used since GLS brings no efficiency gains. OLS will be used when the data structure containing the exogenous regressors in each equations is the same (i.e., <code class="docutils literal notranslate"><span class=pre >id(exog)</span></code> is the same for all equations).</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[16]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >exog</span> <span class=o >=</span> <span class=n >sm</span><span class=o >.</span><span class=n >add_constant</span><span class=p >(</span><span class=n >fdata</span><span class=p >[[</span><span class=s2 >"educ"</span><span class=p >,</span><span class=s2 >"exper"</span><span class=p >,</span><span class=s2 >"expersq"</span><span class=p >,</span><span class=s2 >"tenure"</span><span class=p >,</span><span class=s2 >"tenuresq"</span><span class=p >,</span><span class=s2 >"union"</span><span class=p >,</span><span class=s2 >"south"</span><span class=p >,</span><span class=s2 >"nrtheast"</span><span class=p >,</span><span class=s2 >"nrthcen"</span><span class=p >,</span><span class=s2 >"married"</span><span class=p >,</span><span class=s2 >"white"</span><span class=p >,</span><span class=s2 >"male"</span><span class=p >]])</span>
<span class=n >fmod_data</span> <span class=o >=</span> <span class=n >OrderedDict</span><span class=p >()</span>
<span class=n >fmod_data</span><span class=p >[</span><span class=s2 >"hrearn"</span><span class=p >]</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"dependent"</span><span class=p >:</span> <span class=n >fdata</span><span class=o >.</span><span class=n >hrearn</span><span class=p >,</span> <span class=s2 >"exog"</span><span class=p >:</span> <span class=n >exog</span><span class=p >}</span>
<span class=n >fmod_data</span><span class=p >[</span><span class=s2 >"hrbens"</span><span class=p >]</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"dependent"</span><span class=p >:</span> <span class=n >fdata</span><span class=o >.</span><span class=n >hrbens</span><span class=p >,</span> <span class=s2 >"exog"</span><span class=p >:</span> <span class=n >exog</span><span class=p >}</span>
<span class=n >fmod</span> <span class=o >=</span> <span class=n >SUR</span><span class=p >(</span><span class=n >fmod_data</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >fmod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"unadjusted"</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System OLS Estimation Summary
===================================================================================
Estimator:                        OLS   Overall R-squared:                   0.2087
No. Equations.:                     2   McElroy's R-squared:                 0.2926
No. Observations:                 616   Judge's (OLS) R-squared:             0.2087
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.4822
Time:                        20:11:42   Dhrymes's R-squared:                 0.2087
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.6321     1.2153    -2.1658     0.0303     -5.0141     -0.2502
educ           0.4588     0.0684     6.7085     0.0000      0.3248      0.5929
exper         -0.0758     0.0567    -1.3367     0.1813     -0.1870      0.0354
expersq        0.0040     0.0012     3.4274     0.0006      0.0017      0.0063
tenure         0.1101     0.0829     1.3276     0.1843     -0.0524      0.2726
tenuresq      -0.0051     0.0032    -1.5640     0.1178     -0.0114      0.0013
union          0.8080     0.4035     2.0026     0.0452      0.0172      1.5988
south         -0.4566     0.5459    -0.8365     0.4029     -1.5265      0.6132
nrtheast      -1.1508     0.5993    -1.9201     0.0548     -2.3254      0.0239
nrthcen       -0.6363     0.5501    -1.1565     0.2475     -1.7145      0.4420
married        0.6424     0.4134     1.5540     0.1202     -0.1678      1.4526
white          1.1409     0.6054     1.8844     0.0595     -0.0458      2.3275
male           1.7847     0.3938     4.5322     0.0000      1.0129      2.5565
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8897     0.1453    -6.1225     0.0000     -1.1746     -0.6049
educ           0.0768     0.0082     9.3896     0.0000      0.0608      0.0928
exper          0.0226     0.0068     3.3259     0.0009      0.0093      0.0359
expersq       -0.0005     0.0001    -3.3965     0.0007     -0.0007     -0.0002
tenure         0.0536     0.0099     5.4011     0.0000      0.0341      0.0730
tenuresq      -0.0012     0.0004    -3.0014     0.0027     -0.0019     -0.0004
union          0.3659     0.0482     7.5839     0.0000      0.2713      0.4605
south         -0.0227     0.0653    -0.3476     0.7282     -0.1506      0.1052
nrtheast      -0.0567     0.0717    -0.7918     0.4285     -0.1972      0.0837
nrthcen       -0.0380     0.0658    -0.5776     0.5635     -0.1669      0.0909
married        0.0579     0.0494     1.1706     0.2418     -0.0390      0.1547
white          0.0902     0.0724     1.2453     0.2130     -0.0517      0.2321
male           0.2683     0.0471     5.6985     0.0000      0.1760      0.3606
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: False)
</pre></div></div> </div> <p>The estimator can be forced to use GLS by setting <code class="docutils literal notranslate"><span class=pre >method="gls"</span></code>. As can be seen below, the parameter estimates and standard errors do not change even though two-stage GLS is used. The <span class="math notranslate nohighlight">\(R^2\)</span> <strong>does change</strong> since the left-hand side variable is transformed by the GLS weighting before estimation.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[17]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=nb >print</span><span class=p >(</span><span class=n >fmod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >method</span><span class=o >=</span><span class=s2 >"gls"</span><span class=p >,</span> <span class=n >cov_type</span><span class=o >=</span><span class=s2 >"unadjusted"</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.2087
No. Equations.:                     2   McElroy's R-squared:                 0.2926
No. Observations:                 616   Judge's (OLS) R-squared:             0.2087
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.4822
Time:                        20:11:42   Dhrymes's R-squared:                 0.2087
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.6321     1.2153    -2.1658     0.0303     -5.0141     -0.2502
educ           0.4588     0.0684     6.7085     0.0000      0.3248      0.5929
exper         -0.0758     0.0567    -1.3367     0.1813     -0.1870      0.0354
expersq        0.0040     0.0012     3.4274     0.0006      0.0017      0.0063
tenure         0.1101     0.0829     1.3276     0.1843     -0.0524      0.2726
tenuresq      -0.0051     0.0032    -1.5640     0.1178     -0.0114      0.0013
union          0.8080     0.4035     2.0026     0.0452      0.0172      1.5988
south         -0.4566     0.5459    -0.8365     0.4029     -1.5265      0.6132
nrtheast      -1.1508     0.5993    -1.9201     0.0548     -2.3254      0.0239
nrthcen       -0.6363     0.5501    -1.1565     0.2475     -1.7145      0.4420
married        0.6424     0.4134     1.5540     0.1202     -0.1678      1.4526
white          1.1409     0.6054     1.8844     0.0595     -0.0458      2.3275
male           1.7847     0.3938     4.5322     0.0000      1.0129      2.5565
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8897     0.1453    -6.1225     0.0000     -1.1746     -0.6049
educ           0.0768     0.0082     9.3896     0.0000      0.0608      0.0928
exper          0.0226     0.0068     3.3259     0.0009      0.0093      0.0359
expersq       -0.0005     0.0001    -3.3965     0.0007     -0.0007     -0.0002
tenure         0.0536     0.0099     5.4011     0.0000      0.0341      0.0730
tenuresq      -0.0012     0.0004    -3.0014     0.0027     -0.0019     -0.0004
union          0.3659     0.0482     7.5839     0.0000      0.2713      0.4605
south         -0.0227     0.0653    -0.3476     0.7282     -0.1506      0.1052
nrtheast      -0.0567     0.0717    -0.7918     0.4285     -0.1972      0.0837
nrthcen       -0.0380     0.0658    -0.5776     0.5635     -0.1669      0.0909
married        0.0579     0.0494     1.1706     0.2418     -0.0390      0.1547
white          0.0902     0.0724     1.2453     0.2130     -0.0517      0.2321
male           0.2683     0.0471     5.6985     0.0000      0.1760      0.3606
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div> </div> <p>The regressors must differ in order to see gains to GLS. Here insignificant variables are dropped from each equation so that the regressors will no longer be identical. The typical standard error is marginally smaller, although this might be due to dropping regressors.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[18]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >exog_earn</span> <span class=o >=</span> <span class=n >sm</span><span class=o >.</span><span class=n >add_constant</span><span class=p >(</span><span class=n >fdata</span><span class=p >[[</span><span class=s2 >"educ"</span><span class=p >,</span><span class=s2 >"exper"</span><span class=p >,</span><span class=s2 >"expersq"</span><span class=p >,</span><span class=s2 >"union"</span><span class=p >,</span><span class=s2 >"nrtheast"</span><span class=p >,</span><span class=s2 >"white"</span><span class=p >]])</span>
<span class=n >exog_bens</span> <span class=o >=</span> <span class=n >sm</span><span class=o >.</span><span class=n >add_constant</span><span class=p >(</span><span class=n >fdata</span><span class=p >[[</span><span class=s2 >"educ"</span><span class=p >,</span><span class=s2 >"exper"</span><span class=p >,</span><span class=s2 >"expersq"</span><span class=p >,</span><span class=s2 >"tenure"</span><span class=p >,</span><span class=s2 >"tenuresq"</span><span class=p >,</span><span class=s2 >"union"</span><span class=p >,</span><span class=s2 >"male"</span><span class=p >]])</span>
<span class=n >fmod_data</span><span class=p >[</span><span class=s2 >"hrearn"</span><span class=p >]</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"dependent"</span><span class=p >:</span> <span class=n >fdata</span><span class=o >.</span><span class=n >hrearn</span><span class=p >,</span> <span class=s2 >"exog"</span><span class=p >:</span> <span class=n >exog_earn</span><span class=p >}</span>
<span class=n >fmod_data</span><span class=p >[</span><span class=s2 >"hrbens"</span><span class=p >]</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"dependent"</span><span class=p >:</span> <span class=n >fdata</span><span class=o >.</span><span class=n >hrbens</span><span class=p >,</span> <span class=s2 >"exog"</span><span class=p >:</span> <span class=n >exog_bens</span><span class=p >}</span>
<span class=n >fmod</span> <span class=o >=</span> <span class=n >SUR</span><span class=p >(</span><span class=n >fmod_data</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >fmod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"unadjusted"</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy's R-squared:                 0.2762
No. Observations:                 616   Judge's (OLS) R-squared:             0.1685
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.4504
Time:                        20:11:42   Dhrymes's R-squared:                 0.1685
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5240     1.0857    -2.3246     0.0201     -4.6520     -0.3959
educ           0.5000     0.0685     7.2987     0.0000      0.3657      0.6342
exper         -0.0212     0.0522    -0.4058     0.6849     -0.1234      0.0811
expersq        0.0032     0.0011     2.8776     0.0040      0.0010      0.0055
union          1.1043     0.3928     2.8116     0.0049      0.3345      1.8741
nrtheast      -0.5343     0.4305    -1.2411     0.2146     -1.3780      0.3095
white          1.1320     0.5845     1.9368     0.0528     -0.0136      2.2776
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8231     0.1176    -7.0021     0.0000     -1.0535     -0.5927
educ           0.0791     0.0080     9.8927     0.0000      0.0634      0.0948
exper          0.0260     0.0066     3.9114     0.0001      0.0130      0.0390
expersq       -0.0005     0.0001    -3.8469     0.0001     -0.0008     -0.0003
tenure         0.0494     0.0094     5.2409     0.0000      0.0309      0.0679
tenuresq      -0.0010     0.0004    -2.6275     0.0086     -0.0017     -0.0002
union          0.3766     0.0475     7.9259     0.0000      0.2835      0.4698
male           0.2141     0.0433     4.9413     0.0000      0.1292      0.2990
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div> </div> <p>The standard method to estimate models uses two steps. The first uses OLS to estimate the parameters so that the residual covariance can be estimated. The second stage uses the estimated covariance to estimate the model via GLS. Iterative GLS can be used to continue these iterations using the most recent step to estimate the residual covariance and then re-estimating the parameters using GLS. This option can be used by setting <code class="docutils literal notranslate"><span class=pre >iterate=True</span></code>.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[19]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >fmod_res</span> <span class=o >=</span> <span class=n >fmod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"unadjusted"</span><span class=p >,</span> <span class=n >iterate</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >fmod_res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                      System Iterative GLS Estimation Summary
===================================================================================
Estimator:              Iterative GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy's R-squared:                 0.2749
No. Observations:                 616   Judge's (OLS) R-squared:             0.1685
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.4532
Time:                        20:11:42   Dhrymes's R-squared:                 0.1685
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5147     1.0858    -2.3161     0.0206     -4.6428     -0.3867
educ           0.5001     0.0685     7.3004     0.0000      0.3658      0.6344
exper         -0.0211     0.0522    -0.4044     0.6859     -0.1233      0.0811
expersq        0.0032     0.0011     2.8760     0.0040      0.0010      0.0055
union          1.1043     0.3928     2.8115     0.0049      0.3345      1.8741
nrtheast      -0.5314     0.4305    -1.2342     0.2171     -1.3752      0.3124
white          1.1191     0.5845     1.9145     0.0556     -0.0266      2.2648
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8223     0.1176    -6.9947     0.0000     -1.0527     -0.5919
educ           0.0792     0.0080     9.9004     0.0000      0.0635      0.0948
exper          0.0260     0.0066     3.9213     0.0001      0.0130      0.0390
expersq       -0.0005     0.0001    -3.8528     0.0001     -0.0008     -0.0003
tenure         0.0492     0.0094     5.2189     0.0000      0.0307      0.0677
tenuresq      -0.0010     0.0004    -2.6025     0.0093     -0.0017     -0.0002
union          0.3771     0.0475     7.9364     0.0000      0.2840      0.4703
male           0.2107     0.0433     4.8627     0.0000      0.1258      0.2956
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div> </div> <p>The number of GLS iterations can be verified using the <code class="docutils literal notranslate"><span class=pre >iterations</span></code> attribute of the results.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[20]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >fmod_res</span><span class=o >.</span><span class=n >iterations</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[20]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
5
</pre></div></div> </div> <h3 id=Alternative-Covariance-Estimators >Alternative Covariance Estimators<a class=headerlink  href="#Alternative-Covariance-Estimators" title="Permalink to this headline">¶</a></h3> <p>The estimator supports heteroskedasticity robust covariance estimation b setting <code class="docutils literal notranslate"><span class=pre >cov_type="robust"</span></code>. The estimator allows for arbitrary correlation across series with the same time index but not correlation across time periods, which is the same assumption as in the unadjusted estimator. The main difference is that this estimator will correct standard errors for dependence between regressors (or squared regressors) and squared residuals.</p> <h4 id=Heteroskedasticity-Robust-Covariance-Estimation >Heteroskedasticity Robust Covariance Estimation<a class=headerlink  href="#Heteroskedasticity-Robust-Covariance-Estimation" title="Permalink to this headline">¶</a></h4> <p>In the fringe benefit model there are some large differences between standard errors computed using the the homoskedastic covariance estimator and the heteroskedasticity robust covariance estimator (e.g., <code class="docutils literal notranslate"><span class=pre >exper</span></code>).</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[21]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >fres_het</span> <span class=o >=</span> <span class=n >fmod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"robust"</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >fres_het</span><span class=o >.</span><span class=n >summary</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy's R-squared:                 0.2762
No. Observations:                 616   Judge's (OLS) R-squared:             0.1685
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.4504
Time:                        20:11:42   Dhrymes's R-squared:                 0.1685
                                        Cov. Estimator:                      robust
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5240     0.2961    -8.5241     0.0000     -3.1043     -1.9436
educ           0.5000     0.0192     26.003     0.0000      0.4623      0.5377
exper         -0.0212     0.0526    -0.4022     0.6875     -0.1243      0.0820
expersq        0.0032     0.0014     2.3698     0.0178      0.0006      0.0059
union          1.1043     0.0640     17.244     0.0000      0.9788      1.2298
nrtheast      -0.5343     0.3117    -1.7139     0.0865     -1.1452      0.0767
white          1.1320     0.3624     3.1237     0.0018      0.4217      1.8423
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8231     0.2068    -3.9811     0.0001     -1.2284     -0.4179
educ           0.0791     0.0152     5.1947     0.0000      0.0493      0.1089
exper          0.0260     0.0181     1.4358     0.1511     -0.0095      0.0614
expersq       -0.0005     0.0005    -1.1722     0.2411     -0.0014      0.0004
tenure         0.0494     0.0198     2.4992     0.0124      0.0107      0.0881
tenuresq      -0.0010     0.0008    -1.1867     0.2354     -0.0026      0.0006
union          0.3766     0.0982     3.8348     0.0001      0.1841      0.5691
male           0.2141     0.0807     2.6524     0.0080      0.0559      0.3722
==============================================================================

Covariance Estimator:
Heteroskedastic (Robust) Covariance (Debiased: False, GLS: True)
</pre></div></div> </div> <p>Other supported covariance estiamtors include <code class="docutils literal notranslate"><span class=pre >"kernel</span></code>” which implements a HAC and <code class="docutils literal notranslate"><span class=pre >"clustered"</span></code> which permists 1 and 2-way clustering.</p> <h4 id="Kernel-(HAC)">Kernel (HAC)<a class=headerlink  href="#Kernel-(HAC)" title="Permalink to this headline">¶</a></h4> <p>The supported kernels are <code class="docutils literal notranslate"><span class=pre >"bartlett"</span></code> (Newey-West), <code class="docutils literal notranslate"><span class=pre >"parzen"</span></code> (Gallant), and <code class="docutils literal notranslate"><span class=pre >qs</span></code> (Quadratic Spectral, Andrews). This example uses the Parzen kernel. The kernel”s handwidth is computed automatically if the parameter <code class="docutils literal notranslate"><span class=pre >bandwidth</span></code> is not provided.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[22]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >hac_res</span> <span class=o >=</span> <span class=n >fmod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"kernel"</span><span class=p >,</span> <span class=n >kernel</span><span class=o >=</span><span class=s2 >"parzen"</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >hac_res</span><span class=o >.</span><span class=n >summary</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy's R-squared:                 0.2762
No. Observations:                 616   Judge's (OLS) R-squared:             0.1685
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.4504
Time:                        20:11:42   Dhrymes's R-squared:                 0.1685
                                        Cov. Estimator:                      kernel
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5240     0.3330    -7.5799     0.0000     -3.1766     -1.8713
educ           0.5000     0.0231     21.627     0.0000      0.4547      0.5453
exper         -0.0212     0.0534    -0.3965     0.6917     -0.1258      0.0834
expersq        0.0032     0.0014     2.3402     0.0193      0.0005      0.0060
union          1.1043     0.0586     18.853     0.0000      0.9895      1.2191
nrtheast      -0.5343     0.3461    -1.5435     0.1227     -1.2127      0.1442
white          1.1320     0.4159     2.7218     0.0065      0.3169      1.9472
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8231     0.2643    -3.1150     0.0018     -1.3411     -0.3052
educ           0.0791     0.0190     4.1726     0.0000      0.0419      0.1162
exper          0.0260     0.0181     1.4381     0.1504     -0.0094      0.0613
expersq       -0.0005     0.0004    -1.1910     0.2337     -0.0014      0.0003
tenure         0.0494     0.0183     2.7025     0.0069      0.0136      0.0852
tenuresq      -0.0010     0.0007    -1.4289     0.1530     -0.0023      0.0004
union          0.3766     0.1361     2.7665     0.0057      0.1098      0.6434
male           0.2141     0.1166     1.8358     0.0664     -0.0145      0.4426
==============================================================================

Covariance Estimator:
Kernel (HAC) Covariance (Debiased: False, GLS: True, Kernel: parzen)
</pre></div></div> </div> <h4 id="Clustered-(Rogers)">Clustered (Rogers)<a class=headerlink  href="#Clustered-(Rogers)" title="Permalink to this headline">¶</a></h4> <p>The clustered covariance estimator requires the clusters to be entered as a NumPy array with shape <code class="docutils literal notranslate"><span class=pre >(nobs,</span> <span class=pre >1)</span></code> or <code class="docutils literal notranslate"><span class=pre >(nobs,</span> <span class=pre >2)</span></code>. This example uses random clusters to illustrate the structure of the group id variable.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[23]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >rs</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >random</span><span class=o >.</span><span class=n >RandomState</span><span class=p >([</span><span class=mi >983476381</span><span class=p >,</span> <span class=mi >28390328</span><span class=p >,</span> <span class=mi >23829810</span><span class=p >])</span>
<span class=n >random_clusters</span> <span class=o >=</span> <span class=n >rs</span><span class=o >.</span><span class=n >randint</span><span class=p >(</span><span class=mi >0</span><span class=p >,</span> <span class=mi >51</span><span class=p >,</span> <span class=n >size</span><span class=o >=</span><span class=p >(</span><span class=mi >616</span><span class=p >,</span><span class=mi >1</span><span class=p >))</span>
<span class=n >clustered_res</span> <span class=o >=</span> <span class=n >fmod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"clustered"</span><span class=p >,</span> <span class=n >clusters</span><span class=o >=</span><span class=n >random_clusters</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >clustered_res</span><span class=o >.</span><span class=n >summary</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.1685
No. Equations.:                     2   McElroy's R-squared:                 0.2762
No. Observations:                 616   Judge's (OLS) R-squared:             0.1685
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.4504
Time:                        20:11:42   Dhrymes's R-squared:                 0.1685
                                        Cov. Estimator:                   clustered
                                        Num. Constraints:                      None
                 Equation: hrearn, Dependent Variable: hrearn
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -2.5240     0.2708    -9.3215     0.0000     -3.0547     -1.9933
educ           0.5000     0.0192     26.011     0.0000      0.4623      0.5377
exper         -0.0212     0.0530    -0.3996     0.6895     -0.1250      0.0826
expersq        0.0032     0.0014     2.3581     0.0184      0.0005      0.0059
union          1.1043     0.0602     18.329     0.0000      0.9862      1.2224
nrtheast      -0.5343     0.2792    -1.9135     0.0557     -1.0815      0.0130
white          1.1320     0.3485     3.2483     0.0012      0.4490      1.8150
                 Equation: hrbens, Dependent Variable: hrbens
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.8231     0.2169    -3.7957     0.0001     -1.2482     -0.3981
educ           0.0791     0.0155     5.0942     0.0000      0.0487      0.1095
exper          0.0260     0.0168     1.5421     0.1230     -0.0070      0.0590
expersq       -0.0005     0.0004    -1.2518     0.2106     -0.0014      0.0003
tenure         0.0494     0.0214     2.3117     0.0208      0.0075      0.0913
tenuresq      -0.0010     0.0009    -1.1203     0.2626     -0.0027      0.0007
union          0.3766     0.1009     3.7310     0.0002      0.1788      0.5745
male           0.2141     0.0644     3.3230     0.0009      0.0878      0.3403
==============================================================================

Covariance Estimator:
Heteroskedastic (Robust) Covariance (Debiased: False, GLS: True, Number of Grouping Variables: 1, Number of Groups: 51 (Variable 0), Group Debias: False)
</pre></div></div> </div> <h2 id=Prespecified-Residual-Covariance-Estimators >Prespecified Residual Covariance Estimators<a class=headerlink  href="#Prespecified-Residual-Covariance-Estimators" title="Permalink to this headline">¶</a></h2> <p>The GLS estimator can be used with a user specified covariance. This example uses a covariance where all correlations are identical (equicorrelation) in the state GDP model. The estimator must be used when constructing the model through the <code class="docutils literal notranslate"><span class=pre >sigma</span></code> keyword argument.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[24]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >avg_corr</span> <span class=o >=</span> <span class=p >(</span><span class=n >corr</span> <span class=o >-</span> <span class=n >np</span><span class=o >.</span><span class=n >eye</span><span class=p >(</span><span class=mi >9</span><span class=p >))</span><span class=o >.</span><span class=n >mean</span><span class=p >()</span><span class=o >.</span><span class=n >mean</span><span class=p >()</span> <span class=o >*</span> <span class=p >(</span><span class=mi >81</span><span class=o >/</span><span class=mi >72</span><span class=p >)</span>
<span class=n >rho</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >ones</span><span class=p >((</span><span class=mi >9</span><span class=p >,</span><span class=mi >9</span><span class=p >))</span> <span class=o >*</span> <span class=n >avg_corr</span>  <span class=o >+</span> <span class=p >(</span><span class=mi >1</span><span class=o >-</span><span class=n >avg_corr</span><span class=p >)</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >eye</span><span class=p >(</span><span class=mi >9</span><span class=p >)</span>
<span class=n >sigma_pre</span> <span class=o >=</span> <span class=n >rho</span> <span class=o >*</span> <span class=p >(</span><span class=n >std</span> <span class=o >@</span> <span class=n >std</span><span class=o >.</span><span class=n >T</span><span class=p >)</span>

<span class=n >mod_pre_sigma</span> <span class=o >=</span> <span class=n >SUR</span><span class=p >(</span><span class=n >mod_data</span><span class=p >,</span> <span class=n >sigma</span><span class=o >=</span><span class=n >sigma_pre</span><span class=p >)</span>
<span class=n >res_pre</span> <span class=o >=</span> <span class=n >mod_pre_sigma</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"unadjusted"</span><span class=p >,</span> <span class=n >debiased</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res_pre</span><span class=o >.</span><span class=n >equations</span><span class=p >[</span><span class=s2 >"GF"</span><span class=p >])</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                            GLS Estimation Summary
==============================================================================
Eq. Label:                         GF   R-squared:                      0.9966
Dep. Variable:                  lnGSP   Adj. R-squared:                 0.9945
Estimator:                        GLS   Cov. Estimator:             unadjusted
No. Observations:                  17   F-statistic:                    549.95
Date:                Mon, Feb 17 2020   P-value (F-stat)                0.0000
Time:                        20:11:42   Distribution:                  F(6,90)

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      7.9753     4.3819     1.8200     0.0988     -1.7883      17.739
lnPC           0.1011     0.2727     0.3708     0.7185     -0.5065      0.7087
lnHWY         -0.9882     1.0313    -0.9582     0.3606     -3.2862      1.3098
lnWATER        0.0791     0.1134     0.6971     0.5016     -0.1736      0.3318
lnUTIL         0.5160     0.7720     0.6685     0.5190     -1.2040      2.2361
lnEMP          0.8494     0.1426     5.9557     0.0001      0.5316      1.1671
UNEMP         -0.0057     0.0034    -1.6466     0.1307     -0.0134      0.0020

==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: True, GLS: True)
</pre></div></div> </div> <h3 id=Diagonal-Residual-Covariance >Diagonal Residual Covariance<a class=headerlink  href="#Diagonal-Residual-Covariance" title="Permalink to this headline">¶</a></h3> <p>The default assumption is that there can be arbitrary correlation between series. The model can be estimated assuming no correlation but different variance by setting the keyword argument <code class="docutils literal notranslate"><span class=pre >full_cov=False</span></code> in the <code class="docutils literal notranslate"><span class=pre >fit</span></code> method. This is only useful when there are cross-equation parameter restrictions.</p> <h2 id=Cross-Equation-Restrictions >Cross-Equation Restrictions<a class=headerlink  href="#Cross-Equation-Restrictions" title="Permalink to this headline">¶</a></h2> <p>One of the more useful features of using a SUR to estimate a system is the ability to impose constraints on parameters across equations. Here only linear constraints of the form</p> <div class="math notranslate nohighlight"> \[r \beta = q\]</div> <p>are supported. Linear constraints are entered by passing a <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code> with the shape number of constraints by number of parameters. The number and name of parameters can be seen by inspecting the <code class="docutils literal notranslate"><span class=pre >param_names</span></code> attribute of a model. Below are the parameter names from the state GDP model which consist of the equation label, an underscore, and the variable name. This ensures uniqueness.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[25]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >mod</span><span class=o >.</span><span class=n >param_names</span><span class=p >[:</span><span class=mi >14</span><span class=p >]</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[25]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
['GF_Intercept',
 'GF_lnPC',
 'GF_lnHWY',
 'GF_lnWATER',
 'GF_lnUTIL',
 'GF_lnEMP',
 'GF_UNEMP',
 'SW_Intercept',
 'SW_lnPC',
 'SW_lnHWY',
 'SW_lnWATER',
 'SW_lnUTIL',
 'SW_lnEMP',
 'SW_UNEMP']
</pre></div></div> </div> <p>The example of a parameter constraint will enforce a common value of the coefficient of unemployment in all equations. This restriction takes the form</p> <div class="math notranslate nohighlight"> \[\beta_{unemp,i} - \beta_{unemp,j} = 0\]</div> <p>where in all examples i is the first series and j is one of the 8 others. In total there are 8 restrictions.</p> <p>The construction of the restriction array and the non-zero columns are shown below.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[26]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >r</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >(</span><span class=n >columns</span><span class=o >=</span><span class=n >mod</span><span class=o >.</span><span class=n >param_names</span><span class=p >,</span> <span class=n >index</span><span class=o >=</span><span class=p >[</span><span class=s2 >"rest</span><span class=si >{0}</span><span class=s2 >"</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=n >i</span><span class=p >)</span> <span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >8</span><span class=p >)],</span> <span class=n >dtype</span><span class=o >=</span><span class=n >np</span><span class=o >.</span><span class=n >float64</span><span class=p >)</span>
<span class=n >r</span><span class=o >.</span><span class=n >loc</span><span class=p >[:,:]</span> <span class=o >=</span> <span class=mf >0.0</span>
<span class=n >r</span><span class=o >.</span><span class=n >iloc</span><span class=p >[:,</span><span class=mi >6</span><span class=p >]</span> <span class=o >=</span> <span class=o >-</span><span class=mf >1.0</span>
<span class=n >r</span><span class=o >.</span><span class=n >iloc</span><span class=p >[:,</span><span class=mi >13</span><span class=p >::</span><span class=mi >7</span><span class=p >]</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >eye</span><span class=p >(</span><span class=mi >8</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >r</span><span class=o >.</span><span class=n >iloc</span><span class=p >[:,</span><span class=mi >6</span><span class=p >::</span><span class=mi >7</span><span class=p >])</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
       GF_UNEMP  SW_UNEMP  WC_UNEMP  MT_UNEMP  NE_UNEMP  MA_UNEMP  SO_UNEMP  \
rest0      -1.0       1.0       0.0       0.0       0.0       0.0       0.0
rest1      -1.0       0.0       1.0       0.0       0.0       0.0       0.0
rest2      -1.0       0.0       0.0       1.0       0.0       0.0       0.0
rest3      -1.0       0.0       0.0       0.0       1.0       0.0       0.0
rest4      -1.0       0.0       0.0       0.0       0.0       1.0       0.0
rest5      -1.0       0.0       0.0       0.0       0.0       0.0       1.0
rest6      -1.0       0.0       0.0       0.0       0.0       0.0       0.0
rest7      -1.0       0.0       0.0       0.0       0.0       0.0       0.0

       MW_UNEMP  CN_UNEMP
rest0       0.0       0.0
rest1       0.0       0.0
rest2       0.0       0.0
rest3       0.0       0.0
rest4       0.0       0.0
rest5       0.0       0.0
rest6       1.0       0.0
rest7       0.0       1.0
</pre></div></div> </div> <p>The constraint can be added to an existing model using the <code class="docutils literal notranslate"><span class=pre >add_constraint</span></code> method. This method requires one input, <code class="docutils literal notranslate"><span class=pre >r</span></code> and optionally <code class="docutils literal notranslate"><span class=pre >q</span></code>. if <code class="docutils literal notranslate"><span class=pre >q</span></code> is not provided, it is set to 0.</p> <p>Here the constraint is added, the model is estimated, and the parameters for unemployment are displayed. They all have the same value.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[27]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >mod</span><span class=o >.</span><span class=n >add_constraints</span><span class=p >(</span><span class=n >r</span><span class=p >)</span>
<span class=n >constrained_res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=n >constrained_res</span><span class=o >.</span><span class=n >params</span><span class=p >[</span><span class=mi >6</span><span class=p >::</span><span class=mi >7</span><span class=p >]</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[27]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
GF_UNEMP   -0.005801
SW_UNEMP   -0.005801
WC_UNEMP   -0.005801
MT_UNEMP   -0.005801
NE_UNEMP   -0.005801
MA_UNEMP   -0.005801
SO_UNEMP   -0.005801
MW_UNEMP   -0.005801
CN_UNEMP   -0.005801
Name: params, dtype: float64
</pre></div></div> </div> <h3 id=Pooling-using-constraints >Pooling using constraints<a class=headerlink  href="#Pooling-using-constraints" title="Permalink to this headline">¶</a></h3> <p>More complicated constraints can be used to produce interesting models. Using the same idea as the previous set of constraints, a pooled SUR (excluding the constant) is constructed by restricting all coefficients to have the same value. Here the form of the restriction is</p> <div class="math notranslate nohighlight"> \[\beta_{var,0} - \beta_{var,j} = 0\]</div> <p>so that the restriction is identical to the previous, only applied to all variables excluding the constant.</p> <p>Here the estimated from the first two equations are shown. All coefficients except the intercept are identical across equations.</p> <p><strong>Note</strong>: When linear constraints are imposed, the parameter covariance matrix will be singular. Caution is needed to ensure test statistics are meaningful.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[28]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >r2</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >((</span><span class=mi >8</span><span class=o >*</span><span class=mi >6</span><span class=p >,</span> <span class=n >r</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >1</span><span class=p >]))</span>
<span class=n >loc</span> <span class=o >=</span> <span class=mi >0</span>
<span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >6</span><span class=p >):</span>
    <span class=k >for</span> <span class=n >j</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >8</span><span class=p >):</span>
        <span class=n >r2</span><span class=p >[</span><span class=n >loc</span><span class=p >,</span><span class=n >i</span><span class=o >+</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=o >-</span><span class=mf >1.0</span>
        <span class=n >r2</span><span class=p >[</span><span class=n >loc</span><span class=p >,</span><span class=mi >7</span><span class=o >*</span><span class=p >(</span><span class=n >j</span><span class=o >+</span><span class=mi >1</span><span class=p >)</span> <span class=o >+</span> <span class=n >i</span><span class=o >+</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=mf >1.0</span>
        <span class=n >loc</span> <span class=o >+=</span> <span class=mi >1</span>
<span class=n >r2</span><span class=o >=</span><span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >(</span><span class=n >r2</span><span class=p >,</span> <span class=n >columns</span><span class=o >=</span><span class=n >mod</span><span class=o >.</span><span class=n >param_names</span><span class=p >)</span>
<span class=n >mod</span><span class=o >.</span><span class=n >reset_constraints</span><span class=p >()</span>
<span class=n >mod</span><span class=o >.</span><span class=n >add_constraints</span><span class=p >(</span><span class=n >r2</span><span class=p >)</span>
<span class=n >pooled_res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=s2 >"</span><span class=se >\n</span><span class=s2 >"</span><span class=o >.</span><span class=n >join</span><span class=p >(</span><span class=n >pooled_res</span><span class=o >.</span><span class=n >summary</span><span class=o >.</span><span class=n >as_text</span><span class=p >()</span><span class=o >.</span><span class=n >split</span><span class=p >(</span><span class=s2 >"</span><span class=se >\n</span><span class=s2 >"</span><span class=p >)[:</span><span class=mi >33</span><span class=p >]))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.9777
No. Equations.:                     9   McElroy's R-squared:                 0.9891
No. Observations:                  17   Judge's (OLS) R-squared:             0.9777
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.9974
Time:                        20:11:42   Dhrymes's R-squared:                 0.9777
                                        Cov. Estimator:                      robust
                                        Num. Constraints:                        48
                   Equation: GF, Dependent Variable: lnGSP
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      0.2732     76.867     0.0036     0.9972     -150.38      150.93
lnPC           0.3639     6.5960     0.0552     0.9560     -12.564      13.292
lnHWY          0.3103     7.8148     0.0397     0.9683     -15.006      15.627
lnWATER        0.0805     4.2554     0.0189     0.9849     -8.2599      8.4210
lnUTIL        -0.1733     5.1094    -0.0339     0.9729     -10.188      9.8410
lnEMP          0.6142     9.2501     0.0664     0.9471     -17.516      18.744
UNEMP         -0.0128     0.1933    -0.0661     0.9473     -0.3916      0.3660
                   Equation: SW, Dependent Variable: lnGSP
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Intercept      0.2869     78.263     0.0037     0.9971     -153.11      153.68
lnPC           0.3639     6.5960     0.0552     0.9560     -12.564      13.292
lnHWY          0.3103     7.8148     0.0397     0.9683     -15.006      15.627
lnWATER        0.0805     4.2554     0.0189     0.9849     -8.2599      8.4210
lnUTIL        -0.1733     5.1094    -0.0339     0.9729     -10.188      9.8410
lnEMP          0.6142     9.2501     0.0664     0.9471     -17.516      18.744
UNEMP         -0.0128     0.1933    -0.0661     0.9473     -0.3916      0.3660
                   Equation: WC, Dependent Variable: lnGSP
==============================================================================
</pre></div></div> </div> <h2 id=Multivariate-OLS >Multivariate OLS<a class=headerlink  href="#Multivariate-OLS" title="Permalink to this headline">¶</a></h2> <p>One final feature worth demonstrating is a simple interface for specifying multivariate OLS models. These models have the same regressors and so it is possible to specify them with two arrays. The first is a <span class="math notranslate nohighlight">\(T\)</span> by <span class="math notranslate nohighlight">\(K\)</span> array of dependent variables where each column contains a dependent variable. The second contains the common exogenous regressors.</p> <p>This example shows how a CAPM can be estimated as a MV OLS.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[29]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >import</span> <span class=nn >statsmodels.api</span> <span class=k >as</span> <span class=nn >sm</span>
<span class=kn >from</span> <span class=nn >linearmodels.datasets</span> <span class=kn >import</span> <span class=n >french</span>
<span class=n >data</span> <span class=o >=</span> <span class=n >french</span><span class=o >.</span><span class=n >load</span><span class=p >()</span>
<span class=n >factors</span> <span class=o >=</span> <span class=n >sm</span><span class=o >.</span><span class=n >add_constant</span><span class=p >(</span><span class=n >data</span><span class=p >[[</span><span class=s2 >"MktRF"</span><span class=p >]])</span>
<span class=n >mv_ols</span> <span class=o >=</span> <span class=n >SUR</span><span class=o >.</span><span class=n >multivariate_ls</span><span class=p >(</span><span class=n >data</span><span class=p >[[</span><span class=s2 >"S1V1"</span><span class=p >,</span><span class=s2 >"S1V3"</span><span class=p >,</span><span class=s2 >"S1V5"</span><span class=p >,</span><span class=s2 >"S5V1"</span><span class=p >,</span><span class=s2 >"S5V3"</span><span class=p >,</span><span class=s2 >"S5V5"</span><span class=p >]],</span> <span class=n >factors</span><span class=p >)</span>
<span class=n >mv_ols_res</span> <span class=o >=</span> <span class=n >mv_ols</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"unadjusted"</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mv_ols_res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System OLS Estimation Summary
===================================================================================
Estimator:                        OLS   Overall R-squared:                   0.6564
No. Equations.:                     6   McElroy's R-squared:                 0.8776
No. Observations:                 819   Judge's (OLS) R-squared:             0.6564
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.9773
Time:                        20:11:42   Dhrymes's R-squared:                 0.6564
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                   Equation: S1V1, Dependent Variable: S1V1
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.0020     0.0017    -1.1608     0.2457     -0.0054      0.0014
MktRF          1.3736     0.0403     34.101     0.0000      1.2947      1.4526
                   Equation: S1V3, Dependent Variable: S1V3
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0048     0.0012     4.0973     0.0000      0.0025      0.0072
MktRF          1.0711     0.0276     38.879     0.0000      1.0171      1.1251
                   Equation: S1V5, Dependent Variable: S1V5
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0082     0.0013     6.5142     0.0000      0.0057      0.0106
MktRF          1.0538     0.0293     36.019     0.0000      0.9965      1.1111
                   Equation: S5V1, Dependent Variable: S5V1
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0032     0.0005     5.8787     0.0000      0.0021      0.0042
MktRF          0.9861     0.0126     78.376     0.0000      0.9615      1.0108
                   Equation: S5V3, Dependent Variable: S5V3
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0052     0.0007     7.4953     0.0000      0.0039      0.0066
MktRF          0.8472     0.0162     52.204     0.0000      0.8154      0.8790
                   Equation: S5V5, Dependent Variable: S5V5
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0051     0.0011     4.5167     0.0000      0.0029      0.0073
MktRF          0.9851     0.0263     37.515     0.0000      0.9337      1.0366
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: False)
</pre></div></div> </div> <h3 id=Using-GLS-with-common-regressors >Using GLS with common regressors<a class=headerlink  href="#Using-GLS-with-common-regressors" title="Permalink to this headline">¶</a></h3> <p>As noted previously, forcing GLS has no effect (except on changing the <span class="math notranslate nohighlight">\(R^2\)</span>). This can be seen below.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[30]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=nb >print</span><span class=p >(</span><span class=n >mv_ols</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=s2 >"unadjusted"</span><span class=p >,</span> <span class=n >method</span><span class=o >=</span><span class=s2 >"gls"</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                           System GLS Estimation Summary
===================================================================================
Estimator:                        GLS   Overall R-squared:                   0.6564
No. Equations.:                     6   McElroy's R-squared:                 0.8776
No. Observations:                 819   Judge's (OLS) R-squared:             0.6564
Date:                Mon, Feb 17 2020   Berndt's R-squared:                  0.9773
Time:                        20:11:42   Dhrymes's R-squared:                 0.6564
                                        Cov. Estimator:                  unadjusted
                                        Num. Constraints:                      None
                   Equation: S1V1, Dependent Variable: S1V1
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.0020     0.0017    -1.1608     0.2457     -0.0054      0.0014
MktRF          1.3736     0.0403     34.101     0.0000      1.2947      1.4526
                   Equation: S1V3, Dependent Variable: S1V3
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0048     0.0012     4.0973     0.0000      0.0025      0.0072
MktRF          1.0711     0.0276     38.879     0.0000      1.0171      1.1251
                   Equation: S1V5, Dependent Variable: S1V5
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0082     0.0013     6.5142     0.0000      0.0057      0.0106
MktRF          1.0538     0.0293     36.019     0.0000      0.9965      1.1111
                   Equation: S5V1, Dependent Variable: S5V1
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0032     0.0005     5.8787     0.0000      0.0021      0.0042
MktRF          0.9861     0.0126     78.376     0.0000      0.9615      1.0108
                   Equation: S5V3, Dependent Variable: S5V3
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0052     0.0007     7.4953     0.0000      0.0039      0.0066
MktRF          0.8472     0.0162     52.204     0.0000      0.8154      0.8790
                   Equation: S5V5, Dependent Variable: S5V5
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0051     0.0011     4.5167     0.0000      0.0029      0.0073
MktRF          0.9851     0.0263     37.515     0.0000      0.9337      1.0366
==============================================================================

Covariance Estimator:
Homoskedastic (Unadjusted) Covariance (Debiased: False, GLS: True)
</pre></div></div> </div> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> <a href="../index.html" title=Material  class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev > <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Previous </span> System Regression Models </span> </div> </a> <a href=formulas.html  title=Admonition  class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next > <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Next </span> Using formulas to specify models </span> </div> <div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2017, Kevin Sheppard. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 2.4.1. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>