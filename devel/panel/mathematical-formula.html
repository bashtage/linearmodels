<!DOCTYPE html> <html lang=en > <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.18.1: http://docutils.sourceforge.net/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../_static/javascripts/modernizr.js"></script> <title>Formulas and Mathematical Detail &#8212; linearmodels 4.28.dev7+g3e0389bc4 documentation</title> <link rel=apple-touch-icon  sizes=180x180  href="../_static/icons/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="../_static/icons/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="../_static/icons/favicon-16x16.png"> <link rel=manifest  href="../_static/icons/site.webmanifest"> <link rel=mask-icon  href="../_static/icons/safari-pinned-tab.svg" color="#2196f3"> <link rel="shortcut icon" href="../_static/icons/favicon.ico"> <meta name=msapplication-TileColor  content="#f8f8f8"> <meta name=msapplication-config  content="../_static/icons/browserconfig.xml"> <style> .highlight { background-color: hsla(0,0%,92.5%,.5) !important; } </style> <link rel=stylesheet  type="text/css" href="../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../_static/material.css" /> <script data-url_root="../" id=documentation_options  src="../_static/documentation_options.js"></script> <script src="../_static/jquery.js"></script> <script src="../_static/underscore.js"></script> <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script> <script src="../_static/doctools.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <script defer=defer  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel="shortcut icon" href="../_static/favicon.ico"/> <link rel=index  title=Index  href="../genindex.html" /> <link rel=search  title=Search  href="../search.html" /> <link rel=next  title="Implementation Choices" href=faq.html  /> <link rel=prev  title=linearmodels.panel.utility.PanelModelData.weights  href="panel/linearmodels.panel.utility.PanelModelData.weights.html" /> <body dir=ltr data-md-color-primary=blue data-md-color-accent=orange> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#panel/mathematical-formula" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../index.html" title="linearmodels 4.28.dev7+g3e0389bc4 documentation" class="md-header-nav__button md-logo"> <img src="../_static/bw-logo.svg" height=26  alt="linearmodels 4.28.dev7+g3e0389bc4 documentation logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >linearmodels v4.28 (+7)</span> <span class=md-header-nav__topic > Formulas and Mathematical Detail </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> </div> <div class="md-flex__cell md-flex__cell--shrink dropdown"> <button class=dropdownbutton >Versions</button> <div class="dropdown-content md-hero"> <a title=Release  href="https://bashtage.github.io/linearmodels/">Release</a> <a title=Development  href="https://bashtage.github.io/linearmodels/devel/">Development</a> </div> </div> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href=index.html  class=md-tabs__link >Panel Data Model Estimation</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../index.html" title="linearmodels 4.28.dev7+g3e0389bc4 documentation" class="md-nav__button md-logo"> <img src="../_static/bw-logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../index.html" title="linearmodels 4.28.dev7+g3e0389bc4 documentation">linearmodels v4.28 (+7)</a> </label> <div class=md-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <a href="../iv/index.html" class=md-nav__link >Instrumental Variable Estimation</a> <li class=md-nav__item > <a href=index.html  class=md-nav__link >Panel Data Model Estimation</a> <ul class=md-nav__list > <li class=md-nav__item > <a href=introduction.html  class=md-nav__link >Introduction</a> <li class=md-nav__item > <a href="examples/data-formats.html" class=md-nav__link >Data Formats for Panel Data Analysis</a> <li class=md-nav__item > <a href="examples/examples.html" class=md-nav__link >Examples</a> <li class=md-nav__item > <a href="examples/using-formulas.html" class=md-nav__link >Using formulas to specify models</a> <li class=md-nav__item > <a href=pandas.html  class=md-nav__link >Comparison with pandas PanelOLS and FamaMacBeth</a> <li class=md-nav__item > <a href=reference.html  class=md-nav__link >Module Reference</a> <li class=md-nav__item > <input class="md-toggle md-nav__toggle" data-md-toggle=toc  type=checkbox  id=__toc > <label class="md-nav__link md-nav__link--active" for=__toc > Formulas and Mathematical Detail </label> <a href="#" class="md-nav__link md-nav__link--active">Formulas and Mathematical Detail</a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#panel-mathematical-formula--page-root" class=md-nav__link >Formulas and Mathematical Detail</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#models" class=md-nav__link >Models</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#fixed-effect-estimation-panelols" class=md-nav__link >Fixed Effect Estimation (PanelOLS)</a> <li class=md-nav__item ><a href="#random-effect-estimation-randomeffects" class=md-nav__link >Random Effect Estimation (RandomEffects)</a> <li class=md-nav__item ><a href="#between-estimation-betweenols" class=md-nav__link >Between Estimation (BetweenOLS)</a> <li class=md-nav__item ><a href="#first-difference-estimation-firstdifferenceols" class=md-nav__link >First Difference Estimation (FirstDifferenceOLS)</a> <li class=md-nav__item ><a href="#pooled-model-estimation-pooledols" class=md-nav__link >Pooled Model Estimation (PooledOLS)</a> </ul> </nav> <li class=md-nav__item ><a href="#covariance-estimators" class=md-nav__link >Covariance Estimators</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#standard-covariance-estimator-unadjusted" class=md-nav__link >Standard Covariance Estimator (unadjusted)</a> <li class=md-nav__item ><a href="#heteroskedastic-covariance-estimator-robust" class=md-nav__link >Heteroskedastic Covariance Estimator (robust)</a> <li class=md-nav__item ><a href="#clustered-covariance-estimator" class=md-nav__link >Clustered Covariance Estimator</a> <li class=md-nav__item ><a href="#driscoll-kraay-covariance-estimator" class=md-nav__link >Driscoll-Kraay Covariance Estimator</a> </ul> </nav> <li class=md-nav__item ><a href="#r-2-calculation" class=md-nav__link ><span class="math notranslate nohighlight">\(R^{2}\)</span> Calculation</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#between-r-2" class=md-nav__link >Between <span class="math notranslate nohighlight">\(R^{2}\)</span></a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#betweenr-2-correlation-method" class=md-nav__link >Between<span class="math notranslate nohighlight">\(R^{2}\)</span> (correlation method)</a> </ul> </nav> <li class=md-nav__item ><a href="#overall-r-2" class=md-nav__link >Overall <span class="math notranslate nohighlight">\(R^{2}\)</span></a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#overall-r-2-correlation-method" class=md-nav__link >Overall <span class="math notranslate nohighlight">\(R^{2}\)</span> (correlation method)</a> </ul> </nav> <li class=md-nav__item ><a href="#within-r-2" class=md-nav__link >Within <span class="math notranslate nohighlight">\(R^{2}\)</span></a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#withinr-2-correlation-method" class=md-nav__link >Within<span class="math notranslate nohighlight">\(R^{2}\)</span> (correlation method)</a> </ul> </nav> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../_sources/panel/mathematical-formula.rst.txt">Show Source</a> </ul> </nav> <li class=md-nav__item > <a href=faq.html  class=md-nav__link >Implementation Choices</a> </ul> <li class=md-nav__item > <a href="../asset-pricing/index.html" class=md-nav__link >Linear Factor Models for Asset Pricing</a> <li class=md-nav__item > <a href="../system/index.html" class=md-nav__link >System Regression Models</a> <li class=md-nav__item > <a href="../utility.html" class=md-nav__link >Utilities</a> <li class=md-nav__item > <a href="../compatibility.html" class=md-nav__link >Compatibility</a> <li class=md-nav__item > <a href="../plan.html" class=md-nav__link >Module Plans</a> <li class=md-nav__item > <a href="../contributing.html" class=md-nav__link >Contributing</a> <li class=md-nav__item > <a href="../changes.html" class=md-nav__link >Change Log</a> <li class=md-nav__item > <a href="../references.html" class=md-nav__link >References</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#panel-mathematical-formula--page-root" class=md-nav__link >Formulas and Mathematical Detail</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#models" class=md-nav__link >Models</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#fixed-effect-estimation-panelols" class=md-nav__link >Fixed Effect Estimation (PanelOLS)</a> <li class=md-nav__item ><a href="#random-effect-estimation-randomeffects" class=md-nav__link >Random Effect Estimation (RandomEffects)</a> <li class=md-nav__item ><a href="#between-estimation-betweenols" class=md-nav__link >Between Estimation (BetweenOLS)</a> <li class=md-nav__item ><a href="#first-difference-estimation-firstdifferenceols" class=md-nav__link >First Difference Estimation (FirstDifferenceOLS)</a> <li class=md-nav__item ><a href="#pooled-model-estimation-pooledols" class=md-nav__link >Pooled Model Estimation (PooledOLS)</a> </ul> </nav> <li class=md-nav__item ><a href="#covariance-estimators" class=md-nav__link >Covariance Estimators</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#standard-covariance-estimator-unadjusted" class=md-nav__link >Standard Covariance Estimator (unadjusted)</a> <li class=md-nav__item ><a href="#heteroskedastic-covariance-estimator-robust" class=md-nav__link >Heteroskedastic Covariance Estimator (robust)</a> <li class=md-nav__item ><a href="#clustered-covariance-estimator" class=md-nav__link >Clustered Covariance Estimator</a> <li class=md-nav__item ><a href="#driscoll-kraay-covariance-estimator" class=md-nav__link >Driscoll-Kraay Covariance Estimator</a> </ul> </nav> <li class=md-nav__item ><a href="#r-2-calculation" class=md-nav__link ><span class="math notranslate nohighlight">\(R^{2}\)</span> Calculation</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#between-r-2" class=md-nav__link >Between <span class="math notranslate nohighlight">\(R^{2}\)</span></a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#betweenr-2-correlation-method" class=md-nav__link >Between<span class="math notranslate nohighlight">\(R^{2}\)</span> (correlation method)</a> </ul> </nav> <li class=md-nav__item ><a href="#overall-r-2" class=md-nav__link >Overall <span class="math notranslate nohighlight">\(R^{2}\)</span></a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#overall-r-2-correlation-method" class=md-nav__link >Overall <span class="math notranslate nohighlight">\(R^{2}\)</span> (correlation method)</a> </ul> </nav> <li class=md-nav__item ><a href="#within-r-2" class=md-nav__link >Within <span class="math notranslate nohighlight">\(R^{2}\)</span></a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#withinr-2-correlation-method" class=md-nav__link >Within<span class="math notranslate nohighlight">\(R^{2}\)</span> (correlation method)</a> </ul> </nav> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../_sources/panel/mathematical-formula.rst.txt">Show Source</a> <li id=searchbox  class=md-nav__item > </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <section id=formulas-and-mathematical-detail > <span id=panel-mathematical-notation ></span><h1 id=panel-mathematical-formula--page-root >Formulas and Mathematical Detail<a class=headerlink  href="#panel-mathematical-formula--page-root" title="Permalink to this heading">¶</a></h1> <section id=models > <h2 id=models >Models<a class=headerlink  href="#models" title="Permalink to this heading">¶</a></h2> <p>The estimators in this module are designed to estimate the parameters of a model specified by</p> <div class="math notranslate nohighlight"> \[y_{it}=x_{it}\beta+\alpha_{i}+\epsilon_{it}\]</div> <p>where <span class="math notranslate nohighlight">\(i\)</span> indexes entities and <span class="math notranslate nohighlight">\(t\)</span> indexes time, <span class="math notranslate nohighlight">\(x_{it}\)</span>is <span class="math notranslate nohighlight">\(1\)</span> by <span class="math notranslate nohighlight">\(k\)</span> (may include a constant, but not for all models), <span class="math notranslate nohighlight">\(\beta\)</span> is <span class="math notranslate nohighlight">\(k\)</span> by 1, <span class="math notranslate nohighlight">\(\alpha_{i}\)</span> is an entity-specific shock and <span class="math notranslate nohighlight">\(\epsilon_{it}\)</span> is an idiosyncratic shock. The most important difference in the models is the assumptions on <span class="math notranslate nohighlight">\(\alpha_{i}\)</span> which determine whether the estimator is consistent and/or efficient. There are <span class="math notranslate nohighlight">\(N\)</span> entities and <span class="math notranslate nohighlight">\(T_{i}\)</span> observations for entity <span class="math notranslate nohighlight">\(i\)</span>.</p> <section id=fixed-effect-estimation-panelols > <h3 id=fixed-effect-estimation-panelols >Fixed Effect Estimation (PanelOLS)<a class=headerlink  href="#fixed-effect-estimation-panelols" title="Permalink to this heading">¶</a></h3> <p>The fixed effect estimator with entity effects estimates the model</p> <div class="math notranslate nohighlight"> \[y_{it}-\bar{y}_{i}=(x_{it}-x_{i})\beta+\left(\epsilon_{it}-\bar{\epsilon}_{i}\right).\]</div> <p>When the model includes a constant in <span class="math notranslate nohighlight">\(x_{it}\)</span> then the grand mean of <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(\bar{\bar{y}}=(NT)^{-1}\sum_{i=1}^{N}\sum_{t=1}^{T_{i}}y_{it}\)</span>, and <span class="math notranslate nohighlight">\(x\)</span> are re-added to the <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span> terms, respectively. In practice this imposes the restriction that <span class="math notranslate nohighlight">\(\sum\alpha_{i}=0\)</span>. The estimated coefficients for the remaining parameters are identical as is the estimated parameter covariance and related statistics.</p> <p>The fixed effects estimator can handle general fixed effects, not just entity. While it has special cases that simplify adding entity and/or time effects, general effects can also be used. For example, one might want to use industry effect rather than firm effects. Generally the fixed effect model can be expressed as a least squares dummy variable (LSDV) estimator of the form</p> <div class="math notranslate nohighlight"> \[y_{it}=x_{it}\beta+d_{1,it}\gamma_{1}+d_{2,it}\gamma_{2}\]</div> <p>where <span class="math notranslate nohighlight">\(d_{1,it}\)</span> and <span class="math notranslate nohighlight">\(d_{2,it}\)</span> are the dummy variables for the first and second effect. When the model contains an intercept, one dummy is dropped form each group and the dummies are orthogonalized to a constant so that they have mean 0. This allows the constant to be estimated. If the model does not contain an intercept, the first group of dummies will contain all values and the second will have one dropped.</p> <p><strong>Weights</strong></p> <p>When weights are used, the results are identical to the LSDV model where all variables – <span class="math notranslate nohighlight">\(y_{it,}\)</span><span class="math notranslate nohighlight">\(x_{it}\)</span>, <span class="math notranslate nohighlight">\(d_{1,it}\)</span> and <span class="math notranslate nohighlight">\(d_{2,it}\)</span>(if included) – are multiplied by <span class="math notranslate nohighlight">\(\sqrt{w_{it}}\)</span>.</p> </section> <section id=random-effect-estimation-randomeffects > <h3 id=random-effect-estimation-randomeffects >Random Effect Estimation (RandomEffects)<a class=headerlink  href="#random-effect-estimation-randomeffects" title="Permalink to this heading">¶</a></h3> <p>The random effects estimator makes use of a quasi-differenced model,</p> <div class="math notranslate nohighlight"> \[y_{it}-\hat{\theta}_{i}\bar{y}_{i}=\left(1-\hat{\theta}_{i}\right)\alpha_{i}+(x_{it}-\hat{\theta}_{i}x_{i})\beta+\left(\epsilon_{it}-\hat{\theta}_{i}\bar{\epsilon}_{i}\right)\]</div> <p>where <span class="math notranslate nohighlight">\(\theta_{i}\)</span> is a function of the variance of <span class="math notranslate nohighlight">\(\epsilon_{it}\)</span> , the variance of <span class="math notranslate nohighlight">\(\alpha_{i}\)</span> and the number of observations for entity <span class="math notranslate nohighlight">\(i\)</span>,</p> <div class="math notranslate nohighlight"> \[\hat{\theta}_{i}=1-\sqrt{\frac{\sigma_{\epsilon}^{2}}{T_{i}\sigma_{\alpha}^{2}+\sigma_{\epsilon}^{2}}}\]</div> <p>so that <span class="math notranslate nohighlight">\(\hat{\theta}_{i}\approx1\)</span> when <span class="math notranslate nohighlight">\(T_{i}\)</span> is large (as long as <span class="math notranslate nohighlight">\(\sigma_{\alpha}^{2}&gt;0\)</span>) or when <span class="math notranslate nohighlight">\(\alpha_{i}\)</span> is the only source of variance. On the other hand, <span class="math notranslate nohighlight">\(\hat{\theta}_{i}\approx0\)</span> when the variation due to <span class="math notranslate nohighlight">\(\alpha_{i}\)</span> is low. The estimator of the idiosyncratic variance is</p> <div class="math notranslate nohighlight"> \[\frac{\sum_{i=1}^{N}\sum_{t=1}^{T_{i}}\hat{\epsilon}_{it}^{2}}{\sum_{i=1}^{N}T_{i}-N-K+c}\]</div> <p>where <span class="math notranslate nohighlight">\(c=1\)</span> if the model includes a constant in the regressors. The variance of <span class="math notranslate nohighlight">\(\alpha_{i}\)</span> is estimated using the residual sum of squares from the between regression (see below), <span class="math notranslate nohighlight">\(RSS_{b}\)</span>,</p> <div class="math notranslate nohighlight"> \[\hat{\sigma}_{\alpha}^{2}=\max\{0,\frac{RSS_{b}}{N-K}-\frac{\hat{\sigma}_{\epsilon}^{2}}{\bar{T}}\}\]</div> <p>where <span class="math notranslate nohighlight">\(\bar{T}=\frac{n}{\sum_{i=1}^{n}T_{i}^{-1}}\)</span>. If the optional argument for a small sample adjustment is used, the Baltagi and Chang (1994) estimator is used. This only has an effect when the data are unbalanced.</p> <p><strong>Weights</strong></p> <p>When weights are included the averages are replaced by weighted averages and the final regression terms are all multiplied by <span class="math notranslate nohighlight">\(\sqrt{w_{it}}\)</span>.</p> </section> <section id=between-estimation-betweenols > <h3 id=between-estimation-betweenols >Between Estimation (BetweenOLS)<a class=headerlink  href="#between-estimation-betweenols" title="Permalink to this heading">¶</a></h3> <p>Between estimation regresses time averages of the dependent variable on the time averaged values of the regressors,</p> <div class="math notranslate nohighlight"> \[\bar{y}_{i}=\bar{x}_{i}\beta+\bar{\epsilon}_{i}.\]</div> <p>When weights are included, weighted averages are used so that</p> <div class="math notranslate nohighlight"> \[\bar{y}_{i}^{w}=\frac{\sum_{t=1}^{T}w_{it}y_{it}}{\sum_{t=1}^{T}w_{it}}\]</div> <p>with <span class="math notranslate nohighlight">\(\bar{x}_{i}\)</span> similarly defined. Note that if the conditional variance of <span class="math notranslate nohighlight">\(y_{it}\propto w_{it}^{-1}\)</span> then the conditional variance of <span class="math notranslate nohighlight">\(\bar{y}_{i}^{w}\propto\frac{1}{\sum w_{i}}\)</span> and these weights are used when regressing the weighted averages. Also note that when <span class="math notranslate nohighlight">\(w_{i}=1\)</span> but the panel is imbalanced than the conditional variance of <span class="math notranslate nohighlight">\(\bar{y}_{i}^{w}=\bar{y}_{i}\propto\frac{1}{T_{i}}\)</span>. Re-weighting unbalanced panels is exposed through the fit option <code class="docutils literal notranslate"><span class=pre >reweight</span></code>.</p> <p><strong>Weights</strong></p> <p>When weights are used, the averages are replaced by weighted averages and reweighting uses the computed variance of the weighted averages in the actual between regression.</p> </section> <section id=first-difference-estimation-firstdifferenceols > <h3 id=first-difference-estimation-firstdifferenceols >First Difference Estimation (FirstDifferenceOLS)<a class=headerlink  href="#first-difference-estimation-firstdifferenceols" title="Permalink to this heading">¶</a></h3> <p>First difference estimation regresses first difference of the dependent variable on the first difference the regressors,</p> <div class="math notranslate nohighlight"> \[\Delta y_{it}=\Delta x_{it}\beta+\Delta\epsilon_{it}.\]</div> <p><strong>Weights</strong></p> <p>When weights are included, weighted are summed to that the weight on <span class="math notranslate nohighlight">\(\Delta y_{it}\)</span> is <span class="math notranslate nohighlight">\(\left(w_{it}^{-1}+w_{it-1}^{-1}\right)^{-1}\)</span> which exploits that the structure that conditional variance of <span class="math notranslate nohighlight">\(y_{it}\propto w_{it}^{-1}\)</span> and the variance of the difference is the sum of the variances when observations are uncorrelated.</p> </section> <section id=pooled-model-estimation-pooledols > <h3 id=pooled-model-estimation-pooledols >Pooled Model Estimation (PooledOLS)<a class=headerlink  href="#pooled-model-estimation-pooledols" title="Permalink to this heading">¶</a></h3> <p>The pooled estimator is a standard regression,</p> <div class="math notranslate nohighlight"> \[y_{it}=x_{it}\beta+\epsilon_{it}.\]</div> <p><strong>Weights</strong></p> <p>When weights are included, the data is transformed by multiplying with the square root of the weights prior to the regression (i.e., <span class="math notranslate nohighlight">\(y_{it}\)</span> is replaced by <span class="math notranslate nohighlight">\(\sqrt{w_{it}}y_{it}\)</span> and <span class="math notranslate nohighlight">\(x_{it}\)</span> is similarly transformed).</p> </section> </section> <section id=covariance-estimators > <h2 id=covariance-estimators >Covariance Estimators<a class=headerlink  href="#covariance-estimators" title="Permalink to this heading">¶</a></h2> <section id=standard-covariance-estimator-unadjusted > <h3 id=standard-covariance-estimator-unadjusted >Standard Covariance Estimator (unadjusted)<a class=headerlink  href="#standard-covariance-estimator-unadjusted" title="Permalink to this heading">¶</a></h3> <p>The standard covariance estimator is</p> <div class="math notranslate nohighlight"> \[s^{2}\Sigma_{XX}^{-1}\]</div> <p>where</p> <div class="math notranslate nohighlight"> \[\Sigma_{XX}=\sum_{i=1}^{N}\sum_{t=1}^{T_{i}}x_{it}^{\prime}x_{it}\]</div> <p>and</p> <div class="math notranslate nohighlight"> \[s^{2}=(n_{obs}-k)\sum_{i=1}^{N}\sum_{t=1}^{Ti}\hat{\epsilon}_{it}^{2}\]</div> <p>where <span class="math notranslate nohighlight">\(n_{obs}=\sum_{i=1}^{N}T_{i}\)</span>. If the debiased options is not used, the <span class="math notranslate nohighlight">\(k\)</span> is omitted.</p> </section> <section id=heteroskedastic-covariance-estimator-robust > <h3 id=heteroskedastic-covariance-estimator-robust >Heteroskedastic Covariance Estimator (robust)<a class=headerlink  href="#heteroskedastic-covariance-estimator-robust" title="Permalink to this heading">¶</a></h3> <p>The standard covariance estimator is</p> <div class="math notranslate nohighlight"> \[n_{obs}/(n_{obs}-k)\Sigma_{XX}^{-1}\hat{S}\Sigma_{XX}^{-1}\]</div> <p>where</p> <div class="math notranslate nohighlight"> \[\hat{S}=\sum_{i=1}^{N}\sum_{t=1}^{T_{i}}\hat{\epsilon}_{it}^{2}x_{it}^{\prime}x_{it}.\]</div> <p>The <span class="math notranslate nohighlight">\(-k\)</span> term is dropped if the debiased options is not used</p> </section> <section id=clustered-covariance-estimator > <h3 id=clustered-covariance-estimator >Clustered Covariance Estimator<a class=headerlink  href="#clustered-covariance-estimator" title="Permalink to this heading">¶</a></h3> <p>The clustered covariance estimator supports 1 and 2 way clustering.</p> <div class="math notranslate nohighlight"> \[n_{obs}/(n_{obs}-k)\Sigma_{XX}^{-1}\hat{S}_{\mathcal{G}}\Sigma_{XX}^{-1}\]</div> <p>where in the case of one-way clustering,</p> <div class="math notranslate nohighlight"> \[\hat{S}_{\mathcal{G}}=\frac{G}{G-1}\frac{n_{obs}-1}{n_{obs}}\frac{1}{n_{obs}}\sum_{g=1}^{G}\xi_{g}^{\prime}\xi_{g}\]</div> <p>where</p> <div class="math notranslate nohighlight"> \[\xi_{g}=\sum_{it\in G_{g}}\hat{\epsilon}_{ii}x_{it}\]</div> <p>and <span class="math notranslate nohighlight">\(it\in G_{g}\)</span> indicates that observation belongs to group <span class="math notranslate nohighlight">\(g\)</span>. The two-way clustered replaces <span class="math notranslate nohighlight">\(\hat{S}_{\mathcal{G}}\)</span>by</p> <div class="math notranslate nohighlight"> \[\hat{S}_{\mathcal{G}_{1}}+\hat{S}_{\mathcal{G}_{2}}-\hat{S}_{\mathcal{G}_{1}\cap\mathcal{G}_{2}}.\]</div> <p>Where the group debiasing is applies individually to each of the three components depending on the number of groups in the three estimators. If the group debias term is not used, the expression <span class="math notranslate nohighlight">\(\frac{G}{G-1}\frac{n_{obs}-1}{n_{obs}}\)</span> is omitted. The <span class="math notranslate nohighlight">\(-k\)</span> term is dropped if the debiased estimator is not used.</p> <p><strong>Clustering by Variables used as Effects</strong></p> <p>When clustering by the same variable used in the effect estimation, e.g., entity effects with clustering by entity, there the degrees of freedom used in estimating the effects are <em>not</em> counted.</p> </section> <section id=driscoll-kraay-covariance-estimator > <h3 id=driscoll-kraay-covariance-estimator >Driscoll-Kraay Covariance Estimator<a class=headerlink  href="#driscoll-kraay-covariance-estimator" title="Permalink to this heading">¶</a></h3> <p>The Driscoll-Kraay covariance estimator may be appropriate when the number of time periods is relatively large (e.g., a large T panel), and are given by</p> <div class="math notranslate nohighlight"> \[n_{obs}/(n_{obs}-k)\Sigma_{XX}^{-1}\hat{S}_{HAC}\Sigma_{XX}^{-1}\]</div> <p>where</p> <div class="math notranslate nohighlight"> \[\begin{split}\begin{aligned} \hat{S}_{HAC} &amp; =\hat{\Gamma}_{0}+\sum_{i=1}^{bw}K(i,bw)(\hat{\Gamma}_{1}+\hat{\Gamma}_{1}^{\prime})\\ \hat{\Gamma}_{i} &amp; =\sum_{t=i+1}^{T}\xi_{t}^{\prime}\xi_{t}\\ \xi_{t} &amp; =\sum_{i=1}^{n_{t}}\hat{\epsilon}_{it}x_{it}\end{aligned}\end{split}\]</div> <p>and <span class="math notranslate nohighlight">\(K\left(i,bw\right)\)</span> is a kernel weighting function. Kernel supported include the Bartlett, Parzen and Quadratic Spectral.</p> </section> </section> <section id=r-2-calculation > <h2 id=r-2-calculation ><span class="math notranslate nohighlight">\(R^{2}\)</span> Calculation<a class=headerlink  href="#r-2-calculation" title="Permalink to this heading">¶</a></h2> <p>There are 3 different <span class="math notranslate nohighlight">\(R^{2}\)</span> estimates computed for the models produced using 2 different methods. When models contain entity effects and are not weighted, the two methods agree.</p> <p>The correlation-based measures <strong>do not</strong> make use of weights. They are prefixed as <span class="math notranslate nohighlight">\(\texttt{corr\_squared}\)</span> in estimation results.</p> <section id=between-r-2 > <h3 id=between-r-2 >Between <span class="math notranslate nohighlight">\(R^{2}\)</span><a class=headerlink  href="#between-r-2" title="Permalink to this heading">¶</a></h3> <p>Define <span class="math notranslate nohighlight">\(\bar{y}_{iw}\)</span> and <span class="math notranslate nohighlight">\(\bar{x}_{iw}\)</span> to be entity-wise weighted means, and the entity-wise weight to be</p> <div class="math notranslate nohighlight"> \[w_{i}=\frac{\sum_{t}w_{it}}{\left(NT\right)^{-1}\sum_{i}\sum_{t}w_{it}}.\]</div> <p>The weighted between residuals are</p> <div class="math notranslate nohighlight"> \[\bar{\epsilon}_{iw}=\sqrt{w_{i}}\left(\bar{y}_{iw}-\bar{x}_{iw}\hat{\beta}\right)\]</div> <p>and the weighted between <span class="math notranslate nohighlight">\(R^{2}\)</span> is defined</p> <div class="math notranslate nohighlight"> \[R_{B}^{2}=1-\frac{\bar{\epsilon}_{w}^{\prime}\bar{\epsilon}_{w}}{\ddot{\bar{y}}_{w}^{\prime}\ddot{\bar{y}}_{w}}\]</div> <div class="math notranslate nohighlight"> \[\]</div> <p>where <span class="math notranslate nohighlight">\(\ddot{\bar{y}}_{iw}=\bar{y}_{iw}\)</span> if the model does not contains a constant or <span class="math notranslate nohighlight">\(\ddot{\bar{y}}_{iw}=\bar{y}_{iw}-\bar{\bar{y}}_{w}\)</span> if the model does. The overall weighted mean is defined</p> <div class="math notranslate nohighlight"> \[\bar{\bar{y}}_{w}=\frac{\sum_{i=1}^{N}w_{i}\bar{y}_{iw}}{\sum_{i=1}^{N}w_{i}}.\]</div> <section id=betweenr-2-correlation-method > <h4 id=betweenr-2-correlation-method >Between<span class="math notranslate nohighlight">\(R^{2}\)</span> (correlation method)<a class=headerlink  href="#betweenr-2-correlation-method" title="Permalink to this heading">¶</a></h4> <p>This measure matches Stata. It does not reflect weighting.</p> <div class="math notranslate nohighlight"> \[\rho_{B}^{2}=\textrm{Corr}\left[\bar{x}_{t}\hat{\beta},\bar{y}_{i}\right]^{2}\]</div> </section> </section> <section id=overall-r-2 > <h3 id=overall-r-2 >Overall <span class="math notranslate nohighlight">\(R^{2}\)</span><a class=headerlink  href="#overall-r-2" title="Permalink to this heading">¶</a></h3> <p>Define the weighted residual as</p> <div class="math notranslate nohighlight"> \[\epsilon_{it,w}=\sqrt{w}\left(y_{it}-x_{it}\hat{\beta}\right)\]</div> <p>and the mean deviated dependent as</p> <div class="math notranslate nohighlight"> \[\tilde{y}_{it,w}=\sqrt{w_{it}}\left(y_{it}-\bar{\bar{y}}_{w}\right)\]</div> <p>where</p> <div class="math notranslate nohighlight"> \[\bar{\bar{y}}_{w}=\frac{\sum_{i}\sum_{t}w_{it}y_{it}}{\sum_{i}\sum_{t}w_{it}}\]</div> <p>if the model contains a constant or <span class="math notranslate nohighlight">\(\bar{\bar{y}}_{w}=0\)</span> if not. Then</p> <div class="math notranslate nohighlight"> \[R_{O}^{2}=1-\frac{\sum_{i}\sum_{t}\epsilon_{it,w}^{2}}{\sum_{i}\sum_{t}\tilde{y}_{it,w}^{2}}.\]</div> <section id=overall-r-2-correlation-method > <h4 id=overall-r-2-correlation-method >Overall <span class="math notranslate nohighlight">\(R^{2}\)</span> (correlation method)<a class=headerlink  href="#overall-r-2-correlation-method" title="Permalink to this heading">¶</a></h4> <p>This measure matches Stata. It does not reflect weighting.</p> <div class="math notranslate nohighlight"> \[\rho_{O}^{2}=\textrm{Corr}\left[x_{it}\hat{\beta},y_{it}\right]\]</div> </section> </section> <section id=within-r-2 > <h3 id=within-r-2 >Within <span class="math notranslate nohighlight">\(R^{2}\)</span><a class=headerlink  href="#within-r-2" title="Permalink to this heading">¶</a></h3> <p>Define <span class="math notranslate nohighlight">\(\tilde{y}_{it,w}=\sqrt{w_{it}}\left(y_{it}-\bar{y}_{iw}\right)\)</span> and <span class="math notranslate nohighlight">\(\tilde{x}_{it,w}=\sqrt{w_{it}}\left(x_{it}-\bar{x}_{iw}\right)\)</span> and the residuals as</p> <div class="math notranslate nohighlight"> \[\tilde{\epsilon}_{it,w}=\tilde{y}_{it,w}-\tilde{x}_{it,w}\hat{\beta}.\]</div> <p>The within<span class="math notranslate nohighlight">\(R^{2}\)</span> is defined as</p> <div class="math notranslate nohighlight"> \[R_{W}^{2}=1-\frac{\sum_{i}\sum_{t}\tilde{\epsilon}_{it,w}}{\sum_{i}\sum_{t}\tilde{y}_{it,w}}\]</div> <section id=withinr-2-correlation-method > <h4 id=withinr-2-correlation-method >Within<span class="math notranslate nohighlight">\(R^{2}\)</span> (correlation method)<a class=headerlink  href="#withinr-2-correlation-method" title="Permalink to this heading">¶</a></h4> <p>This measure matches Stata. It does not reflect weighting.</p> <div class="math notranslate nohighlight"> \[\rho_{W}^{2}=\textrm{Corr}\left[\left(x_{it}-\bar{x}_{t}\right)\hat{\beta},\left(y_{it}-\bar{y}_{i}\right)\right]^{2}\]</div> </section> </section> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> <a href="panel/linearmodels.panel.utility.PanelModelData.weights.html" title=linearmodels.panel.utility.PanelModelData.weights  class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev > <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Previous </span> linearmodels.panel.utility.PanelModelData.weights </span> </div> </a> <a href=faq.html  title="Implementation Choices" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next > <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Next </span> Implementation Choices </span> </div> <div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2017, Kevin Sheppard. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.0.2. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>