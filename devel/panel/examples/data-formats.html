<!DOCTYPE html> <html lang=en > <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.19: https://docutils.sourceforge.io/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../../_static/javascripts/modernizr.js"></script> <title>Data Formats for Panel Data Analysis &#8212; linearmodels 4.29.dev12+gd71681c71 documentation</title> <link rel=apple-touch-icon  sizes=180x180  href="../../_static/icons/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="../../_static/icons/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="../../_static/icons/favicon-16x16.png"> <link rel=manifest  href="../../_static/icons/site.webmanifest"> <link rel=mask-icon  href="../../_static/icons/safari-pinned-tab.svg" color="#2196f3"> <link rel="shortcut icon" href="../../_static/icons/favicon.ico"> <meta name=msapplication-TileColor  content="#f8f8f8"> <meta name=msapplication-config  content="../../_static/icons/browserconfig.xml"> <style> .highlight { background-color: hsla(0,0%,92.5%,.5) !important; } </style> <link rel=stylesheet  type="text/css" href="../../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../../_static/material.css" /> <link rel=stylesheet  type="text/css" href="../../_static/nbsphinx-code-cells.css" /> <script data-url_root="../../" id=documentation_options  src="../../_static/documentation_options.js"></script> <script src="../../_static/doctools.js"></script> <script src="../../_static/sphinx_highlight.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <script defer=defer  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel=icon  href="../../_static/favicon.ico"/> <link rel=index  title=Index  href="../../genindex.html" /> <link rel=search  title=Search  href="../../search.html" /> <link rel=next  title=Examples  href=examples.html  /> <link rel=prev  title=Introduction  href="../introduction.html" /> <body dir=ltr data-md-color-primary=blue data-md-color-accent=orange> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#panel/examples/data-formats" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../../index.html" title="linearmodels 4.29.dev12+gd71681c71 documentation" class="md-header-nav__button md-logo"> &nbsp; </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >linearmodels v4.29 (+12)</span> <span class=md-header-nav__topic > Data Formats for Panel Data Analysis </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> </div> <div class="md-flex__cell md-flex__cell--shrink dropdown"> <button class=dropdownbutton >Versions</button> <div class="dropdown-content md-hero"> <a title=Release  href="https://bashtage.github.io/linearmodels/">Release</a> <a title=Development  href="https://bashtage.github.io/linearmodels/devel/">Development</a> </div> </div> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href="../index.html" class=md-tabs__link >Panel Data Model Estimation</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../../index.html" title="linearmodels 4.29.dev12+gd71681c71 documentation" class="md-nav__button md-logo"> <img src="../../_static/" alt=" logo" width=48  height=48 > </a> <a href="../../index.html" title="linearmodels 4.29.dev12+gd71681c71 documentation">linearmodels v4.29 (+12)</a> </label> <div class=md-nav__source > <a href="https://github.com/bashtage/linearmodels/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > linearmodels </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <a href="../../iv/index.html" class=md-nav__link >Instrumental Variable Estimation</a> <li class=md-nav__item > <a href="../index.html" class=md-nav__link >Panel Data Model Estimation</a> <ul class=md-nav__list > <li class=md-nav__item > <a href="../introduction.html" class=md-nav__link >Introduction</a> <li class=md-nav__item > <input class="md-toggle md-nav__toggle" data-md-toggle=toc  type=checkbox  id=__toc > <label class="md-nav__link md-nav__link--active" for=__toc > Data Formats for Panel Data Analysis </label> <a href="#" class="md-nav__link md-nav__link--active">Data Formats for Panel Data Analysis</a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#panel-examples-data-formats--page-root" class=md-nav__link >Data Formats for Panel Data Analysis</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#MultiIndex-DataFrames" class=md-nav__link >MultiIndex DataFrames</a> <li class=md-nav__item ><a href="#NumPy-arrays" class=md-nav__link >NumPy arrays</a> <li class=md-nav__item ><a href="#xarray-DataArrays" class=md-nav__link >xarray DataArrays</a> <li class=md-nav__item ><a href="#Conversion-of-Categorical-and-Strings-to-Dummies" class=md-nav__link >Conversion of Categorical and Strings to Dummies</a> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../../_sources/panel/examples/data-formats.ipynb.txt">Show Source</a> </ul> </nav> <li class=md-nav__item > <a href=examples.html  class=md-nav__link >Examples</a> <li class=md-nav__item > <a href=using-formulas.html  class=md-nav__link >Using formulas to specify models</a> <li class=md-nav__item > <a href="../pandas.html" class=md-nav__link >Comparison with pandas PanelOLS and FamaMacBeth</a> <li class=md-nav__item > <a href="../reference.html" class=md-nav__link >Module Reference</a> <li class=md-nav__item > <a href="../mathematical-formula.html" class=md-nav__link >Formulas and Mathematical Detail</a> <li class=md-nav__item > <a href="../faq.html" class=md-nav__link >Implementation Choices</a> </ul> <li class=md-nav__item > <a href="../../asset-pricing/index.html" class=md-nav__link >Linear Factor Models for Asset Pricing</a> <li class=md-nav__item > <a href="../../system/index.html" class=md-nav__link >System Regression Models</a> <li class=md-nav__item > <a href="../../utility.html" class=md-nav__link >Utilities</a> <li class=md-nav__item > <a href="../../compatibility.html" class=md-nav__link >Compatibility</a> <li class=md-nav__item > <a href="../../plan.html" class=md-nav__link >Module Plans</a> <li class=md-nav__item > <a href="../../contributing.html" class=md-nav__link >Contributing</a> <li class=md-nav__item > <a href="../../changes.html" class=md-nav__link >Change Log</a> <li class=md-nav__item > <a href="../../references.html" class=md-nav__link >References</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#panel-examples-data-formats--page-root" class=md-nav__link >Data Formats for Panel Data Analysis</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#MultiIndex-DataFrames" class=md-nav__link >MultiIndex DataFrames</a> <li class=md-nav__item ><a href="#NumPy-arrays" class=md-nav__link >NumPy arrays</a> <li class=md-nav__item ><a href="#xarray-DataArrays" class=md-nav__link >xarray DataArrays</a> <li class=md-nav__item ><a href="#Conversion-of-Categorical-and-Strings-to-Dummies" class=md-nav__link >Conversion of Categorical and Strings to Dummies</a> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../../_sources/panel/examples/data-formats.ipynb.txt">Show Source</a> <li id=searchbox  class=md-nav__item > </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <section id=Data-Formats-for-Panel-Data-Analysis > <h1 id=panel-examples-data-formats--page-root >Data Formats for Panel Data Analysis<a class=headerlink  href="#panel-examples-data-formats--page-root" title="Permalink to this heading">¶</a></h1> <p>There are two primary methods to express data:</p> <ul class=simple > <li><p>MultiIndex DataFrames where the outer index is the entity and the inner is the time index. This requires using pandas.</p> <li><p>3D structures were dimension 0 (outer) is variable, dimension 1 is time index and dimension 2 is the entity index. It is also possible to use a 2D data structure with dimensions (t, n) which is treated as a 3D data structure having dimensions (1, t, n). These 3D data structures can be pandas, NumPy or xarray.</p> </ul> <section id=MultiIndex-DataFrames > <h2 id=MultiIndex-DataFrames >MultiIndex DataFrames<a class=headerlink  href="#MultiIndex-DataFrames" title="Permalink to this heading">¶</a></h2> <p>The most precise data format to use is a MultiIndex <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code>. This is the most precise since only single columns can preserve all types within a panel. For example, it is not possible to span a single Categorical variable across multiple columns when using a pandas <code class="docutils literal notranslate"><span class=pre >Panel</span></code>.</p> <p>This example uses the job training data to construct a MultiIndex <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code> using the <code class="docutils literal notranslate"><span class=pre >set_index</span></code> command. The entity index is <code class="docutils literal notranslate"><span class=pre >fcode</span></code> and the time index is <code class="docutils literal notranslate"><span class=pre >year</span></code>.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[1]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >linearmodels.datasets</span> <span class=kn >import</span> <span class=n >jobtraining</span>

<span class=n >data</span> <span class=o >=</span> <span class=n >jobtraining</span><span class=o >.</span><span class=n >load</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >data</span><span class=o >.</span><span class=n >head</span><span class=p >())</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
   year   fcode  employ       sales   avgsal  scrap  rework  tothrs  union
0  1987  410032   100.0  47000000.0  35000.0    NaN     NaN    12.0      0  \
1  1988  410032   131.0  43000000.0  37000.0    NaN     NaN     8.0      0
2  1989  410032   123.0  49000000.0  39000.0    NaN     NaN     8.0      0
3  1987  410440    12.0   1560000.0  10500.0    NaN     NaN    12.0      0
4  1988  410440    13.0   1970000.0  11000.0    NaN     NaN    12.0      0

   grant  ...  grant_1  clscrap  cgrant  clemploy   clsales    lavgsal
0      0  ...        0      NaN       0       NaN       NaN  10.463100  \
1      0  ...        0      NaN       0  0.270027 -0.088949  10.518670
2      0  ...        0      NaN       0 -0.063013  0.130621  10.571320
3      0  ...        0      NaN       0       NaN       NaN   9.259130
4      0  ...        0      NaN       0  0.080043  0.233347   9.305651

   clavgsal  cgrant_1   chrsemp  clhrsemp
0       NaN       NaN       NaN       NaN
1  0.055570       0.0 -8.946565 -1.165385
2  0.052644       0.0  0.198597  0.047832
3       NaN       NaN       NaN       NaN
4  0.046520       0.0  0.000000  0.000000

[5 rows x 30 columns]
</pre></div></div> </div> <p>Here <code class="docutils literal notranslate"><span class=pre >set_index</span></code> is used to set the MultiIndex using the firm code (entity) and year (time).</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >mi_data</span> <span class=o >=</span> <span class=n >data</span><span class=o >.</span><span class=n >set_index</span><span class=p >([</span><span class=s2 >"fcode"</span><span class=p >,</span> <span class=s2 >"year"</span><span class=p >])</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mi_data</span><span class=o >.</span><span class=n >head</span><span class=p >())</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
             employ       sales   avgsal  scrap  rework  tothrs  union  grant
fcode  year
410032 1987   100.0  47000000.0  35000.0    NaN     NaN    12.0      0      0  \
       1988   131.0  43000000.0  37000.0    NaN     NaN     8.0      0      0
       1989   123.0  49000000.0  39000.0    NaN     NaN     8.0      0      0
410440 1987    12.0   1560000.0  10500.0    NaN     NaN    12.0      0      0
       1988    13.0   1970000.0  11000.0    NaN     NaN    12.0      0      0

             d89  d88  ...  grant_1  clscrap  cgrant  clemploy   clsales
fcode  year            ...
410032 1987    0    0  ...        0      NaN       0       NaN       NaN  \
       1988    0    1  ...        0      NaN       0  0.270027 -0.088949
       1989    1    0  ...        0      NaN       0 -0.063013  0.130621
410440 1987    0    0  ...        0      NaN       0       NaN       NaN
       1988    0    1  ...        0      NaN       0  0.080043  0.233347

               lavgsal  clavgsal  cgrant_1   chrsemp  clhrsemp
fcode  year
410032 1987  10.463100       NaN       NaN       NaN       NaN
       1988  10.518670  0.055570       0.0 -8.946565 -1.165385
       1989  10.571320  0.052644       0.0  0.198597  0.047832
410440 1987   9.259130       NaN       NaN       NaN       NaN
       1988   9.305651  0.046520       0.0  0.000000  0.000000

[5 rows x 28 columns]
</pre></div></div> </div> <p>The <code class="docutils literal notranslate"><span class=pre >MultiIndex</span></code> <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code> can be used to initialized the model. When only referencing a single series, the <code class="docutils literal notranslate"><span class=pre >MultiIndex</span></code> <code class="docutils literal notranslate"><span class=pre >Series</span></code> representation can be used.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >linearmodels</span> <span class=kn >import</span> <span class=n >PanelOLS</span>

<span class=n >mod</span> <span class=o >=</span> <span class=n >PanelOLS</span><span class=p >(</span><span class=n >mi_data</span><span class=o >.</span><span class=n >lscrap</span><span class=p >,</span> <span class=n >mi_data</span><span class=o >.</span><span class=n >hrsemp</span><span class=p >,</span> <span class=n >entity_effects</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >())</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                          PanelOLS Estimation Summary
================================================================================
Dep. Variable:                 lscrap   R-squared:                        0.0528
Estimator:                   PanelOLS   R-squared (Between):             -0.0379
No. Observations:                 140   R-squared (Within):               0.0528
Date:                Thu, Apr 20 2023   R-squared (Overall):             -0.0288
Time:                        17:53:40   Log-likelihood                   -90.459
Cov. Estimator:            Unadjusted
                                        F-statistic:                      5.0751
Entities:                          48   P-value                           0.0267
Avg Obs:                       2.9167   Distribution:                    F(1,91)
Min Obs:                       1.0000
Max Obs:                       3.0000   F-statistic (robust):             5.0751
                                        P-value                           0.0267
Time periods:                       3   Distribution:                    F(1,91)
Avg Obs:                       46.667
Min Obs:                       46.000
Max Obs:                       48.000

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
hrsemp        -0.0054     0.0024    -2.2528     0.0267     -0.0102     -0.0006
==============================================================================

F-test for Poolability: 17.094
P-value: 0.0000
Distribution: F(47,91)

Included effects: Entity
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area stderr docutils container"> <div class=highlight ><pre>
/home/runner/work/linearmodels/linearmodels/linearmodels/panel/model.py:1185: MissingValueWarning:
Inputs contain missing values. Dropping rows with missing observations.
  super().__init__(dependent, exog, weights=weights, check_rank=check_rank)
</pre></div></div> </div> </section> <section id=NumPy-arrays > <h2 id=NumPy-arrays >NumPy arrays<a class=headerlink  href="#NumPy-arrays" title="Permalink to this heading">¶</a></h2> <p>3D NumPy arrays can be used to hand panel data where the three axes are <code class="docutils literal notranslate"><span class=pre >0</span></code>, items, <code class="docutils literal notranslate"><span class=pre >1</span></code>, time and <code class="docutils literal notranslate"><span class=pre >2</span></code>, entity. NumPy arrays are not usually the best format for data since the results all use generic variable names.</p> <p>Pandas dropped support for their Panel in 0.25.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>

<span class=n >np_data</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=n >mi_data</span><span class=p >)</span>
<span class=n >np_lscrap</span> <span class=o >=</span> <span class=n >np_data</span><span class=p >[:,</span> <span class=n >mi_data</span><span class=o >.</span><span class=n >columns</span><span class=o >.</span><span class=n >get_loc</span><span class=p >(</span><span class=s2 >"lscrap"</span><span class=p >)]</span>
<span class=n >np_hrsemp</span> <span class=o >=</span> <span class=n >np_data</span><span class=p >[:,</span> <span class=n >mi_data</span><span class=o >.</span><span class=n >columns</span><span class=o >.</span><span class=n >get_loc</span><span class=p >(</span><span class=s2 >"hrsemp"</span><span class=p >)]</span>
<span class=n >nentity</span> <span class=o >=</span> <span class=n >mi_data</span><span class=o >.</span><span class=n >index</span><span class=o >.</span><span class=n >levels</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
<span class=n >ntime</span> <span class=o >=</span> <span class=n >mi_data</span><span class=o >.</span><span class=n >index</span><span class=o >.</span><span class=n >levels</span><span class=p >[</span><span class=mi >1</span><span class=p >]</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
<span class=n >np_lscrap</span> <span class=o >=</span> <span class=n >np_lscrap</span><span class=o >.</span><span class=n >reshape</span><span class=p >((</span><span class=n >nentity</span><span class=p >,</span> <span class=n >ntime</span><span class=p >))</span><span class=o >.</span><span class=n >T</span>
<span class=n >np_hrsemp</span> <span class=o >=</span> <span class=n >np_hrsemp</span><span class=o >.</span><span class=n >reshape</span><span class=p >((</span><span class=n >nentity</span><span class=p >,</span> <span class=n >ntime</span><span class=p >))</span><span class=o >.</span><span class=n >T</span>
<span class=n >np_hrsemp</span><span class=o >.</span><span class=n >shape</span> <span class=o >=</span> <span class=p >(</span><span class=mi >1</span><span class=p >,</span> <span class=n >ntime</span><span class=p >,</span> <span class=n >nentity</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >res</span> <span class=o >=</span> <span class=n >PanelOLS</span><span class=p >(</span><span class=n >np_lscrap</span><span class=p >,</span> <span class=n >np_hrsemp</span><span class=p >,</span> <span class=n >entity_effects</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                          PanelOLS Estimation Summary
================================================================================
Dep. Variable:                    Dep   R-squared:                        0.0528
Estimator:                   PanelOLS   R-squared (Between):             -0.0379
No. Observations:                 140   R-squared (Within):               0.0528
Date:                Thu, Apr 20 2023   R-squared (Overall):             -0.0288
Time:                        17:53:40   Log-likelihood                   -90.459
Cov. Estimator:            Unadjusted
                                        F-statistic:                      5.0751
Entities:                          48   P-value                           0.0267
Avg Obs:                       2.9167   Distribution:                    F(1,91)
Min Obs:                       1.0000
Max Obs:                       3.0000   F-statistic (robust):             5.0751
                                        P-value                           0.0267
Time periods:                       3   Distribution:                    F(1,91)
Avg Obs:                       46.667
Min Obs:                       46.000
Max Obs:                       48.000

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Exog          -0.0054     0.0024    -2.2528     0.0267     -0.0102     -0.0006
==============================================================================

F-test for Poolability: 17.094
P-value: 0.0000
Distribution: F(47,91)

Included effects: Entity
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area stderr docutils container"> <div class=highlight ><pre>
/home/runner/work/linearmodels/linearmodels/linearmodels/panel/model.py:1185: MissingValueWarning:
Inputs contain missing values. Dropping rows with missing observations.
  super().__init__(dependent, exog, weights=weights, check_rank=check_rank)
</pre></div></div> </div> </section> <section id=xarray-DataArrays > <h2 id=xarray-DataArrays >xarray DataArrays<a class=headerlink  href="#xarray-DataArrays" title="Permalink to this heading">¶</a></h2> <p>xarray is a relatively new entrant into the set of packages used for data structures. The data structures provided by <code class="docutils literal notranslate"><span class=pre >xarray</span></code> are relevant in the context of panel models since pandas <code class="docutils literal notranslate"><span class=pre >Panel</span></code> is scheduled for removal in the futures, and so the only 3d data format that will remain viable is an <code class="docutils literal notranslate"><span class=pre >xarray</span></code> <code class="docutils literal notranslate"><span class=pre >DataArray</span></code>. <code class="docutils literal notranslate"><span class=pre >DataArray</span></code>s are similar to pandas <code class="docutils literal notranslate"><span class=pre >Panel</span></code> although <code class="docutils literal notranslate"><span class=pre >DataArrays</span></code> use some difference notation. In principle it is possible to express the same information in a <code class="docutils literal notranslate"><span class=pre >DataArray</span></code> as one can in a <code class="docutils literal notranslate"><span class=pre >Panel</span></code></p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >da</span> <span class=o >=</span> <span class=n >mi_data</span><span class=o >.</span><span class=n >to_xarray</span><span class=p >()</span>
<span class=n >da</span><span class=o >.</span><span class=n >keys</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
KeysView(&lt;xarray.Dataset&gt;
Dimensions:   (fcode: 157, year: 3)
Coordinates:
  * fcode     (fcode) int64 410032 410440 410495 410500 ... 419482 419483 419486
  * year      (year) int64 1987 1988 1989
Data variables: (12/28)
    employ    (fcode, year) float64 100.0 131.0 123.0 12.0 ... 80.0 90.0 100.0
    sales     (fcode, year) float64 4.7e+07 4.3e+07 4.9e+07 ... 8.5e+06 9.9e+06
    avgsal    (fcode, year) float64 3.5e+04 3.7e+04 3.9e+04 ... 1.7e+04 1.8e+04
    scrap     (fcode, year) float64 nan nan nan nan nan ... 30.0 nan nan nan
    rework    (fcode, year) float64 nan nan nan nan nan ... nan nan nan nan nan
    tothrs    (fcode, year) float64 12.0 8.0 8.0 12.0 12.0 ... 20.0 0.0 0.0 40.0
    ...        ...
    clsales   (fcode, year) float64 nan -0.08895 0.1306 ... nan 0.1942 0.1525
    lavgsal   (fcode, year) float64 10.46 10.52 10.57 9.259 ... 9.68 9.741 9.798
    clavgsal  (fcode, year) float64 nan 0.05557 0.05264 ... nan 0.06063 0.05716
    cgrant_1  (fcode, year) float64 nan 0.0 0.0 nan 0.0 ... 0.0 0.0 nan 0.0 0.0
    chrsemp   (fcode, year) float64 nan -8.947 0.1986 nan ... 3.101 nan 0.0 36.0
    clhrsemp  (fcode, year) float64 nan -1.165 0.04783 nan ... nan 0.0 3.611)
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >res</span> <span class=o >=</span> <span class=n >PanelOLS</span><span class=p >(</span><span class=n >da</span><span class=p >[</span><span class=s2 >"lscrap"</span><span class=p >]</span><span class=o >.</span><span class=n >T</span><span class=p >,</span> <span class=n >da</span><span class=p >[</span><span class=s2 >"hrsemp"</span><span class=p >]</span><span class=o >.</span><span class=n >T</span><span class=p >,</span> <span class=n >entity_effects</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                          PanelOLS Estimation Summary
================================================================================
Dep. Variable:                    Dep   R-squared:                        0.0528
Estimator:                   PanelOLS   R-squared (Between):             -0.0379
No. Observations:                 140   R-squared (Within):               0.0528
Date:                Thu, Apr 20 2023   R-squared (Overall):             -0.0288
Time:                        17:53:40   Log-likelihood                   -90.459
Cov. Estimator:            Unadjusted
                                        F-statistic:                      5.0751
Entities:                          48   P-value                           0.0267
Avg Obs:                       2.9167   Distribution:                    F(1,91)
Min Obs:                       1.0000
Max Obs:                       3.0000   F-statistic (robust):             5.0751
                                        P-value                           0.0267
Time periods:                       3   Distribution:                    F(1,91)
Avg Obs:                       46.667
Min Obs:                       46.000
Max Obs:                       48.000

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
Exog          -0.0054     0.0024    -2.2528     0.0267     -0.0102     -0.0006
==============================================================================

F-test for Poolability: 17.094
P-value: 0.0000
Distribution: F(47,91)

Included effects: Entity
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area stderr docutils container"> <div class=highlight ><pre>
/home/runner/work/linearmodels/linearmodels/linearmodels/panel/model.py:1185: MissingValueWarning:
Inputs contain missing values. Dropping rows with missing observations.
  super().__init__(dependent, exog, weights=weights, check_rank=check_rank)
</pre></div></div> </div> </section> <section id=Conversion-of-Categorical-and-Strings-to-Dummies > <h2 id=Conversion-of-Categorical-and-Strings-to-Dummies >Conversion of Categorical and Strings to Dummies<a class=headerlink  href="#Conversion-of-Categorical-and-Strings-to-Dummies" title="Permalink to this heading">¶</a></h2> <p>Categorical or string variables are treated as factors and so are converted to dummies. The first category is always dropped. If this is not desirable, you should manually convert the data to dummies before estimating a model.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >pandas</span> <span class=k >as</span> <span class=nn >pd</span>

<span class=n >year_str</span> <span class=o >=</span> <span class=n >mi_data</span><span class=o >.</span><span class=n >reset_index</span><span class=p >()[[</span><span class=s2 >"year"</span><span class=p >]]</span><span class=o >.</span><span class=n >astype</span><span class=p >(</span><span class=s2 >"str"</span><span class=p >)</span>
<span class=n >year_cat</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >Categorical</span><span class=p >(</span><span class=n >year_str</span><span class=o >.</span><span class=n >iloc</span><span class=p >[:,</span> <span class=mi >0</span><span class=p >])</span>
<span class=n >year_str</span><span class=o >.</span><span class=n >index</span> <span class=o >=</span> <span class=n >mi_data</span><span class=o >.</span><span class=n >index</span>
<span class=n >year_cat</span><span class=o >.</span><span class=n >index</span> <span class=o >=</span> <span class=n >mi_data</span><span class=o >.</span><span class=n >index</span>
<span class=n >mi_data</span><span class=p >[</span><span class=s2 >"year_str"</span><span class=p >]</span> <span class=o >=</span> <span class=n >year_str</span>
<span class=n >mi_data</span><span class=p >[</span><span class=s2 >"year_cat"</span><span class=p >]</span> <span class=o >=</span> <span class=n >year_cat</span>
</pre></div> </div> </div> <p>Here year has been converted to a string which is then used in the model to produce year dummies.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=nb >print</span><span class=p >(</span><span class=s2 >"Exogenous variables"</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mi_data</span><span class=p >[[</span><span class=s2 >"hrsemp"</span><span class=p >,</span> <span class=s2 >"year_str"</span><span class=p >]]</span><span class=o >.</span><span class=n >head</span><span class=p >())</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mi_data</span><span class=p >[[</span><span class=s2 >"hrsemp"</span><span class=p >,</span> <span class=s2 >"year_str"</span><span class=p >]]</span><span class=o >.</span><span class=n >dtypes</span><span class=p >)</span>

<span class=n >res</span> <span class=o >=</span> <span class=n >PanelOLS</span><span class=p >(</span>
    <span class=n >mi_data</span><span class=p >[[</span><span class=s2 >"lscrap"</span><span class=p >]],</span> <span class=n >mi_data</span><span class=p >[[</span><span class=s2 >"hrsemp"</span><span class=p >,</span> <span class=s2 >"year_str"</span><span class=p >]],</span> <span class=n >entity_effects</span><span class=o >=</span><span class=kc >True</span>
<span class=p >)</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
Exogenous variables
                hrsemp year_str
fcode  year
410032 1987  12.000000     1987
       1988   3.053435     1988
       1989   3.252033     1989
410440 1987  12.000000     1987
       1988  12.000000     1988
hrsemp      float64
year_str     object
dtype: object
</pre></div></div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area stderr docutils container"> <div class=highlight ><pre>
/home/runner/work/linearmodels/linearmodels/linearmodels/panel/model.py:1185: MissingValueWarning:
Inputs contain missing values. Dropping rows with missing observations.
  super().__init__(dependent, exog, weights=weights, check_rank=check_rank)
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                          PanelOLS Estimation Summary
================================================================================
Dep. Variable:                 lscrap   R-squared:                        0.1985
Estimator:                   PanelOLS   R-squared (Between):             -0.1240
No. Observations:                 140   R-squared (Within):               0.1985
Date:                Thu, Apr 20 2023   R-squared (Overall):             -0.0934
Time:                        17:53:40   Log-likelihood                   -78.765
Cov. Estimator:            Unadjusted
                                        F-statistic:                      7.3496
Entities:                          48   P-value                           0.0002
Avg Obs:                       2.9167   Distribution:                    F(3,89)
Min Obs:                       1.0000
Max Obs:                       3.0000   F-statistic (robust):             7.3496
                                        P-value                           0.0002
Time periods:                       3   Distribution:                    F(3,89)
Avg Obs:                       46.667
Min Obs:                       46.000
Max Obs:                       48.000

                               Parameter Estimates
=================================================================================
               Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
---------------------------------------------------------------------------------
hrsemp           -0.0024     0.0024    -1.0058     0.3172     -0.0071      0.0023
year_str.1988    -0.1591     0.1146    -1.3888     0.1684     -0.3868      0.0685
year_str.1989    -0.4620     0.1176    -3.9297     0.0002     -0.6957     -0.2284
=================================================================================

F-test for Poolability: 19.649
P-value: 0.0000
Distribution: F(47,89)

Included effects: Entity
</pre></div></div> </div> <p>Using <code class="docutils literal notranslate"><span class=pre >categorical</span></code>s has the same effect.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=nb >print</span><span class=p >(</span><span class=s2 >"Exogenous variables"</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mi_data</span><span class=p >[[</span><span class=s2 >"hrsemp"</span><span class=p >,</span> <span class=s2 >"year_cat"</span><span class=p >]]</span><span class=o >.</span><span class=n >head</span><span class=p >())</span>
<span class=nb >print</span><span class=p >(</span><span class=n >mi_data</span><span class=p >[[</span><span class=s2 >"hrsemp"</span><span class=p >,</span> <span class=s2 >"year_cat"</span><span class=p >]]</span><span class=o >.</span><span class=n >dtypes</span><span class=p >)</span>

<span class=n >res</span> <span class=o >=</span> <span class=n >PanelOLS</span><span class=p >(</span>
    <span class=n >mi_data</span><span class=p >[[</span><span class=s2 >"lscrap"</span><span class=p >]],</span> <span class=n >mi_data</span><span class=p >[[</span><span class=s2 >"hrsemp"</span><span class=p >,</span> <span class=s2 >"year_cat"</span><span class=p >]],</span> <span class=n >entity_effects</span><span class=o >=</span><span class=kc >True</span>
<span class=p >)</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
Exogenous variables
                hrsemp year_cat
fcode  year
410032 1987  12.000000     1987
       1988   3.053435     1988
       1989   3.252033     1989
410440 1987  12.000000     1987
       1988  12.000000     1988
hrsemp       float64
year_cat    category
dtype: object
</pre></div></div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area stderr docutils container"> <div class=highlight ><pre>
/home/runner/work/linearmodels/linearmodels/linearmodels/panel/model.py:1185: MissingValueWarning:
Inputs contain missing values. Dropping rows with missing observations.
  super().__init__(dependent, exog, weights=weights, check_rank=check_rank)
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                          PanelOLS Estimation Summary
================================================================================
Dep. Variable:                 lscrap   R-squared:                        0.1985
Estimator:                   PanelOLS   R-squared (Between):             -0.1240
No. Observations:                 140   R-squared (Within):               0.1985
Date:                Thu, Apr 20 2023   R-squared (Overall):             -0.0934
Time:                        17:53:40   Log-likelihood                   -78.765
Cov. Estimator:            Unadjusted
                                        F-statistic:                      7.3496
Entities:                          48   P-value                           0.0002
Avg Obs:                       2.9167   Distribution:                    F(3,89)
Min Obs:                       1.0000
Max Obs:                       3.0000   F-statistic (robust):             7.3496
                                        P-value                           0.0002
Time periods:                       3   Distribution:                    F(3,89)
Avg Obs:                       46.667
Min Obs:                       46.000
Max Obs:                       48.000

                               Parameter Estimates
=================================================================================
               Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
---------------------------------------------------------------------------------
hrsemp           -0.0024     0.0024    -1.0058     0.3172     -0.0071      0.0023
year_cat.1988    -0.1591     0.1146    -1.3888     0.1684     -0.3868      0.0685
year_cat.1989    -0.4620     0.1176    -3.9297     0.0002     -0.6957     -0.2284
=================================================================================

F-test for Poolability: 19.649
P-value: 0.0000
Distribution: F(47,89)

Included effects: Entity
</pre></div></div> </div> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> <a href="../introduction.html" title=Introduction  class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev > <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Previous </span> Introduction </span> </div> </a> <a href=examples.html  title=Examples  class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next > <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Next </span> Examples </span> </div> <div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2017, Kevin Sheppard. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 6.1.3. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>